(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     78876,       2538]
NotebookOptionsPosition[     71861,       2322]
NotebookOutlinePosition[     72201,       2337]
CellTagsIndexPosition[     72158,       2334]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"fun", "=", 
  RowBox[{"l", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "-", "xl"}], ")"}], "*", "A"}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "xl"}], ")"}], "^", "2"}], "*", 
    "B"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{"y0", "\[Equal]", "fun"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"xl", "+", "xr"}], ")"}], "/", "2"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{"r", "==", "fun"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", "xr"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"myAB", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eq1", ",", "eq2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"finalfun", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fun", "//.", 
     RowBox[{"myAB", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4128884557041283`*^9, 3.41288854763632*^9}, {
  3.4128886620908976`*^9, 3.412888670613152*^9}}],

Cell[BoxData[
 RowBox[{"l", "+", 
  RowBox[{"A", " ", 
   RowBox[{"(", 
    RowBox[{"x", "-", "xl"}], ")"}]}], "+", 
  RowBox[{"B", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "-", "xl"}], ")"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.4128885160308733`*^9, 3.4128885480669394`*^9}, 
   3.412888670933613*^9, 3.412901123499523*^9, 3.4132303065966206`*^9}],

Cell[BoxData[
 RowBox[{"y0", "\[Equal]", 
  RowBox[{"l", "+", 
   RowBox[{"A", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xl"}], "+", 
      FractionBox[
       RowBox[{"xl", "+", "xr"}], "2"]}], ")"}]}], "+", 
   RowBox[{"B", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "xl"}], "+", 
       FractionBox[
        RowBox[{"xl", "+", "xr"}], "2"]}], ")"}], "2"]}]}]}]], "Output",
 CellChangeTimes->{{3.4128885160308733`*^9, 3.4128885480669394`*^9}, 
   3.412888670933613*^9, 3.412901123499523*^9, 3.4132303067067795`*^9}],

Cell[BoxData[
 RowBox[{"r", "\[Equal]", 
  RowBox[{"l", "+", 
   RowBox[{"A", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xl"}], "+", "xr"}], ")"}]}], "+", 
   RowBox[{"B", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]}]}]}]], "Output",
 CellChangeTimes->{{3.4128885160308733`*^9, 3.4128885480669394`*^9}, 
   3.412888670933613*^9, 3.412901123499523*^9, 3.4132303067167935`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "l"}], "-", "r", "+", 
        RowBox[{"4", " ", "y0"}]}], 
       RowBox[{"xl", "-", "xr"}]]}]}], ",", 
    RowBox[{"B", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"l", "+", "r", "-", 
         RowBox[{"2", " ", "y0"}]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xl", "-", "xr"}], ")"}], "2"]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.4128885160308733`*^9, 3.4128885480669394`*^9}, 
   3.412888670933613*^9, 3.412901123499523*^9, 3.413230306736822*^9}],

Cell[BoxData[
 RowBox[{"l", "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["x", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"l", "+", "r", "-", 
      RowBox[{"2", " ", "y0"}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"xl", "-", "xr"}], ")"}], "2"]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["xl", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"l", "+", "r", "-", 
      RowBox[{"2", " ", "y0"}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"xl", "-", "xr"}], ")"}], "2"]], "+", 
  FractionBox[
   RowBox[{"xl", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "l"}], "-", "r", "+", 
      RowBox[{"4", " ", "y0"}]}], ")"}]}], 
   RowBox[{"xl", "-", "xr"}]], "+", 
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", "xl", " ", 
        RowBox[{"(", 
         RowBox[{"l", "+", "r", "-", 
          RowBox[{"2", " ", "y0"}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xl", "-", "xr"}], ")"}], "2"]]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "l"}], "-", "r", "+", 
       RowBox[{"4", " ", "y0"}]}], 
      RowBox[{"xl", "-", "xr"}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.4128885160308733`*^9, 3.4128885480669394`*^9}, 
   3.412888670933613*^9, 3.412901123499523*^9, 3.4132303067468367`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dx0", "=", 
  RowBox[{"xr", "-", "xl"}]}], "\[IndentingNewLine]", 
 RowBox[{"dx", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", "-", "xl"}], ")"}], "/", "dx0"}]}], "\[IndentingNewLine]", 
 RowBox[{"dy", "=", 
  RowBox[{"(", 
   RowBox[{"r", "-", "l"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"parafun", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{"l", "+", 
      RowBox[{"dx", "*", 
       RowBox[{"(", 
        RowBox[{"dy", "+", 
         RowBox[{"a6", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "dx"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"x", "^", "2"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4128885537150607`*^9, 3.412888640599995*^9}, {
  3.4128887430773506`*^9, 3.412888744899971*^9}, {3.4128888523745117`*^9, 
  3.4128888556692495`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "xl"}], "+", "xr"}]], "Output",
 CellChangeTimes->{{3.4128886013735905`*^9, 3.4128886409504995`*^9}, 
   3.4128887476839743`*^9, 3.412888856730776*^9, 3.4129011245109777`*^9, 
   3.4132303071674414`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"x", "-", "xl"}], 
  RowBox[{
   RowBox[{"-", "xl"}], "+", "xr"}]]], "Output",
 CellChangeTimes->{{3.4128886013735905`*^9, 3.4128886409504995`*^9}, 
   3.4128887476839743`*^9, 3.412888856730776*^9, 3.4129011245109777`*^9, 
   3.4132303071874704`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "l"}], "+", "r"}]], "Output",
 CellChangeTimes->{{3.4128886013735905`*^9, 3.4128886409504995`*^9}, 
   3.4128887476839743`*^9, 3.412888856730776*^9, 3.4129011245109777`*^9, 
   3.4132303071874704`*^9}],

Cell[BoxData[
 RowBox[{"l", "-", 
  FractionBox[
   RowBox[{"a6", " ", 
    SuperscriptBox["x", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]], "-", 
  FractionBox[
   RowBox[{"a6", " ", 
    SuperscriptBox["xl", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]], "-", 
  FractionBox[
   RowBox[{"a6", " ", "xl"}], 
   RowBox[{
    RowBox[{"-", "xl"}], "+", "xr"}]], "+", 
  FractionBox[
   RowBox[{"l", " ", "xl"}], 
   RowBox[{
    RowBox[{"-", "xl"}], "+", "xr"}]], "-", 
  FractionBox[
   RowBox[{"r", " ", "xl"}], 
   RowBox[{
    RowBox[{"-", "xl"}], "+", "xr"}]], "+", 
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "a6", " ", "xl"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]], "+", 
     FractionBox["a6", 
      RowBox[{
       RowBox[{"-", "xl"}], "+", "xr"}]], "-", 
     FractionBox["l", 
      RowBox[{
       RowBox[{"-", "xl"}], "+", "xr"}]], "+", 
     FractionBox["r", 
      RowBox[{
       RowBox[{"-", "xl"}], "+", "xr"}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.4128886013735905`*^9, 3.4128886409504995`*^9}, 
   3.4128887476839743`*^9, 3.412888856730776*^9, 3.4129011245109777`*^9, 
   3.4132303072074995`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mya6", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "a6", " ", "xl"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]], "+", 
        FractionBox["a6", 
         RowBox[{
          RowBox[{"-", "xl"}], "+", "xr"}]], "-", 
        FractionBox["l", 
         RowBox[{
          RowBox[{"-", "xl"}], "+", "xr"}]], "+", 
        FractionBox["r", 
         RowBox[{
          RowBox[{"-", "xl"}], "+", "xr"}]]}], ")"}], "==", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"4", " ", "xl", " ", 
           RowBox[{"(", 
            RowBox[{"l", "+", "r", "-", 
             RowBox[{"2", " ", "y0"}]}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"xl", "-", "xr"}], ")"}], "2"]]}], "-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "l"}], "-", "r", "+", 
          RowBox[{"4", " ", "y0"}]}], 
         RowBox[{"xl", "-", "xr"}]]}], ")"}]}], ",", "a6"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.412888651906253*^9, 3.412888690671995*^9}, 
   3.412888756066027*^9, 3.4128888659340096`*^9, {3.4128890077779713`*^9, 
   3.4128890088595266`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"a6", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{"l", "+", "r", "-", 
       RowBox[{"2", " ", "y0"}]}], ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.4128886770924687`*^9, 3.412888692314357*^9}, 
   3.412888756917251*^9, 3.412888866444744*^9, 3.4128890096306353`*^9, 
   3.4129011257527633`*^9, 3.413230307808363*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mya6", "=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"a6", "->", 
     RowBox[{"COEF", "*", 
      RowBox[{"(", 
       RowBox[{"y0", "-", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"l", "+", "r"}], ")"}]}]}], ")"}]}]}], "}"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.4129029140442*^9, 3.412902995761704*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"a6", "\[Rule]", 
    RowBox[{"COEF", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], ")"}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.4129029582477617`*^9, 3.412902996192323*^9}, 
   3.413230308419242*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"parafunfinal", "=", 
  RowBox[{"parafun", "//.", 
   RowBox[{"mya6", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4128890111027517`*^9, 3.412889019534877*^9}}],

Cell[BoxData[
 RowBox[{"l", "+", 
  FractionBox[
   RowBox[{"l", " ", "xl"}], 
   RowBox[{
    RowBox[{"-", "xl"}], "+", "xr"}]], "-", 
  FractionBox[
   RowBox[{"r", " ", "xl"}], 
   RowBox[{
    RowBox[{"-", "xl"}], "+", "xr"}]], "-", 
  FractionBox[
   RowBox[{"COEF", " ", 
    SuperscriptBox["x", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]], "-", 
  FractionBox[
   RowBox[{"COEF", " ", 
    SuperscriptBox["xl", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]], "-", 
  FractionBox[
   RowBox[{"COEF", " ", "xl", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], ")"}]}], 
   RowBox[{
    RowBox[{"-", "xl"}], "+", "xr"}]], "+", 
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["l", 
       RowBox[{
        RowBox[{"-", "xl"}], "+", "xr"}]]}], "+", 
     FractionBox["r", 
      RowBox[{
       RowBox[{"-", "xl"}], "+", "xr"}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "COEF", " ", "xl", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "xl"}], "+", "xr"}], ")"}], "2"]], "+", 
     FractionBox[
      RowBox[{"COEF", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "xl"}], "+", "xr"}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.4128890147179503`*^9, 3.41288901990541*^9}, 
   3.412901126523872*^9, {3.412902960731333*^9, 3.412902996833245*^9}, 
   3.4132303090601635`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"parafunfinal", "-", "finalfun"}], "]"}], "//.", 
  RowBox[{"{", 
   RowBox[{"COEF", "\[Rule]", "4"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.412902984655734*^9, 3.412902989582819*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.4129014540648527`*^9, {3.4129029782765617`*^9, 3.412902997614368*^9}, 
   3.4132303097211137`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "so", " ", "have", " ", "determined", " ", "a6", " ", "and", " ", "COEF", 
   " ", "correctly"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.412901456408222*^9, 3.412901475045021*^9}, {
  3.412903002441309*^9, 3.4129030034127054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", "monotonicity", " ", "of", " ", "parabola"}], " ", 
   "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4129034898321424`*^9, 3.412903497783576*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"location", " ", "of", " ", "deriative", " ", "being", " ", "0"}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.413230296732437*^9, 3.4132303027811346`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checksols", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"parafunfinal", ",", "x"}], "]"}], "\[Equal]", "0"}], ",", 
     "x"}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xr", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"xl", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.412903501358717*^9, 3.4129035773880415`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"l", "-", "r"}], 
      RowBox[{"2", " ", "COEF", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], 
        ")"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.412903578099064*^9, {3.4132303038026032`*^9, 3.4132303126953907`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "enforce", " ", "derivative", " ", "to", " ", "be", " ", "0", " ", "at", 
   " ", "one", " ", "location", " ", "and", " ", "manipulate", " ", "other", 
   " ", "location"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4129034686516867`*^9, 3.412903487078182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mypar", "=", 
  RowBox[{"parafunfinal", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xr", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"xl", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"mypar", "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"0", "\[Equal]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"mypar", ",", "x"}], "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{"x", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}], "}"}]}], ")"}]}], ",", "l"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"0", "\[Equal]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"mypar", ",", "x"}], "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{"x", "\[Rule]", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], ")"}]}], ",", "r"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4129007272697725`*^9, 3.4129007723445873`*^9}, {
  3.4129016243497105`*^9, 3.4129017810750704`*^9}, {3.412902817435283*^9, 
  3.412902866325584*^9}, {3.412903012035104*^9, 3.412903018133874*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["l", "2"], "+", 
  FractionBox["r", "2"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "l"}], "+", "r"}], ")"}], " ", "x"}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "COEF", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], ")"}]}], "-", 
  RowBox[{"COEF", " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "l"}], "-", "r"}], ")"}]}], "+", "y0"}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.412900741380062*^9, 3.412900772564904*^9}, 
   3.4129011275653696`*^9, {3.4129016288762193`*^9, 3.41290178141556*^9}, {
   3.4129028319161053`*^9, 3.4129028668062754`*^9}, {3.412903007799013*^9, 
   3.412903018374219*^9}}],

Cell[BoxData["r"], "Output",
 CellChangeTimes->{{3.412900741380062*^9, 3.412900772564904*^9}, 
   3.4129011275653696`*^9, {3.4129016288762193`*^9, 3.41290178141556*^9}, {
   3.4129028319161053`*^9, 3.4129028668062754`*^9}, {3.412903007799013*^9, 
   3.4129030183842335`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"l", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"2", "+", "COEF"}], ")"}]}], " ", "r"}], "+", 
      RowBox[{"2", " ", "COEF", " ", "y0"}]}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "COEF"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.412900741380062*^9, 3.412900772564904*^9}, 
   3.4129011275653696`*^9, {3.4129016288762193`*^9, 3.41290178141556*^9}, {
   3.4129028319161053`*^9, 3.4129028668062754`*^9}, {3.412903007799013*^9, 
   3.412903018464349*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"2", "+", "COEF"}], ")"}]}], " ", "l"}], "+", 
      RowBox[{"2", " ", "COEF", " ", "y0"}]}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "COEF"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.412900741380062*^9, 3.412900772564904*^9}, 
   3.4129011275653696`*^9, {3.4129016288762193`*^9, 3.41290178141556*^9}, {
   3.4129028319161053`*^9, 3.4129028668062754`*^9}, {3.412903007799013*^9, 
   3.412903018524435*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4129011102004004`*^9, 3.412901179419933*^9}, {
   3.412901215051168*^9, 3.4129012358711057`*^9}, {3.412901282147648*^9, 
   3.4129012865840273`*^9}, {3.412901406526496*^9, 3.412901423100328*^9}, 
   3.4129028714229136`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"quartic", " ", "polynomial"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4128898110229807`*^9, 3.4128898151489134`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"restart", " ", "Kernel"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4128901924113903`*^9, 3.412890196086675*^9}, {
  3.412890226350192*^9, 3.4128902320984573`*^9}}],

Cell[BoxData["ClearAll"], "Output",
 CellChangeTimes->{3.412890196407136*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dx", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"x0", "=", "0"}], "\[IndentingNewLine]", 
 RowBox[{"funquartic", "=", 
  RowBox[{"y0", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "-", "x0"}], ")"}], "*", "AA"}], " ", "+", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}], "*", "BB"}], " ", "+", " ",
    
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "x0"}], ")"}], "^", "3"}], "*", "CC"}], "+", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "x0"}], ")"}], "^", "4"}], "*", 
    "DD"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{"ym1", "==", "funquartic"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "-", "dx"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{"ym2", "==", "funquartic"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "-", 
      RowBox[{"2", "*", "dx"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq3", "=", 
  RowBox[{
   RowBox[{"yp1", "==", "funquartic"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "+", "dx"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq4", "=", 
  RowBox[{
   RowBox[{"yp2", "==", "funquartic"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "+", 
      RowBox[{"2", "*", "dx"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"sols", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"AA", ",", "BB", ",", "CC", ",", "DD"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"funquarticfinal", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"funquartic", "//.", 
    RowBox[{"sols", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4128898194150476`*^9, 3.4128899536981373`*^9}, {
   3.412890047162533*^9, 3.4128900564959536`*^9}, 3.4128901907089424`*^9, {
   3.4128902404404526`*^9, 3.4128902684006577`*^9}, {3.412890351960811*^9, 
   3.4128903531425104`*^9}, {3.412890393710845*^9, 3.4128903956536384`*^9}, {
   3.412890722213208*^9, 3.4128907247268224`*^9}, {3.412890793716024*^9, 
   3.4128907942267585`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.4128907950078816`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.41289079502791*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AA", " ", "x"}], "+", 
  RowBox[{"BB", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"CC", " ", 
   SuperscriptBox["x", "3"]}], "+", 
  RowBox[{"DD", " ", 
   SuperscriptBox["x", "4"]}], "+", "y0"}]], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.412890795037925*^9}],

Cell[BoxData[
 RowBox[{"ym1", "\[Equal]", 
  RowBox[{
   RowBox[{"-", "AA"}], "+", "BB", "-", "CC", "+", "DD", "+", 
   "y0"}]}]], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.412890795057954*^9}],

Cell[BoxData[
 RowBox[{"ym2", "\[Equal]", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", "AA"}], "+", 
   RowBox[{"4", " ", "BB"}], "-", 
   RowBox[{"8", " ", "CC"}], "+", 
   RowBox[{"16", " ", "DD"}], "+", "y0"}]}]], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.4128907950779824`*^9}],

Cell[BoxData[
 RowBox[{"yp1", "\[Equal]", 
  RowBox[{"AA", "+", "BB", "+", "CC", "+", "DD", "+", "y0"}]}]], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.412890795098011*^9}],

Cell[BoxData[
 RowBox[{"yp2", "\[Equal]", 
  RowBox[{
   RowBox[{"2", " ", "AA"}], "+", 
   RowBox[{"4", " ", "BB"}], "+", 
   RowBox[{"8", " ", "CC"}], "+", 
   RowBox[{"16", " ", "DD"}], "+", "y0"}]}]], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.41289079511804*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"AA", "\[Rule]", 
     RowBox[{
      FractionBox["1", "12"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", "ym1"}], "+", "ym2", "+", 
        RowBox[{"8", " ", "yp1"}], "-", "yp2"}], ")"}]}]}], ",", 
    RowBox[{"BB", "\[Rule]", 
     RowBox[{
      FractionBox["1", "24"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "30"}], " ", "y0"}], "+", 
        RowBox[{"16", " ", "ym1"}], "-", "ym2", "+", 
        RowBox[{"16", " ", "yp1"}], "-", "yp2"}], ")"}]}]}], ",", 
    RowBox[{"CC", "\[Rule]", 
     RowBox[{
      FractionBox["1", "12"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "ym1"}], "-", "ym2", "-", 
        RowBox[{"2", " ", "yp1"}], "+", "yp2"}], ")"}]}]}], ",", 
    RowBox[{"DD", "\[Rule]", 
     RowBox[{
      FractionBox["1", "24"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"6", " ", "y0"}], "-", 
        RowBox[{"4", " ", "ym1"}], "+", "ym2", "-", 
        RowBox[{"4", " ", "yp1"}], "+", "yp2"}], ")"}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.412890795148083*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "24"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{"4", "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       SuperscriptBox["x", "4"]}], ")"}], " ", "y0"}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "x"}], ")"}], " ", "ym1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", "x"}], ")"}], " ", "x"}]}], ")"}], 
           " ", "ym2"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", "x"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", "yp1"}], "+", 
             "yp2", "-", 
             RowBox[{"x", " ", "yp2"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.412890057076789*^9, {3.412890250534968*^9, 3.4128902687211185`*^9}, 
   3.4128903539937344`*^9, 3.412890399649384*^9, 3.412890725047283*^9, 
   3.412890795168112*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ajplus1half", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"funquarticfinal", "//.", 
    RowBox[{"{", 
     RowBox[{"x", "\[Rule]", "0.5"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.412890411546491*^9, 3.412890454778656*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.703125`", " ", "y0"}], "-", 
  RowBox[{"0.15625`", " ", "ym1"}], "+", 
  RowBox[{"0.0234375`", " ", "ym2"}], "+", 
  RowBox[{"0.46875`", " ", "yp1"}], "-", 
  RowBox[{"0.0390625`", " ", "yp2"}]}]], "Output",
 CellChangeTimes->{3.412890418145981*^9, 3.41289045553975*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "but", " ", "we", " ", "need", " ", "to", " ", "use", " ", "limited", " ", 
    "slopes"}], " ", "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4128905694535503`*^9, 3.4128905749414415`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finaljon", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"funquarticfinal", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"yp2", "\[Rule]", 
       RowBox[{"dqp1", "-", "y0"}]}], ",", 
      RowBox[{"yp1", "\[Rule]", 
       RowBox[{"dq", "-", "ym1"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.412890581230485*^9, 3.4128906075683565`*^9}, {
  3.4128906411766834`*^9, 3.4128906636890545`*^9}, {3.4128907840621424`*^9, 
  3.4128907851236687`*^9}, {3.412891200210534*^9, 3.412891217775792*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "24"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", "dq", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", "x", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "x"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dqp1", " ", "x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "12"}], "+", 
          RowBox[{"5", " ", "x"}]}], ")"}], " ", "y0"}]}], ")"}]}], "+", 
    RowBox[{"8", " ", "x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", 
       SuperscriptBox["x", "2"]}], ")"}], " ", "ym1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", "x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["x", "2"]}], ")"}], " ", "ym2"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.4128906375514708`*^9, 3.4128906673042526`*^9}, {
  3.412890788688795*^9, 3.4128907987232237`*^9}, {3.4128912080217667`*^9, 
  3.4128912181363106`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"funquarticfinal", "//.", 
    RowBox[{"{", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4128913234377265`*^9, 3.4128913418441935`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "128"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"90", " ", "y0"}], "-", 
    RowBox[{"20", " ", "ym1"}], "+", 
    RowBox[{"3", " ", "ym2"}], "+", 
    RowBox[{"60", " ", "yp1"}], "-", 
    RowBox[{"5", " ", "yp2"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.4128913363062305`*^9, 3.4128913421245966`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finaljon", "//.", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.412891218877376*^9, 3.4128912234940147`*^9}, 
   3.4128912720438256`*^9, {3.412891303669301*^9, 3.4128913059225407`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "24"], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"45", " ", "dq"}], "4"], "-", 
    RowBox[{
     FractionBox["15", "8"], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["dqp1", "2"], "-", 
       FractionBox[
        RowBox[{"19", " ", "y0"}], "2"]}], ")"}]}], "-", 
    RowBox[{"15", " ", "ym1"}], "+", 
    FractionBox[
     RowBox[{"9", " ", "ym2"}], "16"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.412891221611307*^9, 3.412891223704317*^9}, 
   3.4128912723342433`*^9, 3.412891306243002*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"ok", ",", " ", 
    RowBox[{
    "really", " ", "need", " ", "3", "rd", " ", "order", " ", 
     "polynomial"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"da", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"yp1", "-", "ym1"}], ")"}], "/", "2"}]}], "\[IndentingNewLine]",
    
   RowBox[{"dap1", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"yp2", " ", "-", " ", "y0"}], ")"}], "/", "2"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"fun3rdjphalf", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{"y0", "+", "yp1"}], ")"}]}], " ", "-", " ", 
     RowBox[{"A", "*", 
      RowBox[{"(", 
       RowBox[{"dap1", " ", "-", " ", "da"}], ")"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.412899382596227*^9, 3.412899497050805*^9}, {
  3.412899752418005*^9, 3.412899767740037*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "ym1"}], "+", "yp1"}], ")"}]}]], "Output",
 CellChangeTimes->{3.412899502268307*^9, 3.412899768310858*^9, 
  3.4129146163813343`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "y0"}], "+", "yp2"}], ")"}]}]], "Output",
 CellChangeTimes->{3.412899502268307*^9, 3.412899768310858*^9, 
  3.4129146164013634`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"y0", "+", "yp1"}], "2"], "-", 
  RowBox[{"A", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"ym1", "-", "yp1"}], "2"], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y0"}], "+", "yp2"}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.412899502268307*^9, 3.412899768310858*^9, 
  3.4129146164614496`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dx", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"x0", "=", "0"}], "\[IndentingNewLine]", 
 RowBox[{"fun3rd", "=", 
  RowBox[{"y0", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "-", "x0"}], ")"}], "*", "AA"}], " ", "+", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}], "*", "BB"}], " ", "+", " ",
    
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "x0"}], ")"}], "^", "3"}], "*", 
    "CC"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{"ym1", "==", "fun3rd"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "-", "dx"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{"yp1", "==", "fun3rd"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "+", "dx"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq3", "=", 
  RowBox[{
   RowBox[{"yp2", "==", "fun3rd"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "+", 
      RowBox[{"2", "*", "dx"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"sols", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eq1", ",", "eq2", ",", "eq3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"AA", ",", "BB", ",", "CC"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fun3rdfinal", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"fun3rd", "//.", 
    RowBox[{"sols", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.41289951390504*^9, 3.4128995511185503`*^9}, {
  3.412899583705408*^9, 3.412899590435085*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.4129153632052145`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.4129153632052145`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AA", " ", "x"}], "+", 
  RowBox[{"BB", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"CC", " ", 
   SuperscriptBox["x", "3"]}], "+", "y0"}]], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.412915363225243*^9}],

Cell[BoxData[
 RowBox[{"ym1", "\[Equal]", 
  RowBox[{
   RowBox[{"-", "AA"}], "+", "BB", "-", "CC", "+", "y0"}]}]], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.412915363255286*^9}],

Cell[BoxData[
 RowBox[{"yp1", "\[Equal]", 
  RowBox[{"AA", "+", "BB", "+", "CC", "+", "y0"}]}]], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.4129153632753153`*^9}],

Cell[BoxData[
 RowBox[{"yp2", "\[Equal]", 
  RowBox[{
   RowBox[{"2", " ", "AA"}], "+", 
   RowBox[{"4", " ", "BB"}], "+", 
   RowBox[{"8", " ", "CC"}], "+", "y0"}]}]], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.4129153633053584`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"AA", "\[Rule]", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "y0"}], "-", 
        RowBox[{"2", " ", "ym1"}], "+", 
        RowBox[{"6", " ", "yp1"}], "-", "yp2"}], ")"}]}]}], ",", 
    RowBox[{"BB", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "y0"}], "+", "ym1", "+", "yp1"}], ")"}]}]}],
     ",", 
    RowBox[{"CC", "\[Rule]", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "y0"}], "-", "ym1", "-", 
        RowBox[{"3", " ", "yp1"}], "+", "yp2"}], ")"}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.412915363325387*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["x", "2"]}], ")"}], " ", "y0"}], "+", 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{"ym1", "-", 
          RowBox[{"x", " ", "ym1"}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x"}], ")"}], " ", "yp1"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["x", "2"]}], ")"}], " ", "yp2"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.412899546091322*^9, 3.4128995515291405`*^9}, 
   3.4128995907355165`*^9, 3.412899769222168*^9, 3.4129146170923567`*^9, 
   3.412915363345416*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"my3rdjphalf", "=", 
  RowBox[{"fun3rdfinal", "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"diff", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"fun3rdjphalf", "-", "my3rdjphalf"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"diff", "\[Equal]", "0"}], ",", "A"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4128995608825903`*^9, 3.412899565469186*^9}, {
  3.412899608511077*^9, 3.412899614379515*^9}, {3.4129153700450497`*^9, 
  3.412915370185251*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["3", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"9", " ", "y0"}], "4"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["ym1", "2"], "-", 
          FractionBox[
           RowBox[{"9", " ", "yp1"}], "2"]}], ")"}]}]}], ")"}]}], "-", 
    FractionBox[
     RowBox[{"3", " ", "yp2"}], "8"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.412899565789646*^9, 3.4128996211392355`*^9}, 
   3.4128997704339104`*^9, 3.4129146181839266`*^9, {3.4129153640364094`*^9, 
   3.412915370555784*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"8", " ", "A"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"y0", "-", "ym1", "+", "yp1", "-", "yp2"}], ")"}]}]], "Output",
 CellChangeTimes->{{3.412899565789646*^9, 3.4128996211392355`*^9}, 
   3.4128997704339104`*^9, 3.4129146181839266`*^9, {3.4129153640364094`*^9, 
   3.412915370575813*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"A", "\[Rule]", 
    FractionBox["1", "8"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.412899565789646*^9, 3.4128996211392355`*^9}, 
   3.4128997704339104`*^9, 3.4129146181839266`*^9, {3.4129153640364094`*^9, 
   3.4129153705958414`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "determine", " ", "effective", " ", "slope", " ", "at", " ", "center", " ", 
   "to", " ", "see", " ", "if", " ", "want", " ", "to", " ", "use", " ", 
   "MC"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.412914621508707*^9, 3.412914627957981*^9}, {
  3.4129150641051297`*^9, 3.41291506735981*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"right", "-", 
   RowBox[{"hand", " ", "is", " ", "already", " ", "obtained"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.4129153200431504`*^9, 3.412915328244944*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"get", " ", "left"}], "-", "hand"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.412915331800056*^9, 3.412915334754304*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"da", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"yp1", "-", "ym1"}], ")"}], "/", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"dam1", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"y0", " ", "-", " ", "ym2"}], ")"}], "/", 
   "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"fun3rdjmhalf", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"ym1", "+", "y0"}], ")"}]}], " ", "-", " ", 
   RowBox[{"A", "*", 
    RowBox[{"(", 
     RowBox[{"da", " ", "-", " ", "dam1"}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.412915430251622*^9, 3.4129154858816147`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "ym1"}], "+", "yp1"}], ")"}]}]], "Output",
 CellChangeTimes->{3.412915503747304*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"y0", "-", "ym2"}], "2"]], "Output",
 CellChangeTimes->{3.412915503777347*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"y0", "+", "ym1"}], "2"], "-", 
  RowBox[{"A", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y0"}], "+", "ym2"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ym1"}], "+", "yp1"}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.4129155037973757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dx", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"x0", "=", "0"}], "\[IndentingNewLine]", 
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{"ym1", "==", "fun3rd"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "-", "dx"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{"yp1", "==", "fun3rd"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "+", "dx"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq3", "=", 
  RowBox[{
   RowBox[{"ym2", "==", "fun3rd"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"x0", "-", 
      RowBox[{"2", "*", "dx"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"sols", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eq1", ",", "eq2", ",", "eq3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"AA", ",", "BB", ",", "CC"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fun3rdfinalleft", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"fun3rd", "//.", 
    RowBox[{"sols", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.412915339481101*^9, 3.412915382172488*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.4129153526900945`*^9, 3.412915388952237*^9, 
  3.412915507202272*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.4129153526900945`*^9, 3.412915388952237*^9, 
  3.4129155072122865`*^9}],

Cell[BoxData[
 RowBox[{"ym1", "\[Equal]", 
  RowBox[{
   RowBox[{"-", "AA"}], "+", "BB", "-", "CC", "+", "y0"}]}]], "Output",
 CellChangeTimes->{3.4129153526900945`*^9, 3.412915388952237*^9, 
  3.4129155072423296`*^9}],

Cell[BoxData[
 RowBox[{"yp1", "\[Equal]", 
  RowBox[{"AA", "+", "BB", "+", "CC", "+", "y0"}]}]], "Output",
 CellChangeTimes->{3.4129153526900945`*^9, 3.412915388952237*^9, 
  3.4129155072623587`*^9}],

Cell[BoxData[
 RowBox[{"ym2", "\[Equal]", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", "AA"}], "+", 
   RowBox[{"4", " ", "BB"}], "-", 
   RowBox[{"8", " ", "CC"}], "+", "y0"}]}]], "Output",
 CellChangeTimes->{3.4129153526900945`*^9, 3.412915388952237*^9, 
  3.4129155072823873`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"AA", "\[Rule]", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "y0"}], "-", 
        RowBox[{"6", " ", "ym1"}], "+", "ym2", "+", 
        RowBox[{"2", " ", "yp1"}]}], ")"}]}]}], ",", 
    RowBox[{"BB", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "y0"}], "+", "ym1", "+", "yp1"}], ")"}]}]}],
     ",", 
    RowBox[{"CC", "\[Rule]", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "y0"}], "+", 
        RowBox[{"3", " ", "ym1"}], "-", "ym2", "+", "yp1"}], ")"}]}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{3.4129153526900945`*^9, 3.412915388952237*^9, 
  3.4129155073124304`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "x"}], ")"}], " ", "y0"}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "x", "+", 
          SuperscriptBox["x", "2"]}], ")"}], " ", "ym1"}], "+", "ym2", "-", 
       RowBox[{
        SuperscriptBox["x", "2"], " ", "ym2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "x"}], ")"}], " ", "yp1"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.4129153526900945`*^9, 3.412915388952237*^9, 
  3.4129155073324594`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"my3rdjmhalf", "=", 
  RowBox[{"fun3rdfinalleft", "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"diff", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"fun3rdjmhalf", "-", "my3rdjmhalf"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"diff", "\[Equal]", "0"}], ",", "A"}], "]"}]}], "Input",
 CellChangeTimes->{{3.412915408550418*^9, 3.412915408940979*^9}, {
  3.4129155113682623`*^9, 3.4129155258590994`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"27", " ", "y0"}], "8"], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"27", " ", "ym1"}], "4"], "-", 
       FractionBox[
        RowBox[{"3", " ", "ym2"}], "4"], "-", 
       FractionBox[
        RowBox[{"3", " ", "yp1"}], "4"]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.4129154094216704`*^9, 3.4129155293841677`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"8", " ", "A"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"y0", "+", "ym1", "-", "ym2", "-", "yp1"}], ")"}]}]], "Output",
 CellChangeTimes->{3.4129154094216704`*^9, 3.4129155294542685`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"A", "\[Rule]", 
    FractionBox["1", "8"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.4129154094216704`*^9, 3.4129155294742975`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"so", " ", "same", " ", "coefficient", " ", "as", " ", "expected"}],
   " ", "*)"}]], "Input",
 CellChangeTimes->{{3.41291553127689*^9, 3.4129155370151405`*^9}}],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "now", " ", "finally", " ", "get", " ", "derivatives", " ", "at", " ", 
   "center"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.412915540800584*^9, 3.412915546859296*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.412915094889395*^9, 3.4129150962012815`*^9}, 
   3.4129155493128242`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sloperight", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"fun3rdfinal", ",", "x"}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"x", "\[Rule]", "0"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"slopeleft", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"fun3rdfinalleft", ",", "x"}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"x", "\[Rule]", "0"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4129146324444323`*^9, 3.4129146986496305`*^9}, {
  3.4129156278357344`*^9, 3.4129156302892623`*^9}, {3.41299230305412*^9, 
  3.4129923084719105`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", "y0"}], "-", 
    RowBox[{"2", " ", "ym1"}], "+", 
    RowBox[{"6", " ", "yp1"}], "-", "yp2"}], ")"}]}]], "Output",
 CellChangeTimes->{{3.4129146418078957`*^9, 3.41291469889999*^9}, 
   3.4129156307899823`*^9, 3.412992309112832*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", " ", "y0"}], "-", 
    RowBox[{"6", " ", "ym1"}], "+", "ym2", "+", 
    RowBox[{"2", " ", "yp1"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.4129146418078957`*^9, 3.41291469889999*^9}, 
   3.4129156307899823`*^9, 3.412992309132861*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Expand", "[", "sloperight", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", "slopeleft", "]"}]}], "Input",
 CellChangeTimes->{{3.412992813808549*^9, 3.412992818835778*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["y0", "2"]}], "-", 
  FractionBox["ym1", "3"], "+", "yp1", "-", 
  FractionBox["yp2", "6"]}]], "Output",
 CellChangeTimes->{3.4129928191762676`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["y0", "2"], "-", "ym1", "+", 
  FractionBox["ym2", "6"], "+", 
  FractionBox["yp1", "3"]}]], "Output",
 CellChangeTimes->{3.4129928192063107`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"consts", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"y0", "\[Rule]", "0.5"}], ",", 
    RowBox[{"ym1", "\[Rule]", "0.2"}], ",", 
    RowBox[{"yp1", "\[Rule]", "0.2"}], ",", 
    RowBox[{"yp2", "\[Rule]", "0.1"}], ",", 
    RowBox[{"ym2", "\[Rule]", "0.1"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun3rdfinal", "//.", "consts"}], "//.", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun3rdfinalleft", "//.", "consts"}], "//.", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"slopeleft", "//.", "consts"}], "\[IndentingNewLine]", 
 RowBox[{"sloperight", "//.", "consts"}]}], "Input",
 CellChangeTimes->{{3.412992309673639*^9, 3.4129923394164066`*^9}, {
  3.4129924818912754`*^9, 3.4129925002176275`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"y0", "\[Rule]", "0.5`"}], ",", 
   RowBox[{"ym1", "\[Rule]", "0.2`"}], ",", 
   RowBox[{"yp1", "\[Rule]", "0.2`"}], ",", 
   RowBox[{"yp2", "\[Rule]", "0.1`"}], ",", 
   RowBox[{"ym2", "\[Rule]", "0.1`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4129923395766373`*^9, {3.4129924877897573`*^9, 3.412992501048823*^9}}],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{
  3.4129923395766373`*^9, {3.4129924877897573`*^9, 3.4129925010688515`*^9}}],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{
  3.4129923395766373`*^9, {3.4129924877897573`*^9, 3.412992501078866*^9}}],

Cell[BoxData["0.1333333333333333`"], "Output",
 CellChangeTimes->{
  3.4129923395766373`*^9, {3.4129924877897573`*^9, 3.412992501078866*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.1333333333333333`"}]], "Output",
 CellChangeTimes->{
  3.4129923395766373`*^9, {3.4129924877897573`*^9, 3.412992501078866*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4129007100950766`*^9, 3.412900712328288*^9}, {
   3.4129155568035955`*^9, 3.4129155900313745`*^9}, 3.4129156326226177`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "consider", " ", "monotonicity", " ", "of", " ", "3", "rd", " ", "order", 
   " ", "polynomial", " ", "in", " ", "general"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.4129202549592113`*^9, 3.4129202623698673`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solsx", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"fun3rdfinal", ",", "x"}], "]"}], "\[Equal]", "0"}], ",", "x"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.412920091724491*^9, 3.412920093356838*^9}, {
  3.4129201646593666`*^9, 3.412920190236144*^9}, {3.4129202208301363`*^9, 
  3.4129202219918065`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "y0"}], "-", "ym1", "-", 
          RowBox[{"3", " ", "yp1"}], "+", "yp2"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"6", " ", "y0"}], "-", 
        RowBox[{"3", " ", "ym1"}], "-", 
        RowBox[{"3", " ", "yp1"}], "-", 
        RowBox[{
         SqrtBox["3"], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"21", " ", 
            SuperscriptBox["y0", "2"]}], "-", 
           RowBox[{"9", " ", "y0", " ", "ym1"}], "+", 
           SuperscriptBox["ym1", "2"], "-", 
           RowBox[{"39", " ", "y0", " ", "yp1"}], "+", 
           RowBox[{"6", " ", "ym1", " ", "yp1"}], "+", 
           RowBox[{"21", " ", 
            SuperscriptBox["yp1", "2"]}], "+", 
           RowBox[{"6", " ", "y0", " ", "yp2"}], "+", 
           RowBox[{"ym1", " ", "yp2"}], "-", 
           RowBox[{"9", " ", "yp1", " ", "yp2"}], "+", 
           SuperscriptBox["yp2", "2"]}]]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "y0"}], "-", "ym1", "-", 
          RowBox[{"3", " ", "yp1"}], "+", "yp2"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"6", " ", "y0"}], "-", 
        RowBox[{"3", " ", "ym1"}], "-", 
        RowBox[{"3", " ", "yp1"}], "+", 
        RowBox[{
         SqrtBox["3"], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"21", " ", 
            SuperscriptBox["y0", "2"]}], "-", 
           RowBox[{"9", " ", "y0", " ", "ym1"}], "+", 
           SuperscriptBox["ym1", "2"], "-", 
           RowBox[{"39", " ", "y0", " ", "yp1"}], "+", 
           RowBox[{"6", " ", "ym1", " ", "yp1"}], "+", 
           RowBox[{"21", " ", 
            SuperscriptBox["yp1", "2"]}], "+", 
           RowBox[{"6", " ", "y0", " ", "yp2"}], "+", 
           RowBox[{"ym1", " ", "yp2"}], "-", 
           RowBox[{"9", " ", "yp1", " ", "yp2"}], "+", 
           SuperscriptBox["yp2", "2"]}]]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4129200937474003`*^9, {3.412920166371829*^9, 3.412920190957181*^9}, 
   3.412920222492526*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"fun3rdfinal", "//.", 
    RowBox[{"solsx", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.412920203705512*^9, 3.4129202481994915`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.4129202386056957`*^9, 3.4129202798850527`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"M", "=", 
  RowBox[{"3", "*", "msun"}]}], "\[IndentingNewLine]", 
 RowBox[{"rl", "=", 
  RowBox[{"G", "*", 
   RowBox[{"M", "/", 
    RowBox[{"c", "^", "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"10", "^", "11"}], "/", "rl"}]}], "Input",
 CellChangeTimes->{{3.4129826024653587`*^9, 3.4129826486718006`*^9}}],

Cell[BoxData["5.967`*^33"], "Output",
 CellChangeTimes->{{3.4129826117687364`*^9, 3.41298264942288*^9}}],

Cell[BoxData["442966.282051968`"], "Output",
 CellChangeTimes->{{3.4129826117687364`*^9, 3.41298264942288*^9}}],

Cell[BoxData["225750.81682688478`"], "Output",
 CellChangeTimes->{{3.4129826117687364`*^9, 3.4129826494328947`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"3", "*", 
   RowBox[{"AU", "/", 
    RowBox[{"10", "^", 
     RowBox[{"(", "11.", ")"}]}]}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4129827123533697`*^9, 3.4129827263535013`*^9}}],

Cell[BoxData["448.794`"], "Output",
 CellChangeTimes->{{3.412982714977143*^9, 3.4129827267340484`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"para", "'"}], "s", " ", "concept", " ", "of", " ", "starting", 
   " ", "with", " ", "continuous", " ", "solution", " ", "at", " ", "edge", 
   " ", "is", " ", "inconsistent", " ", "with", " ", "Riemann", " ", 
   "problem", " ", "since", " ", "this", " ", "generates", " ", "jumps", " ", 
   "somewhere", " ", "inside", " ", "the", " ", "cell"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.41306351811348*^9, 3.413063545723181*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "MC", " ", "works", " ", "well", " ", "with", " ", "other", " ", "para", 
    " ", "features"}], ",", " ", 
   RowBox[{"so", " ", "try", " ", "parabolic", " ", "version"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.4130635470150385`*^9, 3.4130635660423985`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"x0", "=", "0"}], "\[IndentingNewLine]", 
 RowBox[{"funpara", "=", 
  RowBox[{"y0", "+", 
   RowBox[{"B", "*", 
    RowBox[{"(", 
     RowBox[{"x", "-", "x0"}], ")"}]}], "+", 
   RowBox[{"C", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "x0"}], ")"}], "^", 
     "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{"ym1", "==", "fun"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{"yp1", "\[Equal]", "fun"}], "//.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"solBC", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eq1", ",", "eq2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "C"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"finalfunpara", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"funpara", "//.", 
    RowBox[{"solBC", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"finalfunparaleft", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"finalfunpara", "//.", 
     RowBox[{"{", 
      RowBox[{"x", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"yp1", "\[Rule]", 
       RowBox[{"y0", "-", "Dqp"}]}], ",", 
      RowBox[{"ym1", "\[Rule]", 
       RowBox[{"y0", "-", "Dqm"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"finalfunpararight", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"finalfunpara", "//.", 
     RowBox[{"{", 
      RowBox[{"x", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], "}"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"yp1", "\[Rule]", 
       RowBox[{"y0", "-", "Dqp"}]}], ",", 
      RowBox[{"ym1", "\[Rule]", 
       RowBox[{"y0", "-", "Dqm"}]}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.413063568756301*^9, 3.413063691502802*^9}, {
  3.4130637393115473`*^9, 3.413063798446579*^9}, {3.4130640481055713`*^9, 
  3.413064051500453*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.4130653762854*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", " ", "x"}], "+", 
  RowBox[{"C", " ", 
   SuperscriptBox["x", "2"]}], "+", "y0"}]], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.413065376315443*^9}],

Cell[BoxData[
 RowBox[{"ym1", "\[Equal]", 
  RowBox[{
   RowBox[{"-", "B"}], "+", "C", "+", "y0"}]}]], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.4130653763454866`*^9}],

Cell[BoxData[
 RowBox[{"yp1", "\[Equal]", 
  RowBox[{"B", "+", "C", "+", "y0"}]}]], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.413065376465659*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"B", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ym1"}], "+", "yp1"}], ")"}]}]}], ",", 
    RowBox[{"C", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "y0"}], "+", "ym1", "+", "yp1"}], 
       ")"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.413065376465659*^9}],

Cell[BoxData[
 RowBox[{"y0", "-", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", "y0"}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "ym1"}], "+", "yp1", "+", 
     
     RowBox[{"x", " ", "yp1"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.413065376465659*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "Dqm"}], "+", "Dqp"}], ")"}]}], "+", 
  "y0"}]], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.413065376465659*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"Dqm", "-", 
     RowBox[{"3", " ", "Dqp"}]}], ")"}]}], "+", "y0"}]], "Output",
 CellChangeTimes->{{3.4130636096851535`*^9, 3.4130636799061265`*^9}, {
   3.4130637730500607`*^9, 3.413063798726982*^9}, 3.4130640519711294`*^9, 
   3.413065376465659*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.413065430152858*^9, 3.413065432586357*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"myleft", "=", 
  RowBox[{"y0", "+", 
   RowBox[{
    RowBox[{"1", "/", "8"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", "*", "Dqc"}], "-", 
      RowBox[{"(", 
       RowBox[{"Dqp", "+", "Dqm"}], ")"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"finalfunparaleft", "-", "myleft"}], "]"}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Dqc", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Dqp", "-", "Dqm"}], ")"}], "/", "2"}]}], ",", 
    RowBox[{"Dqp", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"yp1", "-", "y0"}], ")"}]}], ",", 
    RowBox[{"Dqm", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"y0", "-", "ym1"}], ")"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.4130639925356655`*^9, 3.4130640381212144`*^9}, {
  3.413065159173208*^9, 3.413065206240888*^9}, {3.4130652644946527`*^9, 
  3.413065303000021*^9}, {3.4130653611736703`*^9, 3.4130653668017635`*^9}, {
  3.4130654115861597`*^9, 3.4130654350298705`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", "Dqc"}], "-", "Dqm", "-", "Dqp"}], ")"}]}], "+", 
  "y0"}]], "Output",
 CellChangeTimes->{{3.4130653672123537`*^9, 3.413065377336912*^9}, {
  3.4130654131484065`*^9, 3.4130654353102736`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.4130653672123537`*^9, 3.413065377336912*^9}, {
  3.4130654131484065`*^9, 3.4130654353303022`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"myright", "=", 
  RowBox[{"y0", "+", 
   RowBox[{
    RowBox[{"1", "/", "8"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], "*", "Dqc"}], "-", 
      RowBox[{"(", 
       RowBox[{"Dqp", "+", "Dqm"}], ")"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"finalfunpararight", "-", "myright"}], "]"}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Dqc", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Dqp", "-", "Dqm"}], ")"}], "/", "2"}]}], ",", 
    RowBox[{"Dqp", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"yp1", "-", "y0"}], ")"}]}], ",", 
    RowBox[{"Dqm", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"y0", "-", "ym1"}], ")"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.4130640635177326`*^9, 3.4130640843576994`*^9}, 
   3.413064158203885*^9, {3.4130651100425615`*^9, 3.413065118484701*^9}, {
   3.413065440738078*^9, 3.413065445534976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", "Dqc"}], "-", "Dqm", "-", "Dqp"}], ")"}]}], 
  "+", "y0"}]], "Output",
 CellChangeTimes->{{3.4130640739827805`*^9, 3.413064082905611*^9}, 
   3.4130641607675714`*^9, 3.4130651638899903`*^9, 3.4130654463261137`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.4130640739827805`*^9, 3.413064082905611*^9}, 
   3.4130641607675714`*^9, 3.4130651638899903`*^9, 3.413065446356157*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"try", " ", "to", " ", "get", " ", "into", " ", "0.5", 
    RowBox[{"(", 
     RowBox[{"y1", "+", "y2"}], ")"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Dq1", "-", "Dq2"}], ")"}], " ", "form"}]}]}]], "Input",
 CellChangeTimes->{{3.413064464744669*^9, 3.4130644892999773`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"finalfunparaleft", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"finalfunpara", "//.", 
    RowBox[{"{", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"finalfunpararight", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"finalfunpara", "//.", 
    RowBox[{"{", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fragleft", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"finalfunparaleft", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"y0", "+", "ym1"}], ")"}], "/", "2"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.413064531550731*^9, 3.413064534374792*^9}, {
  3.413064678762411*^9, 3.4130647182291613`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", "y0"}], "+", 
    RowBox[{"3", " ", "ym1"}], "-", "yp1"}], ")"}]}]], "Output",
 CellChangeTimes->{3.413064719671235*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", "y0"}], "-", "ym1", "+", 
    RowBox[{"3", " ", "yp1"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.413064719671235*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "y0"}], "-", "ym1", "-", "yp1"}], ")"}]}]], "Output",
 CellChangeTimes->{3.4130647197012787`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"AHH", ",", " ", 
   RowBox[{
   "so", " ", "centered", " ", "slope", " ", "is", " ", "actually", " ", "3", 
    "rd", " ", "order", " ", "accurate"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.413065690567315*^9, 3.413065702073861*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "So", " ", "for", " ", "higher", " ", "order", " ", "need", " ", "to", " ",
     "consider", " ", "5", " ", "points"}], ",", " ", 
   RowBox[{"like", " ", "WENO"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.413065703686179*^9, 3.4130657144616737`*^9}}]
},
WindowSize->{794, 970},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (April 20, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 1300, 42, 112, "Input"],
Cell[1893, 67, 375, 10, 30, "Output"],
Cell[2271, 79, 570, 17, 46, "Output"],
Cell[2844, 98, 459, 13, 30, "Output"],
Cell[3306, 113, 733, 22, 48, "Output"],
Cell[4042, 137, 1449, 47, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5528, 189, 908, 26, 92, "Input"],
Cell[6439, 217, 242, 5, 30, "Output"],
Cell[6684, 224, 288, 7, 45, "Output"],
Cell[6975, 233, 240, 5, 30, "Output"],
Cell[7218, 240, 1390, 48, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8645, 293, 1427, 43, 96, "Input"],
Cell[10075, 338, 432, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10544, 354, 399, 13, 31, "Input"],
Cell[10946, 369, 424, 14, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11407, 388, 216, 5, 31, "Input"],
Cell[11626, 395, 2463, 85, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14126, 485, 254, 6, 31, "Input"],
Cell[14383, 493, 151, 3, 30, "Output"]
}, Open  ]],
Cell[14549, 499, 285, 6, 31, "Input"],
Cell[14837, 507, 236, 5, 52, "Input"],
Cell[15076, 514, 205, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[15306, 522, 510, 16, 31, "Input"],
Cell[15819, 540, 526, 17, 54, "Output"]
}, Open  ]],
Cell[16360, 560, 312, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[16697, 570, 1446, 42, 92, "Input"],
Cell[18146, 614, 944, 30, 45, "Output"],
Cell[19093, 646, 275, 4, 30, "Output"],
Cell[19371, 652, 601, 16, 45, "Output"],
Cell[19975, 670, 601, 16, 45, "Output"]
}, Open  ]],
Cell[20591, 689, 272, 4, 31, "Input"],
Cell[20866, 695, 169, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[21060, 702, 214, 4, 31, "Input"],
Cell[21277, 708, 77, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21391, 714, 2345, 66, 192, "Input"],
Cell[23739, 782, 221, 4, 30, "Output"],
Cell[23963, 788, 218, 4, 30, "Output"],
Cell[24184, 794, 443, 12, 30, "Output"],
Cell[24630, 808, 331, 8, 30, "Output"],
Cell[24964, 818, 427, 11, 30, "Output"],
Cell[25394, 831, 308, 6, 30, "Output"],
Cell[25705, 839, 404, 10, 30, "Output"],
Cell[26112, 851, 1344, 40, 79, "Output"],
Cell[27459, 893, 1656, 52, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29152, 950, 263, 6, 31, "Input"],
Cell[29418, 958, 307, 7, 30, "Output"]
}, Open  ]],
Cell[29740, 968, 270, 6, 52, "Input"],
Cell[CellGroupData[{
Cell[30035, 978, 539, 12, 31, "Input"],
Cell[30577, 992, 1419, 45, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32033, 1042, 284, 7, 31, "Input"],
Cell[32320, 1051, 357, 10, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32714, 1066, 280, 6, 31, "Input"],
Cell[32997, 1074, 575, 18, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33609, 1097, 948, 28, 92, "Input"],
Cell[34560, 1127, 233, 7, 45, "Output"],
Cell[34796, 1136, 232, 7, 45, "Output"],
Cell[35031, 1145, 449, 15, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35517, 1165, 1668, 51, 172, "Input"],
Cell[37188, 1218, 198, 3, 30, "Output"],
Cell[37389, 1223, 198, 3, 30, "Output"],
Cell[37590, 1228, 361, 9, 30, "Output"],
Cell[37954, 1239, 293, 6, 30, "Output"],
Cell[38250, 1247, 276, 5, 30, "Output"],
Cell[38529, 1254, 348, 8, 30, "Output"],
Cell[38880, 1264, 990, 31, 45, "Output"],
Cell[39873, 1297, 985, 31, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40895, 1333, 602, 15, 72, "Input"],
Cell[41500, 1350, 754, 24, 45, "Output"],
Cell[42257, 1376, 420, 11, 45, "Output"],
Cell[42680, 1389, 300, 7, 45, "Output"]
}, Open  ]],
Cell[42995, 1399, 348, 7, 31, "Input"],
Cell[43346, 1408, 220, 5, 31, "Input"],
Cell[43569, 1415, 182, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[43776, 1423, 654, 19, 72, "Input"],
Cell[44433, 1444, 184, 6, 45, "Output"],
Cell[44620, 1452, 116, 3, 45, "Output"],
Cell[44739, 1457, 481, 17, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45257, 1479, 1209, 35, 152, "Input"],
Cell[46469, 1516, 119, 2, 30, "Output"],
Cell[46591, 1520, 121, 2, 30, "Output"],
Cell[46715, 1524, 218, 5, 30, "Output"],
Cell[46936, 1531, 199, 4, 30, "Output"],
Cell[47138, 1537, 291, 8, 30, "Output"],
Cell[47432, 1547, 916, 30, 45, "Output"],
Cell[48351, 1579, 959, 31, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49347, 1615, 579, 15, 72, "Input"],
Cell[49929, 1632, 521, 17, 45, "Output"],
Cell[50453, 1651, 316, 9, 45, "Output"],
Cell[50772, 1662, 194, 5, 45, "Output"]
}, Open  ]],
Cell[50981, 1670, 206, 4, 31, "Input"],
Cell[51190, 1676, 26, 0, 31, "Input"],
Cell[51219, 1678, 223, 5, 31, "Input"],
Cell[51445, 1685, 122, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[51592, 1691, 671, 17, 52, "Input"],
Cell[52266, 1710, 358, 10, 45, "Output"],
Cell[52627, 1722, 337, 9, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53001, 1736, 204, 3, 52, "Input"],
Cell[53208, 1741, 203, 6, 45, "Output"],
Cell[53414, 1749, 184, 5, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53635, 1759, 853, 20, 112, "Input"],
Cell[54491, 1781, 372, 9, 30, "Output"],
Cell[54866, 1792, 128, 2, 30, "Output"],
Cell[54997, 1796, 126, 2, 30, "Output"],
Cell[55126, 1800, 141, 2, 30, "Output"],
Cell[55270, 1804, 158, 3, 30, "Output"]
}, Open  ]],
Cell[55443, 1810, 172, 2, 31, "Input"],
Cell[55618, 1814, 266, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[55909, 1823, 383, 10, 31, "Input"],
Cell[56295, 1835, 2381, 66, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58713, 1906, 253, 6, 31, "Input"],
Cell[58969, 1914, 103, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59109, 1920, 346, 9, 72, "Input"],
Cell[59458, 1931, 104, 1, 30, "Output"],
Cell[59565, 1934, 111, 1, 30, "Output"],
Cell[59679, 1937, 116, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59832, 1943, 234, 6, 52, "Input"],
Cell[60069, 1951, 103, 1, 30, "Output"]
}, Open  ]],
Cell[60187, 1955, 496, 9, 52, "Input"],
Cell[60686, 1966, 331, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[61042, 1978, 2157, 65, 172, "Input"],
Cell[63202, 2045, 198, 3, 30, "Output"],
Cell[63403, 2050, 304, 7, 30, "Output"],
Cell[63710, 2059, 286, 6, 30, "Output"],
Cell[63999, 2067, 265, 5, 30, "Output"],
Cell[64267, 2074, 648, 20, 45, "Output"],
Cell[64918, 2096, 539, 16, 45, "Output"],
Cell[65460, 2114, 372, 11, 45, "Output"],
Cell[65835, 2127, 347, 9, 45, "Output"]
}, Open  ]],
Cell[66197, 2139, 92, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[66314, 2144, 1035, 29, 52, "Input"],
Cell[67352, 2175, 311, 9, 45, "Output"],
Cell[67666, 2186, 149, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67852, 2193, 982, 29, 72, "Input"],
Cell[68837, 2224, 356, 10, 45, "Output"],
Cell[69196, 2236, 170, 2, 30, "Output"]
}, Open  ]],
Cell[69381, 2241, 355, 9, 31, "Input"],
Cell[CellGroupData[{
Cell[69761, 2254, 812, 22, 72, "Input"],
Cell[70576, 2278, 225, 7, 45, "Output"],
Cell[70804, 2287, 225, 7, 45, "Output"],
Cell[71032, 2296, 202, 6, 45, "Output"]
}, Open  ]],
Cell[71249, 2305, 287, 6, 31, "Input"],
Cell[71539, 2313, 318, 7, 31, "Input"]
}
]
*)

(* End of internal cache information *)
