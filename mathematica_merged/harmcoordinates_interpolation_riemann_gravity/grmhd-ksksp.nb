(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     96441,       2742]
NotebookOptionsPosition[     92674,       2626]
NotebookOutlinePosition[     93041,       2642]
CellTagsIndexPosition[     92998,       2639]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "Calculus`VectorAnalysis`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "LinearAlgebra`Orthogonalization`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "DiscreteMath`Combinatorica`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Graphics`Graphics`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Graphics`ImplicitPlot`"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"newpkg\"\>"}], 
  RowBox[{
  ":", " "}], \
"\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"Calculus`VectorAnalysis`\\\"\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is now available as \
the \\\\\\\"\\\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"Vector \
Analysis Package\\\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\
\". See the Compatibility Guide for updating information.\\\\\\\"\\\", \\\"MT\
\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\
\", ButtonFrame->None, \
ButtonData:>\\\"paclet:Compatibility/Tutorials/Calculus/VectorAnalysis\\\", \
ButtonNote -> \\\"General::newpkg\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.400875452895872*^9, 3.410722595223091*^9, 
  3.4120615294878497`*^9, 3.4295467063820624`*^9, 3.4295467467801523`*^9, 
  3.430242864257496*^9, 3.4303613896360464`*^9, 3.4305054011309566`*^9, 
  3.444603993503315*^9, 3.4446046496267743`*^9, 3.477688308293256*^9, 
  3.4776908480051823`*^9, 3.4788063975666733`*^9, 3.4789982827839465`*^9, 
  3.479500145929082*^9, 3.479525388476082*^9, 3.480025633242237*^9, 
  3.496183499606283*^9, 3.496183557479501*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"obspkg\"\>"}], 
  RowBox[{
  ":", " "}], \
"\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"LinearAlgebra`Orthogonalization`\\\
\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is now \
obsolete. The legacy version being loaded may conflict with current \
Mathematica functionality. See the Compatibility Guide for updating \
information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:Compatibility/Tutorials/LinearAlgebra/\
Orthogonalization\\\", ButtonNote -> \\\"General::obspkg\\\"]\\)\"\>"}]], \
"Message", "MSG",
 CellChangeTimes->{3.400875452895872*^9, 3.410722595223091*^9, 
  3.4120615294878497`*^9, 3.4295467063820624`*^9, 3.4295467467801523`*^9, 
  3.430242864257496*^9, 3.4303613896360464`*^9, 3.4305054011309566`*^9, 
  3.444603993503315*^9, 3.4446046496267743`*^9, 3.477688308293256*^9, 
  3.4776908480051823`*^9, 3.4788063975666733`*^9, 3.4789982827839465`*^9, 
  3.479500145929082*^9, 3.479525388476082*^9, 3.480025633242237*^9, 
  3.496183499606283*^9, 3.4961835575195584`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"newpkg\"\>"}], 
  RowBox[{
  ":", " "}], \
"\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"DiscreteMath`Combinatorica`\\\"\\),\
 \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is now available as \
the \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"Combinatorica Package\\\"\
\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\". See the \
Compatibility Guide for updating information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:Compatibility/Tutorials/DiscreteMath/Combinatorica\\\",\
 ButtonNote -> \\\"General::newpkg\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.400875452895872*^9, 3.410722595223091*^9, 
  3.4120615294878497`*^9, 3.4295467063820624`*^9, 3.4295467467801523`*^9, 
  3.430242864257496*^9, 3.4303613896360464`*^9, 3.4305054011309566`*^9, 
  3.444603993503315*^9, 3.4446046496267743`*^9, 3.477688308293256*^9, 
  3.4776908480051823`*^9, 3.4788063975666733`*^9, 3.4789982827839465`*^9, 
  3.479500145929082*^9, 3.479525388476082*^9, 3.480025633242237*^9, 
  3.496183499606283*^9, 3.496183557559616*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"obspkg\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"Graphics`Graphics`\\\
\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is now \
obsolete. The legacy version being loaded may conflict with current \
Mathematica functionality. See the Compatibility Guide for updating \
information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:Compatibility/Tutorials/Graphics/Graphics\\\", \
ButtonNote -> \\\"General::obspkg\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.400875452895872*^9, 3.410722595223091*^9, 
  3.4120615294878497`*^9, 3.4295467063820624`*^9, 3.4295467467801523`*^9, 
  3.430242864257496*^9, 3.4303613896360464`*^9, 3.4305054011309566`*^9, 
  3.444603993503315*^9, 3.4446046496267743`*^9, 3.477688308293256*^9, 
  3.4776908480051823`*^9, 3.4788063975666733`*^9, 3.4789982827839465`*^9, 
  3.479500145929082*^9, 3.479525388476082*^9, 3.480025633242237*^9, 
  3.496183499606283*^9, 3.4961835583607683`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"obspkg\"\>"}], 
  RowBox[{
  ":", " "}], \
"\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"Graphics`ImplicitPlot`\\\"\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is now obsolete. The \
legacy version being loaded may conflict with current Mathematica \
functionality. See the Compatibility Guide for updating \
information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:Compatibility/Tutorials/Graphics/ImplicitPlot\\\", \
ButtonNote -> \\\"General::obspkg\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.400875452895872*^9, 3.410722595223091*^9, 
  3.4120615294878497`*^9, 3.4295467063820624`*^9, 3.4295467467801523`*^9, 
  3.430242864257496*^9, 3.4303613896360464`*^9, 3.4305054011309566`*^9, 
  3.444603993503315*^9, 3.4446046496267743`*^9, 3.477688308293256*^9, 
  3.4776908480051823`*^9, 3.4788063975666733`*^9, 3.4789982827839465`*^9, 
  3.479500145929082*^9, 3.479525388476082*^9, 3.480025633242237*^9, 
  3.496183499606283*^9, 3.49618355841084*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sinh", "=", 
     RowBox[{"Abs", "[", 
      RowBox[{"Sin", "[", "h", "]"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sinh", "=", 
     RowBox[{"Sin", "[", "h", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cosh", "=", 
     RowBox[{"Cos", "[", "h", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Minkowski", " ", "coords"}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"gcov", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"KS", " ", "coordinates", " ", "of", " ", "Kerr"}], "-", 
     RowBox[{"Newman", " ", "geometry"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nab", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"Inverse", "[", "nab", "]"}], ";"}], "\n"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"simplemetric", "=", "0"}], "\[IndentingNewLine]", 
 RowBox[{"metrictype", "=", "7"}], "\[IndentingNewLine]", 
 RowBox[{"coordtype", "=", "0"}]}], "Input",
 CellChangeTimes->{{3.400875185831853*^9, 3.4008751861923714`*^9}, {
  3.410722589584984*^9, 3.4107225897251854`*^9}, {3.412061525742464*^9, 
  3.4120615259327374`*^9}, {3.4180862336963696`*^9, 3.418086233726413*^9}, {
  3.428266392970338*^9, 3.4282663930905104`*^9}, {3.4295467444668255`*^9, 
  3.429546744607027*^9}, {3.4299913420654063`*^9, 3.429991342235651*^9}, {
  3.430505398487155*^9, 3.430505398577285*^9}, {3.444603988536173*^9, 
  3.4446039896077137`*^9}, {3.4776883051988063`*^9, 3.4776883054291377`*^9}, {
  3.4788063595319824`*^9, 3.4788063831158943`*^9}, {3.4961834827720766`*^9, 
  3.496183482912278*^9}, {3.496183553333539*^9, 3.4961835542849073`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.400875218709128*^9, 3.4008754565911856`*^9, 
  3.410722599148736*^9, 3.41206153356371*^9, 3.429546711569522*^9, 
  3.429546747310915*^9, 3.4302428695751424`*^9, 3.4303613915487967`*^9, 
  3.43050540732987*^9, 3.4446040020455985`*^9, 3.444604651189021*^9, 
  3.4776883124191885`*^9, 3.477690849467285*^9, 3.4788064052076607`*^9, 
  3.478998287801161*^9, 3.4795001566244607`*^9, 3.47952539400403*^9, 
  3.4800256420649233`*^9, 3.4961835056249375`*^9, 3.496183558611128*^9}],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.400875218709128*^9, 3.4008754565911856`*^9, 
  3.410722599148736*^9, 3.41206153356371*^9, 3.429546711569522*^9, 
  3.429546747310915*^9, 3.4302428695751424`*^9, 3.4303613915487967`*^9, 
  3.43050540732987*^9, 3.4446040020455985`*^9, 3.444604651189021*^9, 
  3.4776883124191885`*^9, 3.477690849467285*^9, 3.4788064052076607`*^9, 
  3.478998287801161*^9, 3.4795001566244607`*^9, 3.47952539400403*^9, 
  3.4800256420649233`*^9, 3.4961835056249375`*^9, 3.496183558631157*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.400875218709128*^9, 3.4008754565911856`*^9, 
  3.410722599148736*^9, 3.41206153356371*^9, 3.429546711569522*^9, 
  3.429546747310915*^9, 3.4302428695751424`*^9, 3.4303613915487967`*^9, 
  3.43050540732987*^9, 3.4446040020455985`*^9, 3.444604651189021*^9, 
  3.4776883124191885`*^9, 3.477690849467285*^9, 3.4788064052076607`*^9, 
  3.478998287801161*^9, 3.4795001566244607`*^9, 3.47952539400403*^9, 
  3.4800256420649233`*^9, 3.4961835056249375`*^9, 3.4961835586511855`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"q12", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", "^", "2"}], "-", "1"}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"z", "^", "2"}]}], "-", "2"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z", "^", "2"}], "-", "1"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"3", "/", "2"}], "*", "z", "*", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z", "+", "1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z", "-", "1"}], ")"}]}], "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"q22", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"3", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", "^", "2"}], "-", "1"}], ")"}], "*", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z", "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}]}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", "*", 
       RowBox[{"z", "^", "3"}]}], "-", 
      RowBox[{"5", "*", "z"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", "^", "2"}], "-", "1"}], ")"}]}]}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["z", "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["z", "2"]}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["z", "2"]}]], "-", 
    RowBox[{
     FractionBox["3", "2"], " ", "z", " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"1", "+", "z"}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", "z"}]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.4008754566412573`*^9, 3.4107225991988077`*^9, 
  3.4120615336237965`*^9, 3.429546711629608*^9, 3.4295467473710012`*^9, 
  3.430242869635229*^9, 3.430361391648941*^9, 3.4305054073899565`*^9, 
  3.4446040020956707`*^9, 3.444604651269136*^9, 3.477688312549376*^9, 
  3.477690849497328*^9, 3.4788064053979344`*^9, 3.47899828782119*^9, 
  3.479500156784691*^9, 3.479525394124203*^9, 3.4800256420949664`*^9, 
  3.496183505755125*^9, 3.4961835587112722`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "5"}], " ", "z"}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["z", "3"]}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["z", "2"]}]]}], "+", 
  RowBox[{
   FractionBox["3", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["z", "2"]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    FractionBox[
     RowBox[{"1", "+", "z"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "z"}]], "]"}]}]}]], "Output",
 CellChangeTimes->{3.4008754566412573`*^9, 3.4107225991988077`*^9, 
  3.4120615336237965`*^9, 3.429546711629608*^9, 3.4295467473710012`*^9, 
  3.430242869635229*^9, 3.430361391648941*^9, 3.4305054073899565`*^9, 
  3.4446040020956707`*^9, 3.444604651269136*^9, 3.477688312549376*^9, 
  3.477690849497328*^9, 3.4788064053979344`*^9, 3.47899828782119*^9, 
  3.479500156784691*^9, 3.479525394124203*^9, 3.4800256420949664`*^9, 
  3.496183505755125*^9, 3.496183558731301*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Q12", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Im", "[", 
     RowBox[{"ComplexExpand", "[", 
      RowBox[{
       StyleBox[
        RowBox[{"L", 
         StyleBox["egendreQ", "MR"]}]], 
       StyleBox["[", "MR"], 
       RowBox[{
        StyleBox["2", "MR"], 
        StyleBox[",", "MR"], " ", "1", 
        StyleBox[",", "MR"], " ", "z"}], 
       StyleBox["]", "MR"]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", "\[GreaterEqual]", "2"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Q22", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Re", "[", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{
        StyleBox[
         RowBox[{"L", 
          StyleBox["egendreQ", "MR"]}]], 
        StyleBox["[", "MR"], 
        RowBox[{
         StyleBox["2", "MR"], 
         StyleBox[",", "MR"], " ", "2", 
         StyleBox[",", "MR"], " ", "z"}], 
        StyleBox["]", "MR"]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"z", "\[GreaterEqual]", "2"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"P2", "=", 
  RowBox[{"LegendreP", "[", 
   RowBox[{"2", ",", "cosh"}], "]"}]}]}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "2"}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["z", "2"]}], "-", 
   RowBox[{"3", " ", "z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["z", "2"]}], ")"}], " ", 
    RowBox[{"ArcCoth", "[", "z", "]"}]}]}], 
  SqrtBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["z", "2"]}]]]], "Output",
 CellChangeTimes->{3.40087545985588*^9, 3.4107226020428977`*^9, 
  3.412061536287627*^9, 3.4295467142233377`*^9, 3.429546747431088*^9, 
  3.4302428750630336`*^9, 3.430361392109603*^9, 3.4305054079407487`*^9, 
  3.444604004048478*^9, 3.4446046518499713`*^9, 3.477688314251824*^9, 
  3.47769085004812*^9, 3.4788064086125565`*^9, 3.4789982923977704`*^9, 
  3.4795001594184785`*^9, 3.4795253956163487`*^9, 3.48002564763293*^9, 
  3.4961835065763054`*^9, 3.4961835589015455`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"5", " ", "z"}], "-", 
   RowBox[{"3", " ", 
    SuperscriptBox["z", "3"]}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["z", "2"]}], ")"}], "2"], " ", 
    RowBox[{"ArcCoth", "[", "z", "]"}]}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["z", "2"]}]]], "Output",
 CellChangeTimes->{3.40087545985588*^9, 3.4107226020428977`*^9, 
  3.412061536287627*^9, 3.4295467142233377`*^9, 3.429546747431088*^9, 
  3.4302428750630336`*^9, 3.430361392109603*^9, 3.4305054079407487`*^9, 
  3.444604004048478*^9, 3.4446046518499713`*^9, 3.477688314251824*^9, 
  3.47769085004812*^9, 3.4788064086125565`*^9, 3.4789982923977704`*^9, 
  3.4795001594184785`*^9, 3.4795253956163487`*^9, 3.48002564763293*^9, 
  3.4961835065763054`*^9, 3.4961835589215746`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "h", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.40087545985588*^9, 3.4107226020428977`*^9, 
  3.412061536287627*^9, 3.4295467142233377`*^9, 3.429546747431088*^9, 
  3.4302428750630336`*^9, 3.430361392109603*^9, 3.4305054079407487`*^9, 
  3.444604004048478*^9, 3.4446046518499713`*^9, 3.477688314251824*^9, 
  3.47769085004812*^9, 3.4788064086125565`*^9, 3.4789982923977704`*^9, 
  3.4795001594184785`*^9, 3.4795253956163487`*^9, 3.48002564763293*^9, 
  3.4961835065763054`*^9, 3.4961835589215746`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OO", "=", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"2", "*", 
      RowBox[{"M", "/", "r"}]}], "+", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"J", "^", "2"}], "/", 
       RowBox[{"r", "^", "4"}]}]}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR", "=", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"J", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"M", "*", 
            RowBox[{"r", "^", "3"}]}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"M", "/", "r"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"5", "/", "8"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Q", "-", 
            RowBox[{
             RowBox[{"J", "^", "2"}], "/", "M"}]}], ")"}], "/", 
          RowBox[{"M", "^", "3"}]}], "*", "Q22"}]}], ")"}], "*", "P2"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "/", "M"}], "-", "1"}], ")"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"J", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"M", "*", 
            RowBox[{"r", "^", "3"}]}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"5", "*", 
            RowBox[{"M", "/", "r"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"5", "/", "8"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Q", "-", 
            RowBox[{
             RowBox[{"J", "^", "2"}], "/", "M"}]}], ")"}], "/", 
          RowBox[{"M", "^", "3"}]}], "*", "Q22"}]}], ")"}], "*", "P2"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "/", "M"}], "-", "1"}], ")"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"J", "^", "2"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"M", "*", 
            RowBox[{"r", "^", "3"}]}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", "*", 
            RowBox[{"M", "/", "r"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"5", "/", "8"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Q", "-", 
            RowBox[{
             RowBox[{"J", "^", "2"}], "/", "M"}]}], ")"}], "/", 
          RowBox[{"M", "^", "3"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"M", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"r", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", "*", 
                  RowBox[{"M", "/", "r"}]}]}], ")"}]}], "]"}]}], "*", "Q12"}],
            "-", "Q22"}], ")"}]}]}], ")"}], "*", "P2"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "/", "M"}], "-", "1"}], ")"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "below", " ", "causes", " ", "mathematica", " ", "to", " ", "take", " ", 
   "a", " ", "long", " ", "time", " ", "compared", " ", "to", " ", "next", 
   " ", "form"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Jgen", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"J0", "+", 
       RowBox[{"Jvsr", "[", "r", "]"}]}], "\[IndentingNewLine]", "Mgen"}], 
     "=", 
     RowBox[{
      RowBox[{"M0", "+", 
       RowBox[{"Mvsr", "[", "r", "]"}]}], "\[IndentingNewLine]", 
      RowBox[{"agen", "=", 
       RowBox[{"Jgen", "/", "Mgen"}]}], "\[IndentingNewLine]", 
      RowBox[{"deltainterior", "=", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "-", 
        RowBox[{"2", "*", "Mgen", "*", "r"}], "+", 
        RowBox[{"agen", "^", "2"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"sigmainterior", "=", 
    RowBox[{
     RowBox[{"r", "^", "2"}], "+", 
     RowBox[{
      RowBox[{"agen", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"Ainterior", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "+", 
        RowBox[{"agen", "^", "2"}]}], ")"}], "^", "2"}], "-", 
     RowBox[{"deltainterior", "*", 
      RowBox[{"agen", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Jgen", "=", 
  RowBox[{"Jvsr", "[", "r", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mgen", "=", 
  RowBox[{"Mvsr", "[", "r", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"agen", "=", 
  RowBox[{"Jgen", "/", "Mgen"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltainterior", "=", 
   RowBox[{
    RowBox[{"r", "^", "2"}], "-", 
    RowBox[{"2", "*", "Mgen", "*", "r"}], "+", 
    RowBox[{"agen", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigmainterior", "=", 
   RowBox[{
    RowBox[{"r", "^", "2"}], "+", 
    RowBox[{
     RowBox[{"agen", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ainterior", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "+", 
       RowBox[{"agen", "^", "2"}]}], ")"}], "^", "2"}], "-", 
    RowBox[{"deltainterior", "*", 
     RowBox[{"agen", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"Sin", "[", "h", "]"}], "^", "2"}]}]}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"Jvsr", "[", "r", "]"}]], "Output",
 CellChangeTimes->{3.400875460246442*^9, 3.4107226024534883`*^9, 
  3.4120615368684626`*^9, 3.4295467147941585`*^9, 3.429546747531232*^9, 
  3.430242875703955*^9, 3.43036139232992*^9, 3.4305054084614973`*^9, 
  3.444604004609285*^9, 3.4446046523306627`*^9, 3.4776883147325153`*^9, 
  3.477690850779171*^9, 3.4788064104652205`*^9, 3.4789982928684473`*^9, 
  3.479500160069414*^9, 3.4795253961370974`*^9, 3.4800256479834337`*^9, 
  3.4961835071170835`*^9, 3.4961835589516177`*^9}],

Cell[BoxData[
 RowBox[{"Mvsr", "[", "r", "]"}]], "Output",
 CellChangeTimes->{3.400875460246442*^9, 3.4107226024534883`*^9, 
  3.4120615368684626`*^9, 3.4295467147941585`*^9, 3.429546747531232*^9, 
  3.430242875703955*^9, 3.43036139232992*^9, 3.4305054084614973`*^9, 
  3.444604004609285*^9, 3.4446046523306627`*^9, 3.4776883147325153`*^9, 
  3.477690850779171*^9, 3.4788064104652205`*^9, 3.4789982928684473`*^9, 
  3.479500160069414*^9, 3.4795253961370974`*^9, 3.4800256479834337`*^9, 
  3.4961835071170835`*^9, 3.4961835589516177`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"Jvsr", "[", "r", "]"}], 
  RowBox[{"Mvsr", "[", "r", "]"}]]], "Output",
 CellChangeTimes->{3.400875460246442*^9, 3.4107226024534883`*^9, 
  3.4120615368684626`*^9, 3.4295467147941585`*^9, 3.429546747531232*^9, 
  3.430242875703955*^9, 3.43036139232992*^9, 3.4305054084614973`*^9, 
  3.444604004609285*^9, 3.4446046523306627`*^9, 3.4776883147325153`*^9, 
  3.477690850779171*^9, 3.4788064104652205`*^9, 3.4789982928684473`*^9, 
  3.479500160069414*^9, 3.4795253961370974`*^9, 3.4800256479834337`*^9, 
  3.4961835071170835`*^9, 3.496183558961632*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"simplemetric", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"delta", "=", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "-", 
       RowBox[{"2", "*", "M", "*", "r"}], "+", 
       RowBox[{"a", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sigma", "=", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "+", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "+", 
          RowBox[{"a", "^", "2"}]}], ")"}], "^", "2"}], "-", 
       RowBox[{"delta", "*", 
        RowBox[{"a", "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", "h", "]"}], "^", "2"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rp", "=", 
      RowBox[{"M", "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"M", "^", "2"}], "-", 
         RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]",
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"simplemetric", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{"delta", ",", "sigma", ",", "A", ",", "rp"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nummetrics", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ds2mink", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"dt", "^", "2"}]}], "+", 
     RowBox[{"dr", "^", "2"}], "+", 
     RowBox[{"dh", "^", "2"}], "+", 
     RowBox[{"dphi", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pot", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
    RowBox[{"C", "*", "y"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pot", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"C", "*", "y", "\[IndentingNewLine]", 
      RowBox[{"ds2mink", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", "*", 
             RowBox[{"pot", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], "*", 
         RowBox[{"dt", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "*", 
            RowBox[{"pot", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], "*", 
         RowBox[{"dr", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "*", 
            RowBox[{"pot", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], "*", 
         RowBox[{"dh", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "*", 
            RowBox[{"pot", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], "*", 
         RowBox[{"dphi", "^", "2"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ds2mink", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", "*", 
           RowBox[{"pot", "[", "r", "]"}]}]}], ")"}]}], "*", 
       RowBox[{"dt", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "*", 
          RowBox[{"pot", "[", "r", "]"}]}]}], ")"}], "*", 
       RowBox[{"dr", "^", "2"}]}], "+", 
      RowBox[{"dh", "^", "2"}], "+", 
      RowBox[{"dphi", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds2swart", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "*", 
         RowBox[{"M", "/", "r"}]}]}], ")"}]}], "*", 
     RowBox[{"dt", "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "*", 
         RowBox[{"M", "/", "r"}]}]}], ")"}]}], "*", 
     RowBox[{"dr", "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"r", "^", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dh", "^", "2"}], "+", 
       RowBox[{
        RowBox[{"sinh", "^", "2"}], "*", 
        RowBox[{"dphi", "^", "2"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds2ks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "*", "M", "*", 
         RowBox[{"r", "/", "sigma"}]}]}], ")"}]}], "*", 
     RowBox[{"dt", "^", "2"}]}], "-", 
    RowBox[{"4", "*", "M", "*", "a", "*", 
     RowBox[{"r", "/", "sigma"}], "*", 
     RowBox[{"sinh", "^", "2"}], "*", "dt", "*", "dphi"}], "+", 
    RowBox[{"4", "*", "M", "*", 
     RowBox[{"r", "/", "sigma"}], "*", "dt", "*", "dr"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", "*", "M", "*", 
        RowBox[{"r", "/", "sigma"}]}]}], ")"}], "*", 
     RowBox[{"dr", "^", "2"}]}], "-", 
    RowBox[{"2", "*", "a", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", "*", "M", "*", 
        RowBox[{"r", "/", "sigma"}]}]}], ")"}], "*", 
     RowBox[{"sinh", "^", "2"}], "*", "dr", "*", "dphi"}], "+", 
    RowBox[{"sigma", "*", 
     RowBox[{"dh", "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"sinh", "^", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{"sigma", "+", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", "*", "M", "*", 
           RowBox[{"r", "/", "sigma"}]}]}], ")"}], "*", 
        RowBox[{"sinh", "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds2gen", "=", 
   RowBox[{
    RowBox[{"gcov11", "*", 
     RowBox[{"dt", "^", "2"}]}], "+", 
    RowBox[{"gcov22", "*", 
     RowBox[{"dr", "^", "2"}]}], "+", 
    RowBox[{"gcov33", "*", 
     RowBox[{"dh", "^", "2"}]}], "+", 
    RowBox[{"gcov44", "*", 
     RowBox[{"dphi", "^", "2"}]}], "+", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"gcov12", "*", "dt", "*", "dr"}], "+", 
       RowBox[{"gcov13", "*", "dt", "*", "dh"}], "+", 
       RowBox[{"gcov14", "*", "dt", "*", "dphi"}], "+", 
       RowBox[{"gcov23", "*", "dr", "*", "dh"}], "+", 
       RowBox[{"gcov24", "*", "dr", "*", "dphi"}], "+", 
       RowBox[{"gcov34", "*", "dh", "*", "dphi"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds2semigen", "=", 
   RowBox[{
    RowBox[{"gcov11", "*", 
     RowBox[{"dt", "^", "2"}]}], "+", 
    RowBox[{"gcov22", "*", 
     RowBox[{"dr", "^", "2"}]}], "+", 
    RowBox[{"gcov33", "*", 
     RowBox[{"dh", "^", "2"}]}], "+", 
    RowBox[{"gcov44", "*", 
     RowBox[{"dphi", "^", "2"}]}], "+", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{"gcov14", "*", "dt", "*", "dphi"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds2bl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", "*", "M", "*", 
        RowBox[{"r", "/", "sigma"}]}]}], ")"}], "*", 
     RowBox[{"dt", "^", "2"}]}], "-", 
    RowBox[{"4", "*", "M", "*", "a", "*", "r", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "/", "sigma"}], "*", "dt", 
     "*", "dphi"}], "+", 
    RowBox[{
     RowBox[{"sigma", "/", "delta"}], "*", 
     RowBox[{"dr", "^", "2"}]}], "+", 
    RowBox[{"sigma", "*", 
     RowBox[{"dh", "^", "2"}]}], "+", 
    RowBox[{"A", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "/", "sigma"}], "*", 
     RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ds2blinterior", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"Mvsr", "[", "r", "]"}], "*", 
         RowBox[{"r", "/", "sigmainterior"}]}]}], ")"}], "*", 
      RowBox[{"dt", "^", "2"}]}], "-", 
     RowBox[{"4", "*", 
      RowBox[{"Mvsr", "[", "r", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Jvsr", "[", "r", "]"}], "/", 
        RowBox[{"Mvsr", "[", "r", "]"}]}], ")"}], "*", "r", "*", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "/", "sigmainterior"}], 
      "*", "dt", "*", "dphi"}], "+", 
     RowBox[{
      RowBox[{"sigmainterior", "/", "deltainterior"}], "*", 
      RowBox[{"dr", "^", "2"}]}], "+", 
     RowBox[{"sigmainterior", "*", 
      RowBox[{"dh", "^", "2"}]}], "+", 
     RowBox[{"Ainterior", "*", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "/", "sigmainterior"}], 
      "*", 
      RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"below", " ", "interior", " ", "follows", " ", "j"}], "=", 
    RowBox[{"0", " ", "interior", " ", "form", " ", 
     RowBox[{"(", "TOV", ")"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds2blinterior", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", 
           RowBox[{"2", "*", "M", "*", 
            RowBox[{"r", "/", "sigma"}]}]}], "]"}], "+", 
         RowBox[{"2", "*", 
          RowBox[{"phivsr", "[", "r", "]"}]}]}], "]"}]}], ")"}], "*", 
     RowBox[{"dt", "^", "2"}]}], "-", 
    RowBox[{"4", "*", 
     RowBox[{"Mvsr", "[", "r", "]"}], "*", "agen", "*", "r", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "/", "sigmainterior"}], 
     "*", "dt", "*", "dphi"}], "+", 
    RowBox[{
     RowBox[{"sigmainterior", "/", "deltainterior"}], "*", 
     RowBox[{"dr", "^", "2"}]}], "+", 
    RowBox[{"sigmainterior", "*", 
     RowBox[{"dh", "^", "2"}]}], "+", 
    RowBox[{"Ainterior", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "/", "sigmainterior"}], 
     "*", 
     RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ds2minkspc", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"dt", "^", "2"}]}], "+", 
     RowBox[{"dr", "^", "2"}], "+", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "*", 
      RowBox[{"dh", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "*", 
      RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"time", "-", 
    RowBox[{
    "dep", " ", "tov", " ", "with", " ", "polar", " ", "compression"}]}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ds2tov", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"phivsr", "[", 
          RowBox[{"t", ",", "r"}], "]"}]}], "]"}]}], "*", 
      RowBox[{"dt", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"Mvsr", "[", 
            RowBox[{"t", ",", "r"}], "]"}], "/", "r"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "*", 
      RowBox[{"dr", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"apolar", "[", "t", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], "*", 
         RowBox[{"dh", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "*", 
         RowBox[{"dphi", "^", "2"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"perturbed", "-", 
    RowBox[{"type", " ", "non"}], "-", "tov"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ds2tov", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"phivsr", "[", "r", "]"}]}]}], ")"}], "*", 
      RowBox[{"dt", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "*", 
         RowBox[{"phivsr", "[", "r", "]"}]}]}], ")"}], "*", 
      RowBox[{"dr", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "*", 
      RowBox[{"dh", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "*", 
      RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"static", " ", "tov"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ds2tov", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "*", 
          RowBox[{"phivsr", "[", "r", "]"}]}], "]"}]}], "*", 
       RowBox[{"dt", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"Mvsr", "[", "r", "]"}], "/", "r"}]}], "+", 
          RowBox[{"vrsq", "[", "r", "]"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}]}], "*", 
       RowBox[{"dr", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "*", 
       RowBox[{"dh", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "*", 
       RowBox[{
        RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "*", 
       RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ds2tov", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "*", 
         RowBox[{"phivsr", "[", "r", "]"}]}], "]"}]}], "*", 
      RowBox[{"dt", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"Mvsr", "[", "r", "]"}], "/", "r"}]}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "*", 
      RowBox[{"dr", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "*", 
      RowBox[{"dh", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"r", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "*", 
      RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"tov", " ", "with", " ", "rapid", " ", "rotation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ds2tov", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "*", 
          RowBox[{"phivsr", "[", "r", "]"}]}], "]"}]}], "*", 
       RowBox[{"dt", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"Mvsr", "[", "r", "]"}], "/", "r"}]}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}]}], "*", 
       RowBox[{"dr", "^", "2"}]}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], "*", 
         RowBox[{"dh", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "*", 
         RowBox[{"dphi", "^", "2"}]}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"gtphi", "[", "r", "]"}], "*", "dt", "*", "dphi"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"time", "-", 
    RowBox[{
    "dep", " ", "tov", " ", "with", " ", "NO", " ", "polar", " ", 
     "compression"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ds2tov", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "*", 
          RowBox[{"phivsr", "[", 
           RowBox[{"t", ",", "r"}], "]"}]}], "]"}]}], "*", 
       RowBox[{"dt", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"Mvsr", "[", 
             RowBox[{"t", ",", "r"}], "]"}], "/", "r"}]}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}]}], "*", 
       RowBox[{"dr", "^", "2"}]}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], "*", 
         RowBox[{"dh", "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"Sin", "[", "h", "]"}], "^", "2"}], "*", 
         RowBox[{"dphi", "^", "2"}]}]}], ")"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CYL", " ", "REALLY"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ds2minkspc", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"dt", "^", "2"}]}], "+", 
      RowBox[{"dr", "^", "2"}], "+", 
      RowBox[{"dh", "^", "2"}], "+", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "*", 
       RowBox[{"dphi", "^", "2"}]}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds2ht", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "OO"}], "*", "RR", "*", 
     RowBox[{"dt", "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"SS", "/", "OO"}], "*", 
     RowBox[{"dr", "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"r", "^", "2"}], "*", "AA", "*", 
     RowBox[{"dh", "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"r", "^", "2"}], "*", "AA", "*", 
     RowBox[{"sinh", "^", "2"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dphi", "-", 
        RowBox[{"2", "*", 
         RowBox[{"J", "/", 
          RowBox[{"r", "^", "3"}]}], "*", "dt"}]}], ")"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gconsts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gcov12", "->", "gcov21"}], ",", 
     RowBox[{"gcov13", "->", "gcov31"}], ",", 
     RowBox[{"gcov14", "->", "gcov41"}], ",", 
     RowBox[{"gcov23", "->", "gcov32"}], ",", 
     RowBox[{"gcov24", "->", "gcov42"}], ",", 
     RowBox[{"gcov34", "->", "gcov43"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bl2ks", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"2", "*", "M", "*", 
        RowBox[{"x", "/", "delta"}]}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"a", "/", "delta"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ks2bl", "=", 
   RowBox[{"Inverse", "[", "bl2ks", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4446046119025297`*^9, 3.4446046276752095`*^9}, {
  3.4788064712926865`*^9, 3.4788064736861277`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"metrictype", "\[Equal]", 
   RowBox[{
   "1", " ", "reserved", " ", "for", " ", "current", " ", "active", " ", 
    "metric"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2mink"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2swart"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2ks"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "5"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2gen"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "6"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2bl"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "7"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2minkspc"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "8"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2semigen"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "9"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2ht"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "10"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2tov"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"metrictype", "\[Equal]", "11"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds2", "=", "ds2blinterior"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds2list", "=", 
   RowBox[{"{", 
    RowBox[{
    "ds2", ",", "ds2mink", ",", "ds2swart", ",", "ds2ks", ",", "ds2gen", ",", 
     "ds2bl", ",", "ds2minkspc", ",", "ds2semigen", ",", "ds2ht"}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Coordinate", " ", "transformation", " ", "for", " ", "metric"}], 
  "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Xp", "=", 
  RowBox[{"{", 
   RowBox[{"t", ",", "x", ",", "y", ",", "z"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"X0", "=", 
  RowBox[{"{", 
   RowBox[{"t", ",", "r", ",", "h", ",", "p"}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.400875460336571*^9, 3.4107226025436172`*^9, 
  3.412061536948578*^9, 3.4295467149143314`*^9, 3.4295467476213617`*^9, 
  3.430242875894229*^9, 3.4303613924400787`*^9, 3.4305054085416126`*^9, 
  3.4446040046994143`*^9, 3.444604652430806*^9, 3.477688314932803*^9, 
  3.4776908508392577`*^9, 3.478806410775667*^9, 3.478998292968591*^9, 
  3.47950016039989*^9, 3.4795253962172127`*^9, 3.480025648073563*^9, 
  3.4961835073173714`*^9, 3.496183559011704*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "r", ",", "h", ",", "p"}], "}"}]], "Output",
 CellChangeTimes->{3.400875460336571*^9, 3.4107226025436172`*^9, 
  3.412061536948578*^9, 3.4295467149143314`*^9, 3.4295467476213617`*^9, 
  3.430242875894229*^9, 3.4303613924400787`*^9, 3.4305054085416126`*^9, 
  3.4446040046994143`*^9, 3.444604652430806*^9, 3.477688314932803*^9, 
  3.4776908508392577`*^9, 3.478806410775667*^9, 3.478998292968591*^9, 
  3.47950016039989*^9, 3.4795253962172127`*^9, 3.480025648073563*^9, 
  3.4961835073173714`*^9, 3.496183559011704*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coordtype", "\[Equal]", "2"}], ",", 
   RowBox[{"(*", " ", 
    RowBox[{"KSprim", " ", "jon"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", 
      RowBox[{"Rin", "*", 
       RowBox[{"Exp", "[", "x", "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "49."}], "*", "hslope"}], "+", 
            RowBox[{"60.", "*", "Pi"}]}], ")"}], "*", "y"}], ")"}], "/", 
        "12."}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"247.", "*", "hslope"}], "-", 
            RowBox[{"240.", "*", "Pi"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"y", "^", "2"}], ")"}]}], ")"}], "/", "12."}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "83."}], "*", "hslope"}], "+", 
            RowBox[{"80.", "*", "Pi"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"y", "^", "3"}], ")"}]}], ")"}], "/", "2."}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"5.", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "25."}], "*", "hslope"}], "+", 
            RowBox[{"24.", "*", "Pi"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"y", "^", "4"}], ")"}]}], ")"}], "/", "3."}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2.", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "25."}], "*", "hslope"}], "+", 
            RowBox[{"24.", "*", "Pi"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"y", "^", "5"}], ")"}]}], ")"}], "/", "3."}]}], ",", "z"}],
      "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coordtype", "\[Equal]", "1"}], ",", 
   RowBox[{"(*", "KSprim", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", 
      RowBox[{"R0", "+", 
       RowBox[{"Exp", "[", "x", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Pi", "*", "y"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "hslope"}], ")"}], "/", "2"}], ")"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "*", "Pi", "*", "y"}], "]"}]}]}], ",", "z"}], "}"}]}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coordtype", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "KS", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coordtype", "\[Equal]", "3"}], ",", 
   RowBox[{"(*", 
    RowBox[{"general", " ", "prime"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", 
      RowBox[{"XX", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"YY", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "z"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coordtype", "\[Equal]", "4"}], ",", 
   RowBox[{"(*", 
    RowBox[{"general", " ", "prime"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", 
      RowBox[{"x", "+", 
       RowBox[{"AAA", "*", 
        RowBox[{"Cos", "[", "x", "]"}]}]}], ",", 
      RowBox[{"y", "+", 
       RowBox[{"AAA", "*", 
        RowBox[{"Cos", "[", "y", "]"}]}]}], ",", "z"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"coordtype", "\[Equal]", "5"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"CYL", " ", "exp"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"X", "=", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rout", "-", "Rin"}], ")"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"npow", "*", "x"}], "]"}]}], "+", 
          RowBox[{"Rin", "*", 
           RowBox[{"Exp", "[", "npow", "]"}]}], "-", "Rout"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", "npow", "]"}], "-", "1"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Zout", "-", "Zineq"}], ")"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"npow", "*", "y"}], "]"}]}], "+", 
          RowBox[{"Zineq", "*", 
           RowBox[{"Exp", "[", "npow", "]"}]}], "-", "Zin"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", "npow", "]"}], "-", "1"}], ")"}]}], ",", "z"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.4008754603666143`*^9, 3.4107226025836754`*^9, 
  3.4120615369786205`*^9, 3.4295467149543886`*^9, 3.429546747661419*^9, 
  3.4302428759743443`*^9, 3.430361392480136*^9, 3.430505408571656*^9, 
  3.444604004729458*^9, 3.44460465246085*^9, 3.477688314982875*^9, 
  3.4776908508592863`*^9, 3.4788064110760994`*^9, 3.47899829298862*^9, 
  3.4795001604499617`*^9, 3.4795253962372417`*^9, 3.480025648103606*^9, 
  3.4961835073774576`*^9, 3.4961835590217185`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dXdXp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"Xp", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "\n", 
 RowBox[{"MatrixForm", "[", "dXdXp", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.400875460376629*^9, 3.4107226026137185`*^9, 
  3.412061537058736*^9, 3.429546714984432*^9, 3.4295467476914625`*^9, 
  3.430242876555179*^9, 3.4303613925502367`*^9, 3.4305054086918287`*^9, 
  3.444604004769515*^9, 3.444604652490893*^9, 3.4776883150429616`*^9, 
  3.477690850869301*^9, 3.4788064112363296`*^9, 3.478998293068735*^9, 
  3.479500160570134*^9, 3.4795253962472563`*^9, 3.480025648143664*^9, 
  3.4961835074275293`*^9, 3.4961835590317326`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.400875460376629*^9, 3.4107226026137185`*^9, 
  3.412061537058736*^9, 3.429546714984432*^9, 3.4295467476914625`*^9, 
  3.430242876555179*^9, 3.4303613925502367`*^9, 3.4305054086918287`*^9, 
  3.444604004769515*^9, 3.444604652490893*^9, 3.4776883150429616`*^9, 
  3.477690850869301*^9, 3.4788064112363296`*^9, 3.478998293068735*^9, 
  3.479500160570134*^9, 3.4795253962472563`*^9, 3.480025648143664*^9, 
  3.4961835074275293`*^9, 3.4961835590317326`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bl2kspconsts", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r", "\[Rule]", 
     RowBox[{"X", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"h", "\[Rule]", 
     RowBox[{"X", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"X", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r", "\[Rule]", "x"}], ",", 
   RowBox[{"h", "\[Rule]", "y"}], ",", 
   RowBox[{"p", "\[Rule]", "z"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4008754605168304`*^9, 3.4107226027439055`*^9, 
  3.4120615373691826`*^9, 3.429546715124634*^9, 3.4295467477315197`*^9, 
  3.430242876895669*^9, 3.4303613926704097`*^9, 3.430505408771944*^9, 
  3.444604004859645*^9, 3.444604652520936*^9, 3.4776883151431055`*^9, 
  3.477690850899344*^9, 3.4788064117771072`*^9, 3.478998293158865*^9, 
  3.4795001607003217`*^9, 3.4795253962873135`*^9, 3.4800256482738514`*^9, 
  3.4961835075477023`*^9, 3.496183559041747*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metricconsts", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"delta", "->", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "-", 
       RowBox[{"2", "*", "M", "*", "r"}], "+", 
       RowBox[{"a", "^", "2"}]}]}], ",", 
     RowBox[{"sigma", "->", 
      RowBox[{
       RowBox[{"r", "^", "2"}], "+", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}]}], ",", 
     RowBox[{"A", "->", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "+", 
          RowBox[{"a", "^", "2"}]}], ")"}], "^", "2"}], "-", 
       RowBox[{"delta", "*", 
        RowBox[{"a", "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", "h", "]"}], "^", "2"}]}]}]}], ",", 
     RowBox[{"rp", "->", 
      RowBox[{"M", "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"M", "^", "2"}], "-", 
         RowBox[{"a", "^", "2"}]}], "]"}]}]}]}], "}"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "\[Rule]", 
      RowBox[{"X", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"h", "\[Rule]", 
      RowBox[{"X", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", 
     RowBox[{"p", "\[Rule]", 
      RowBox[{"X", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["a", "2"], "-", 
     RowBox[{"2", " ", "M", " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["a", "2"], "-", 
     RowBox[{"2", " ", "M", " ", "x"}], "+", 
     SuperscriptBox["x", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "y", "]"}], "2"]}]}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "y", "]"}], "2"]}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["x", "2"]}], ")"}], "2"], "-", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "-", 
        RowBox[{"2", " ", "M", " ", "x"}], "+", 
        SuperscriptBox["x", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "y", "]"}], "2"]}]}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["x", "2"]}], ")"}], "2"], "-", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "-", 
        RowBox[{"2", " ", "M", " ", "x"}], "+", 
        SuperscriptBox["x", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "y", "]"}], "2"]}]}]}], ",", 
   RowBox[{
    RowBox[{"M", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["a", "2"]}], "+", 
       SuperscriptBox["M", "2"]}]]}], "\[Rule]", 
    RowBox[{"M", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["a", "2"]}], "+", 
       SuperscriptBox["M", "2"]}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.4008754605368595`*^9, 3.4107226027739487`*^9, 
  3.4120615373992257`*^9, 3.429546715154677*^9, 3.4295467477615633`*^9, 
  3.430242876935726*^9, 3.4303613927104673`*^9, 3.430505408801987*^9, 
  3.444604004889688*^9, 3.444604652540965*^9, 3.4776883152031918`*^9, 
  3.4776908509093585`*^9, 3.478806411917309*^9, 3.4789982931788936`*^9, 
  3.479500160730365*^9, 3.479525396297328*^9, 3.480025648283866*^9, 
  3.4961835075977745`*^9, 3.4961835590517616`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"solve", " ", "for", " ", 
   RowBox[{"inner", "/", "outer"}], " ", "edges", " ", "for", " ", 
   "simplification", " ", "procedures"}], " ", "*)"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"simplemetric", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"consts", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Rin", "\[Rule]", "0"}], ",", 
        RowBox[{"Rout", "\[Rule]", 
         RowBox[{"10", "^", "30"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eq1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "Rin"}], ")"}], "//.", 
       "consts"}]}], ";", "\n", 
     RowBox[{"Xin", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{"eq1", ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"eq2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "Rout"}], ")"}], "//.", 
       "consts"}]}], ";", "\n", 
     RowBox[{"Xout", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{"eq2", ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"eq3", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ")"}], "//.", 
       "consts"}]}], ";", "\n", 
     RowBox[{"Yin", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FindRoot", "[", 
         RowBox[{"eq3", ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"eq4", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "Pi"}], ")"}], "//.", 
       "consts"}]}], ";", "\n", 
     RowBox[{"Yout", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FindRoot", "[", 
         RowBox[{"eq4", ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "1"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"eq5", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
         RowBox[{"Pi", "/", "2"}]}], ")"}], "//.", "consts"}]}], ";", "\n", 
     RowBox[{"Ymid", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FindRoot", "[", 
         RowBox[{"eq5", ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0.5"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"conditions", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "\[GreaterEqual]", "Xin"}], ",", 
        RowBox[{"Yin", "\[LessEqual]", "y", "\[LessEqual]", "Yout"}], ",", 
        RowBox[{"M", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"a", ">=", "0"}], ",", 
        RowBox[{"1", "<=", "hslope", ">=", "0"}], ",", 
        RowBox[{"Rin", ">", "0"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"simplemetric", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"conditions", "=", 
      RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"avoid", " ", "HT", " ", "here"}], " ", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"ds2i", "=", "1"}], ",", 
   RowBox[{"ds2i", "\[LessEqual]", "2"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ds22", "[", "y_", "]"}], ":=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ds2list", "[", 
        RowBox[{"[", "ds2i", "]"}], "]"}], ",", "y"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"gcov0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ds22", "[", 
          RowBox[{"dt", "*", "dt"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dt", "*", "dr"}], "]"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dt", "*", "dh"}], "]"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dt", "*", "dphi"}], "]"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dr", "*", "dt"}], "]"}], "/", "2"}], ",", 
         RowBox[{"ds22", "[", 
          RowBox[{"dr", "*", "dr"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dr", "*", "dh"}], "]"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dr", "*", "dphi"}], "]"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dh", "*", "dt"}], "]"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dh", "*", "dr"}], "]"}], "/", "2"}], ",", 
         RowBox[{"ds22", "[", 
          RowBox[{"dh", "*", "dh"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dh", "*", "dphi"}], "]"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dphi", "*", "dt"}], "]"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dphi", "*", "dr"}], "]"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"ds22", "[", 
           RowBox[{"dphi", "*", "dh"}], "]"}], "/", "2"}], ",", 
         RowBox[{"ds22", "[", 
          RowBox[{"dphi", "*", "dphi"}], "]"}]}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"gcov0", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gcov0", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
          RowBox[{"dXdXp", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "ip"}], "]"}], "]"}], "*", 
          RowBox[{"dXdXp", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "jp"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ip", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"jp", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"gcov0", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"gcov0", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "\[Rule]", 
           RowBox[{"X", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"r", "\[Rule]", 
           RowBox[{"X", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"h", "\[Rule]", 
           RowBox[{"X", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"phi", "\[Rule]", 
           RowBox[{"X", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ",", "conditions"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", "gcov0", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"gcon0", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Inverse", "[", "gcov0", "]"}], ",", "conditions"}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"gdetreal0", "=", 
     RowBox[{"Det", "[", "gcov0", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gdet0", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"-", "gdetreal0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hslope", ">", "0"}], ",", 
         RowBox[{"a", ">", "0"}], ",", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"M", ">", "0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "<", "Pi"}]}]}], "}"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"g0", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"-", 
       RowBox[{"Det", "[", "gcov0", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "1"}], ",", " ", 
      RowBox[{
       RowBox[{"gcov", "=", "gcov0"}], ";", 
       RowBox[{"gcon", "=", "gcon0"}], ";", 
       RowBox[{"gdetreal", "=", "gdetreal0"}], ";", 
       RowBox[{"gdet", "=", "gdet0"}], ";", 
       RowBox[{"g", "=", "g0"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "2"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovmink", "=", "gcov0"}], ";", 
       RowBox[{"gconmink", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealmink", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetmink", "=", "gdet0"}], ";", 
       RowBox[{"gmink", "=", "g0"}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "3"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovswart", "=", "gcov0"}], ";", 
       RowBox[{"gconswart", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealswart", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetswart", "=", "gdet0"}], ";", 
       RowBox[{"gswart", "=", "g0"}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "4"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovks", "=", "gcov0"}], ";", 
       RowBox[{"gconks", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealks", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetks", "=", "gdet0"}], ";", 
       RowBox[{"gks", "=", "g0"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "5"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovgen", "=", "gcov0"}], ";", 
       RowBox[{"gcongen", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealgen", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetgen", "=", "gdet0"}], ";", 
       RowBox[{"ggen", "=", "g0"}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "6"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovbl", "=", "gcov0"}], ";", 
       RowBox[{"gconbl", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealbl", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetbl", "=", "gdet0"}], ";", 
       RowBox[{"gbl", "=", "g0"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "7"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovspc", "=", "gcov0"}], ";", 
       RowBox[{"gconspc", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealspc", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetspc", "=", "gdet0"}], ";", 
       RowBox[{"gspc", "=", "g0"}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "8"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovsemigen", "=", "gcov0"}], ";", 
       RowBox[{"gconsemigen", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealsemigen", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetsemigen", "=", "gdet0"}], ";", 
       RowBox[{"gsemigen", "=", "g0"}], ";"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ds2i", "\[Equal]", "9"}], ",", " ", 
      RowBox[{
       RowBox[{"gcovht", "=", "gcov0"}], ";", 
       RowBox[{"gconht", "=", "gcon0"}], ";", 
       RowBox[{"gdetrealht", "=", "gdetreal0"}], ";", 
       RowBox[{"gdetht", "=", "gdet0"}], ";", 
       RowBox[{"ght", "=", "g0"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "ds2i", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ds2i", "++"}]}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.4008754609474497`*^9, 3.4107226041459217`*^9, 
  3.4120615381503057`*^9, 3.4295467166468225`*^9, 3.4295467488631473`*^9, 
  3.430242880550925*^9, 3.430361393912195*^9, 3.4305054101339025`*^9, 
  3.4446040052802496`*^9, 3.4446046526811666`*^9, 3.477688316284747*^9, 
  3.4776908517906256`*^9, 3.4788064134695406`*^9, 3.4789982939099445`*^9, 
  3.4795001616717186`*^9, 3.4795253966378174`*^9, 3.4800256524097986`*^9, 
  3.496183507788048*^9, 3.496183559131877*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.4008754609474497`*^9, 3.4107226041459217`*^9, 
  3.4120615381503057`*^9, 3.4295467166468225`*^9, 3.4295467488631473`*^9, 
  3.430242880550925*^9, 3.430361393912195*^9, 3.4305054101339025`*^9, 
  3.4446040052802496`*^9, 3.4446046526811666`*^9, 3.477688316284747*^9, 
  3.4776908517906256`*^9, 3.4788064134695406`*^9, 3.4789982939099445`*^9, 
  3.4795001616717186`*^9, 3.4795253966378174`*^9, 3.4800256524097986`*^9, 
  3.496183507788048*^9, 3.4961835591519055`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "for", " ", "getting", " ", "simple", " ", "expressions", " ", "for", " ", 
   "general", " ", "metric"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Clear", "[", "gdet", "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Connection", " ", "for", " ", "KS", " ", "coords", " ", "in", " ", 
   "coordinate", " ", "basis"}], " ", "*)"}]], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyD", "[", 
   RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "\[Equal]", "1"}], ",", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Xp", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "\[Equal]", "2"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", 
        RowBox[{"Xp", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "3"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"f", ",", 
          RowBox[{"Xp", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "4"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{"f", ",", 
            RowBox[{"Xp", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "the", " ", "below", " ", "is", " ", "for", " ", "analytic", " ", 
   "simplification", " ", "purposes"}], " ", "*)"}]], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"myconvert", "=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"mybackconvert", "=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"myconvertr", "=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"mybackconvertr", "=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"mysigmabackconvert", "=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"mysigmaconvert", "=", 
  RowBox[{"{", "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.400875461007536*^9, 3.410722604266094*^9, 
  3.412061538230421*^9, 3.429546716787024*^9, 3.4295467489933343`*^9, 
  3.4302428806811123`*^9, 3.430361394072426*^9, 3.4305054102941327`*^9, 
  3.444604005360365*^9, 3.4446046527512674`*^9, 3.477688316525093*^9, 
  3.477690851910798*^9, 3.478806413830059*^9, 3.4789982940801897`*^9, 
  3.4795001618519773`*^9, 3.479525396697904*^9, 3.480025652499928*^9, 
  3.4961835080784655`*^9, 3.496183559191963*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.400875461007536*^9, 3.410722604266094*^9, 
  3.412061538230421*^9, 3.429546716787024*^9, 3.4295467489933343`*^9, 
  3.4302428806811123`*^9, 3.430361394072426*^9, 3.4305054102941327`*^9, 
  3.444604005360365*^9, 3.4446046527512674`*^9, 3.477688316525093*^9, 
  3.477690851910798*^9, 3.478806413830059*^9, 3.4789982940801897`*^9, 
  3.4795001618519773`*^9, 3.479525396697904*^9, 3.480025652499928*^9, 
  3.4961835080784655`*^9, 3.4961835592019777`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.400875461007536*^9, 3.410722604266094*^9, 
  3.412061538230421*^9, 3.429546716787024*^9, 3.4295467489933343`*^9, 
  3.4302428806811123`*^9, 3.430361394072426*^9, 3.4305054102941327`*^9, 
  3.444604005360365*^9, 3.4446046527512674`*^9, 3.477688316525093*^9, 
  3.477690851910798*^9, 3.478806413830059*^9, 3.4789982940801897`*^9, 
  3.4795001618519773`*^9, 3.479525396697904*^9, 3.480025652499928*^9, 
  3.4961835080784655`*^9, 3.4961835592019777`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.400875461007536*^9, 3.410722604266094*^9, 
  3.412061538230421*^9, 3.429546716787024*^9, 3.4295467489933343`*^9, 
  3.4302428806811123`*^9, 3.430361394072426*^9, 3.4305054102941327`*^9, 
  3.444604005360365*^9, 3.4446046527512674`*^9, 3.477688316525093*^9, 
  3.477690851910798*^9, 3.478806413830059*^9, 3.4789982940801897`*^9, 
  3.4795001618519773`*^9, 3.479525396697904*^9, 3.480025652499928*^9, 
  3.4961835080784655`*^9, 3.4961835592019777`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.400875461007536*^9, 3.410722604266094*^9, 
  3.412061538230421*^9, 3.429546716787024*^9, 3.4295467489933343`*^9, 
  3.4302428806811123`*^9, 3.430361394072426*^9, 3.4305054102941327`*^9, 
  3.444604005360365*^9, 3.4446046527512674`*^9, 3.477688316525093*^9, 
  3.477690851910798*^9, 3.478806413830059*^9, 3.4789982940801897`*^9, 
  3.4795001618519773`*^9, 3.479525396697904*^9, 3.480025652499928*^9, 
  3.4961835080784655`*^9, 3.4961835592019777`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.400875461007536*^9, 3.410722604266094*^9, 
  3.412061538230421*^9, 3.429546716787024*^9, 3.4295467489933343`*^9, 
  3.4302428806811123`*^9, 3.430361394072426*^9, 3.4305054102941327`*^9, 
  3.444604005360365*^9, 3.4446046527512674`*^9, 3.477688316525093*^9, 
  3.477690851910798*^9, 3.478806413830059*^9, 3.4789982940801897`*^9, 
  3.4795001618519773`*^9, 3.479525396697904*^9, 3.480025652499928*^9, 
  3.4961835080784655`*^9, 3.4961835592119923`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"coordtype", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myconvert", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "\[Rule]", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "-", "R0"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"r", "-", "R0"}], "\[Rule]", "drdx1"}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", "*", "Pi", "*", "y"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"h", "-", 
            RowBox[{"Pi", "*", "y"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "hslope"}], ")"}]}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", "*", "Pi", "*", "y"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dhdx2", "-", "Pi"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "hslope"}], ")"}], "*", "Pi"}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}], "\[Rule]", 
         "sigma"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mybackconvert", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "\[Rule]", 
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"h", "\[Rule]", 
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"dhdx2", "->", 
         RowBox[{"dXdXp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", 
        RowBox[{"drdx1", "\[Rule]", 
         RowBox[{"dXdXp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"sigma", "->", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myconvertr", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "\[Rule]", 
         RowBox[{"Log", "[", 
          RowBox[{"r", "-", "R0"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"r", "-", "R0"}], "\[Rule]", "drdx1"}], ",", 
        RowBox[{
         RowBox[{"drdx1", "+", "R0"}], "\[Rule]", "r"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mybackconvertr", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "\[Rule]", 
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"drdx1", "\[Rule]", 
         RowBox[{"dXdXp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mysigmabackconvert", "=", 
      RowBox[{"{", 
       RowBox[{"sigma", "\[Rule]", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"a", "^", "2"}], "*", 
          RowBox[{
           RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mysigmaconvert", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"a", "^", "2"}], "*", 
          RowBox[{
           RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}], "\[Rule]", 
        "sigma"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "//.", 
  "myconvert"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dXdXp", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "3"}], "]"}], "]"}], "//.", 
  "myconvert"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData["y"], "Output",
 CellChangeTimes->{3.4008754611076803`*^9, 3.4107226043962817`*^9, 
  3.412061538310536*^9, 3.429546716857125*^9, 3.429546749123522*^9, 
  3.4302428807712417`*^9, 3.430361394112483*^9, 3.4305054104143057`*^9, 
  3.4446040054805374`*^9, 3.4446046528614254`*^9, 3.4776883166953373`*^9, 
  3.4776908519408417`*^9, 3.4788064143207645`*^9, 3.4789982941302614`*^9, 
  3.479500161922078*^9, 3.479525396737962*^9, 3.48002565255*^9, 
  3.4961835081986384`*^9, 3.4961835592220063`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.4008754611076803`*^9, 3.4107226043962817`*^9, 
  3.412061538310536*^9, 3.429546716857125*^9, 3.429546749123522*^9, 
  3.4302428807712417`*^9, 3.430361394112483*^9, 3.4305054104143057`*^9, 
  3.4446040054805374`*^9, 3.4446046528614254`*^9, 3.4776883166953373`*^9, 
  3.4776908519408417`*^9, 3.4788064143207645`*^9, 3.4789982941302614`*^9, 
  3.479500161922078*^9, 3.479525396737962*^9, 3.48002565255*^9, 
  3.4961835081986384`*^9, 3.496183559232021*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"coordtype", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myconvert", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "\[Rule]", "r"}], ",", 
        RowBox[{"y", "\[Rule]", "h"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}], "\[Rule]", 
         "sigma"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myconvertr", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "\[Rule]", "r"}], ",", 
        RowBox[{"y", "\[Rule]", "h"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"mybackconvert", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "\[Rule]", 
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"h", "\[Rule]", 
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"dhdx2", "->", 
         RowBox[{"dXdXp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", 
        RowBox[{"drdx1", "\[Rule]", 
         RowBox[{"dXdXp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"sigma", "->", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"Cos", "[", "h", "]"}], "^", "2"}]}]}]}]}], "}"}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gcon2", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"gcon", "//.", "myconvert"}], "]"}], "//.", 
           "mybackconvertr"}], "]"}], "//.", "myconvertr"}], "]"}], "//.", 
       "myconvertr"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gcov2", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"gcov", "//.", "myconvert"}], "]"}], "//.", 
           "mybackconvertr"}], "]"}], "//.", "myconvertr"}], "]"}], "//.", 
       "myconvertr"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gdet2", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"gdet", "//.", "myconvert"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", ">", "0"}], ",", 
         RowBox[{"sigma", ">", "0"}], ",", 
         RowBox[{"drdx1", ">", "0"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"simplemetric", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gcon2", "=", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "gcon2", "]"}], "//.", 
        "mybackconvert"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gcov2", "=", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "gcov2", "]"}], "//.", 
        "mybackconvert"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gdet2", "=", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "gdet2", "]"}], "//.", 
        "mybackconvert"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coordtype", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"god1", "=", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{"hslope", "\[Rule]", "1"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "god1", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"god2", "=", 
     RowBox[{
      RowBox[{"dXdXp", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{"hslope", "\[Rule]", "1"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "god2", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "then", " ", "need", " ", "to", " ", "convert", " ", "arrays", " ", "b"}], 
   ",", 
   RowBox[{
    RowBox[{"u", " ", "to", " ", "C"}], "-", "form"}]}], " ", "*)"}]], "Input"]
},
WindowSize->{901, 816},
WindowMargins->{{113, Automatic}, {Automatic, 36}},
Magnification->1.25,
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 26, 0, 35, "Input"],
Cell[CellGroupData[{
Cell[596, 24, 349, 5, 124, "Input"],
Cell[948, 31, 1215, 20, 72, "Message"],
Cell[2166, 53, 1157, 20, 72, "Message"],
Cell[3326, 75, 1221, 21, 72, "Message"],
Cell[4550, 98, 1125, 18, 72, "Message"],
Cell[5678, 118, 1132, 19, 72, "Message"]
}, Open  ]],
Cell[6825, 140, 1740, 51, 190, "Input"],
Cell[CellGroupData[{
Cell[8590, 195, 849, 12, 80, "Input"],
Cell[9442, 209, 521, 7, 35, "Output"],
Cell[9966, 218, 521, 7, 35, "Output"],
Cell[10490, 227, 523, 7, 35, "Output"]
}, Open  ]],
Cell[11028, 237, 26, 0, 35, "Input"],
Cell[11057, 239, 26, 0, 35, "Input"],
Cell[CellGroupData[{
Cell[11108, 243, 1365, 49, 58, "Input"],
Cell[12476, 294, 1052, 29, 57, "Output"],
Cell[13531, 325, 1041, 29, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14609, 359, 1219, 40, 80, "Input"],
Cell[15831, 401, 888, 22, 62, "Output"],
Cell[16722, 425, 898, 22, 57, "Output"],
Cell[17623, 449, 699, 15, 53, "Output"]
}, Open  ]],
Cell[18337, 467, 3511, 115, 256, "Input"],
Cell[21851, 584, 238, 5, 35, "Input"],
Cell[22092, 591, 1281, 38, 190, "Input"],
Cell[CellGroupData[{
Cell[23398, 633, 1075, 33, 146, "Input"],
Cell[24476, 668, 537, 8, 35, "Output"],
Cell[25016, 678, 537, 8, 35, "Output"],
Cell[25556, 688, 587, 10, 56, "Output"]
}, Open  ]],
Cell[26158, 701, 19498, 599, 1444, "Input"],
Cell[45659, 1302, 198, 5, 35, "Input"],
Cell[45860, 1309, 2454, 70, 696, "Input"],
Cell[48317, 1381, 256, 7, 35, "Input"],
Cell[48576, 1390, 126, 3, 35, "Input"],
Cell[CellGroupData[{
Cell[48727, 1397, 241, 7, 58, "Input"],
Cell[48971, 1406, 566, 9, 35, "Output"],
Cell[49540, 1417, 566, 9, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50143, 1431, 5192, 152, 520, "Input"],
Cell[55338, 1585, 569, 9, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55944, 1599, 471, 14, 58, "Input"],
Cell[56418, 1615, 843, 17, 35, "Output"],
Cell[57264, 1634, 1133, 26, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58434, 1665, 384, 12, 35, "Input"],
Cell[58821, 1679, 651, 12, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59509, 1696, 1380, 44, 102, "Input"],
Cell[60892, 1742, 2491, 75, 108, "Output"]
}, Open  ]],
Cell[63398, 1820, 204, 4, 35, "Input"],
Cell[63605, 1826, 3739, 109, 388, "Input"],
Cell[67347, 1937, 26, 0, 35, "Input"],
Cell[67376, 1939, 102, 2, 35, "Input"],
Cell[CellGroupData[{
Cell[67503, 1945, 8839, 234, 762, "Input"],
Cell[CellGroupData[{
Cell[76367, 2183, 511, 7, 27, "Print"],
Cell[76881, 2192, 513, 7, 27, "Print"]
}, Open  ]]
}, Open  ]],
Cell[77421, 2203, 177, 4, 35, "Input"],
Cell[77601, 2209, 86, 2, 35, "Input"],
Cell[77690, 2213, 172, 4, 35, "Input"],
Cell[77865, 2219, 26, 0, 35, "Input"],
Cell[77894, 2221, 1034, 32, 58, "Input"],
Cell[78931, 2255, 177, 4, 35, "Input"],
Cell[79111, 2261, 26, 0, 35, "Input"],
Cell[CellGroupData[{
Cell[79162, 2265, 481, 12, 146, "Input"],
Cell[79646, 2279, 515, 8, 35, "Output"],
Cell[80164, 2289, 517, 8, 35, "Output"],
Cell[80684, 2299, 517, 8, 35, "Output"],
Cell[81204, 2309, 517, 8, 35, "Output"],
Cell[81724, 2319, 517, 8, 35, "Output"],
Cell[82244, 2329, 517, 8, 35, "Output"]
}, Open  ]],
Cell[82776, 2340, 3803, 111, 234, "Input"],
Cell[CellGroupData[{
Cell[86604, 2455, 283, 9, 80, "Input"],
Cell[86890, 2466, 504, 7, 35, "Output"],
Cell[87397, 2475, 502, 7, 35, "Output"]
}, Open  ]],
Cell[87914, 2485, 1687, 49, 146, "Input"],
Cell[89604, 2536, 2029, 53, 410, "Input"],
Cell[91636, 2591, 26, 0, 35, "Input"],
Cell[91665, 2593, 765, 22, 146, "Input"],
Cell[92433, 2617, 237, 7, 35, "Input"]
}
]
*)

(* End of internal cache information *)
