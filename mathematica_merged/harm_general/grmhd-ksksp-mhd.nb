(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     58110,       1599]
NotebookOptionsPosition[     55088,       1512]
NotebookOutlinePosition[     55428,       1527]
CellTagsIndexPosition[     55385,       1524]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"veltype", "=", "0"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.4120616002696285`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "compute", " ", "and", " ", "simplify", " ", "first", " ", "before", " ", 
   "plugging", " ", "in", " ", 
   RowBox[{"detials", " ", "--"}], " ", "just", " ", "use", " ", "symmetry", 
   " ", "of", " ", "tensor", " ", "essentially", " ", "to", " ", "simplify", 
   " ", "a", " ", "bit"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"b2", ",", "p", ",", "eta", ",", "ptot", ",", "u", ",", "b"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"coefficients", " ", "in", " ", "T"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"gam", "-", "1"}], ")"}], "*", "en"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eta", "=", 
     RowBox[{"p", "+", "rho", "+", "en", "+", "b2"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ptot", "=", 
     RowBox[{"p", "+", 
      RowBox[{"b2", "/", "2"}]}]}], ";"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Stress", " ", 
    RowBox[{"T", "^", 
     RowBox[{"{", "ij", "}"}]}], " ", "and", " ", "related", " ", 
    "quantities"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "*", 
         RowBox[{"u", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"u", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "+", 
        RowBox[{"ptot", "*", 
         RowBox[{"gcon2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"b", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Tmix", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
          RowBox[{"gcov2", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"simplemetric", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tmix", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"Tmix", "//.", "mybackconvert"}], "]"}], "//.", 
            "myconvert"}], "]"}], "//.", "myconvert"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tud", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eta", "*", 
         RowBox[{"u", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"ucov", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "+", 
        RowBox[{"ptot", "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"bcov", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"gdet2", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"prim", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"u", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Tmix", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"prim", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"u", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"Tmix", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"Tmix", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"Tmix", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "7", "]"}], "]"}], ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"F", "[", 
     RowBox[{"[", 
      RowBox[{"coord", ",", "eq"}], "]"}], "]"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"g", "*", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"prim", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Tmix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"prim", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"Tmix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"Tmix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"Tmix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"u", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
             RowBox[{"u", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"u", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
             RowBox[{"u", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "*", 
             RowBox[{"u", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"b", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
             RowBox[{"u", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(u \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616006601906`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(u \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061600680219*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(u \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061600700248*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616008104067`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(1, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616008304353`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(2, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061600850464*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(3, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061600850464*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616008905215`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(u \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616009205647`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(ucov \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616009205647`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(b \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061600930579*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616009606223`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(prim \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061600980651*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(u \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616009906654`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(prim \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616010106945`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061601030723*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(prim \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616010507517`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(u \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061601060766*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(prim \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616010807953`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616011008244`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dU", "=", 
   RowBox[{"gdet2", "*", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Tmix", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "k"}], "]"}], "]"}], "*", 
         RowBox[{"Connection2", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "aa", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"aa", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"simplemetric", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"dU1", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"dU", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//.", "mybackconvert"}], "]"}], 
          "//.", "myconvert"}], "]"}], "//.", "myconvert"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dU4", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"dU", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "//.", "mybackconvert"}], "]"}], 
          "//.", "myconvert"}], "]"}], "//.", "myconvert"}], "]"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dU2", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"dU", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dU3", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"dU", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dUfs", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "dU2", ",", "dU3", ",", "0"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"veltype", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "veltype", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"prim", "=", 
       RowBox[{"{", 
        RowBox[{
        "rho", ",", "en", ",", "ux", ",", "uy", ",", "uz", ",", "bx", ",", 
         "by", ",", "bz"}], "}"}]}], ";", "\n", 
      RowBox[{"u", "=", 
       RowBox[{"{", 
        RowBox[{"ut", ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], ";", "\n", 
      RowBox[{"B", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", "ut", "]"}], "\[IndentingNewLine]", 
       RowBox[{"AA", "=", 
        RowBox[{"gcov", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", "\n", 
      RowBox[{"BB", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gcov2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{"CC", "=", 
       RowBox[{"1", "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gcov2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"u", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{"disc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "BB", ")"}], "^", "2"}], "-", 
        RowBox[{"4", "*", "AA", "*", "CC"}]}]}], ";", "\n", 
      RowBox[{"utp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "BB"}], "+", 
          RowBox[{"Sqrt", "[", "disc", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "AA"}], ")"}]}]}], ";", "\n", 
      RowBox[{"utm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "BB"}], "-", 
          RowBox[{"Sqrt", "[", "disc", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "AA"}], ")"}]}]}], ";", "\n", 
      RowBox[{"disc2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"BB", "/", "2"}], "/", "AA"}], ")"}], "^", "2"}], "-", 
        RowBox[{"CC", "/", "AA"}]}]}], ";", "\n", 
      RowBox[{"utp2", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "BB"}], "/", "AA"}], "/", "2"}], "+", 
         RowBox[{
          RowBox[{"Sign", "[", "AA", "]"}], "*", 
          RowBox[{"Sqrt", "[", "disc2", "]"}]}]}], ")"}]}], ";", "\n", 
      RowBox[{"utm2", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "BB"}], "/", "AA"}], "/", "2"}], "-", 
         RowBox[{
          RowBox[{"Sign", "[", "AA", "]"}], "*", 
          RowBox[{"Sqrt", "[", "disc2", "]"}]}]}], ")"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "ut"}], ";", "\n", 
      RowBox[{"v", "=", 
       RowBox[{"u", "/", "ut"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"3", " ", "velocity"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"utsols1", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"utm", ",", "utp"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"utsols2", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"utm2", ",", "utp2"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "ut", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"utsols3", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", ".", "gcov2", ".", "u"}], "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", "ut"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input"],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{3.4120616011408815`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(1, 2\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061601150896*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(1, 3\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061601150896*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(1, 4\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061601180939*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.4120616012109823`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"dinv\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"The expression \\!\\(\\(\\({ut, ux, uy, uz}\\)\\) . gcov2 \
. \\(\\({ut, ux, uy, uz}\\)\\)\\) involves unknowns in more than one \
argument, so inverse functions cannot be used. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Solve/dinv\\\", ButtonNote -> \
\\\"Solve::dinv\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.412061601301112*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"3", "-", 
    RowBox[{"velocity", " ", "is", " ", "primitive", " ", "variable"}]}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"veltype", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "veltype", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "ut", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"prim", "=", 
       RowBox[{"{", 
        RowBox[{
        "rho", ",", "en", ",", "vx", ",", "vy", ",", "vz", ",", "Bx", ",", 
         "By", ",", "Bz"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u", "=", 
       RowBox[{"{", 
        RowBox[{"ut", ",", 
         RowBox[{"ut", "*", 
          RowBox[{"prim", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"ut", "*", 
          RowBox[{"prim", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"ut", "*", 
          RowBox[{"prim", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"utsols4", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", ".", "gcov2", ".", "u"}], "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", "ut"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"discrutp", "=", 
       RowBox[{
        RowBox[{"gcov2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"gcov2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"gcov2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"gcov2", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gcov2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"gcov2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"gcov2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"gcov2", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"gcov2", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"gcov2", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"discrutpform", "=", 
       RowBox[{"gcov11", "+", 
        RowBox[{"gcov22", "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "+", 
        RowBox[{"gcov33", "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "+", 
        RowBox[{"gcov44", "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "*", 
         RowBox[{"prim", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gcov12", "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", 
           RowBox[{"gcov13", "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "+", 
           RowBox[{"gcov14", "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "+", 
           RowBox[{"gcov23", "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "+", 
           RowBox[{"gcov24", "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "+", 
           RowBox[{"gcov34", "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "*", 
            RowBox[{"prim", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ddiscrutpform", "=", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"discrutpform", ",", 
             RowBox[{"prim", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"discrutpform", ",", 
             RowBox[{"prim", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"discrutpform", ",", 
             RowBox[{"prim", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], "}"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "this", " ", "sqrt", " ", "of", " ", "square", " ", "can", " ", 
           "be", " ", "done", " ", "because", " ", "utm", " ", "and", " ", 
           "utp", " ", "only", " ", "off", " ", "by", " ", "sign", " ", "and",
            " ", "we", " ", "want", " ", "pure", " ", "real", " ", 
           "solution"}], ",", " ", 
          RowBox[{
          "ut", " ", "with", " ", "good", " ", "vars", " ", "will", " ", 
           "never", " ", "be", " ", "imaginary"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"utm", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"utsols4", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ")"}], "^", "2"}], "]"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"utp", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"utsols4", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ")"}], "^", "2"}], "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"veltype", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "veltype", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"relative", " ", "4"}], "-", 
       RowBox[{"velocity", " ", "is", " ", "primitive", " ", "variable"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"gmcov", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"gcov2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MatrixForm", "[", "gmcov", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "inverse", " ", "is", " ", "inverse", " ", "of", " ", "new", " ", 
         "3"}], "-", "metric"}], ",", " ", 
       RowBox[{
        RowBox[{"not", " ", "4"}], "-", "metric"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "ut", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"gmcon", "=", 
      RowBox[{"Inverse", "[", "gmcov", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prim", "=", 
      RowBox[{"{", 
       RowBox[{
       "rho", ",", "en", ",", "vx", ",", "vy", ",", "vz", ",", "Bx", ",", 
        "By", ",", "Bz"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"VR", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"prim", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qsq", "=", 
      RowBox[{"VR", ".", "gmcov", ".", "VR"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gammaf", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"qsq", "+", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"alphaco", "=", 
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"-", 
         RowBox[{"gcon2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"betacon", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gcon2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
         RowBox[{"alphaco", "^", "2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"utm", "=", 
      RowBox[{"utp", "=", 
       RowBox[{"gammaf", "/", "alphaco"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"{", 
       RowBox[{"utp", ",", 
        RowBox[{
         RowBox[{"prim", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "-", 
         RowBox[{"utp", "*", 
          RowBox[{"betacon", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"prim", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "-", 
         RowBox[{"utp", "*", 
          RowBox[{"betacon", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"prim", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "-", 
         RowBox[{"utp", "*", 
          RowBox[{"betacon", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"simplemetric", "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"utp", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"utp", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sigma", ">", "0"}], ",", 
             RowBox[{"M", ">", "0"}], ",", 
             RowBox[{"r", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"u", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sigma", ">", "0"}], ",", 
             RowBox[{"M", ">", "0"}], ",", 
             RowBox[{"r", ">", "0"}]}], "}"}]}], "]"}]}], ";"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "7", "]"}], "]"}], ",", 
        RowBox[{"prim", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bt", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"u", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "*", 
      RowBox[{"gcov2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"simplemetric", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bt", "=", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"bt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sigma", ">", "0"}], ",", 
          RowBox[{"M", ">", "0"}], ",", 
          RowBox[{"r", ">", "0"}]}], "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "+", 
        RowBox[{"bt", "*", 
         RowBox[{"u", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
      RowBox[{"u", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"b2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", ".", "gcov2"}], ")"}], ".", "b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ucov", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"u", ".", 
      RowBox[{"gcov2", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"bcov", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"b", ".", 
      RowBox[{"gcov2", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(2, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616014513283`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(2, 2\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616014913855`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(2, 3\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616015114145`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.412061601521429*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616015414577`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.412061601571501*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] 3 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.412061601571501*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.41206160159153*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616016215725`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616016416016`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] 3 \
\[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616016716447`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4120616016916733`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ucon", "=", "u"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcon", "=", "b"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyD", "[", 
   RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "\[Equal]", "1"}], ",", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", "t"}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "\[Equal]", "2"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", "x"}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "3"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"f", ",", "y"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "4"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{"f", ",", "z"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Faradayuu", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "gdet"}], ")"}], "*", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Signature", "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "]"}]}], "*", 
         
         RowBox[{"ucov", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "*", 
         RowBox[{"bcov", "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Faradaydd", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Faradayuu", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
        RowBox[{"gcov2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "n"}], "]"}], "]"}], "*", 
        RowBox[{"gcov2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "m"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(1, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.41206160175176*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(1, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.412061601801832*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(gcov2 \[LeftDoubleBracket] \
\\(\\(1, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.412061601831875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.412061601851904*^9}]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"simplemetric", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputreplaceharm", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dhdx2", "\[Rule]", "\"\<dxdxp[2]\>\""}], ",", 
       RowBox[{"drdx1", "\[Rule]", "\"\<dxdxp[1]\>\""}], ",", 
       RowBox[{"Cos", "\[Rule]", "cos"}], ",", 
       RowBox[{"Sin", "\[Rule]", "sin"}], ",", 
       RowBox[{"y", "\[Rule]", "\"\<X[2]\>\""}], ",", 
       RowBox[{"Cot", "\[Rule]", "cot"}], ",", 
       RowBox[{"Power", "\[Rule]", "pow"}], ",", 
       RowBox[{"h", "\[Rule]", "th"}], ",", 
       RowBox[{"Pi", "\[Rule]", "\"\<M_PI\>\""}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"harmprintdU", "=", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"dUfs", "//.", "outputreplaceharm"}], "//.", 
       RowBox[{"{", 
        RowBox[{"M", "\[Rule]", "1"}], "}"}]}], "]"}]}], ";", "\n", 
    RowBox[{"strm", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{"\"\<c:\\\\dUfsfull.txt\>\"", ",", 
       RowBox[{"FormatType", "\[Rule]", "CForm"}]}], "]"}]}], ";", "\n", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "4"}], ",", 
      RowBox[{
       RowBox[{"ii", "=", 
        RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{
        "strm", ",", "\"\<dU[\>\"", ",", "ii", ",", "\"\<]=\>\"", ",", 
         RowBox[{"harmprintdU", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<;\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "++"}]}]}], "]"}], ";", "\n", 
    RowBox[{"Close", "[", "strm", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[""], "Input"]
},
WindowSize->{874, 907},
WindowMargins->{{Automatic, 9}, {Automatic, 0}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (April 20, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 55, 1, 31, "Input"],
Cell[648, 26, 72, 1, 30, "Output"]
}, Open  ]],
Cell[735, 30, 26, 0, 31, "Input"],
Cell[764, 32, 360, 7, 52, "Input"],
Cell[1127, 41, 130, 3, 31, "Input"],
Cell[1260, 46, 501, 17, 92, "Input"],
Cell[CellGroupData[{
Cell[1786, 67, 7021, 205, 312, "Input"],
Cell[8810, 274, 459, 9, 22, "Message"],
Cell[9272, 285, 457, 9, 22, "Message"],
Cell[9732, 296, 457, 9, 22, "Message"],
Cell[10192, 307, 448, 9, 22, "Message"],
Cell[10643, 318, 478, 9, 22, "Message"],
Cell[11124, 329, 476, 9, 22, "Message"],
Cell[11603, 340, 476, 9, 22, "Message"],
Cell[12082, 351, 448, 9, 22, "Message"],
Cell[12533, 362, 459, 9, 22, "Message"],
Cell[12995, 373, 462, 9, 22, "Message"],
Cell[13460, 384, 457, 9, 22, "Message"],
Cell[13920, 395, 448, 9, 22, "Message"],
Cell[14371, 406, 460, 9, 22, "Message"],
Cell[14834, 417, 459, 9, 22, "Message"],
Cell[15296, 428, 462, 9, 22, "Message"],
Cell[15761, 439, 446, 9, 22, "Message"],
Cell[16210, 450, 462, 9, 22, "Message"],
Cell[16675, 461, 457, 9, 22, "Message"],
Cell[17135, 472, 462, 9, 22, "Message"],
Cell[17600, 483, 448, 9, 22, "Message"]
}, Open  ]],
Cell[18063, 495, 681, 20, 31, "Input"],
Cell[18747, 517, 1447, 40, 152, "Input"],
Cell[CellGroupData[{
Cell[20219, 561, 4899, 137, 532, "Input"],
Cell[25121, 700, 71, 1, 23, "Print"],
Cell[25195, 703, 476, 9, 22, "Message"],
Cell[25674, 714, 476, 9, 22, "Message"],
Cell[26153, 725, 476, 9, 22, "Message"],
Cell[26632, 736, 448, 9, 22, "Message"],
Cell[27083, 747, 523, 10, 41, "Message"]
}, Open  ]],
Cell[27621, 760, 8307, 219, 492, "Input"],
Cell[35931, 981, 4792, 131, 412, "Input"],
Cell[CellGroupData[{
Cell[40748, 1116, 2111, 70, 172, "Input"],
Cell[42862, 1188, 485, 9, 21, "Message"],
Cell[43350, 1199, 485, 9, 21, "Message"],
Cell[43838, 1210, 485, 9, 21, "Message"],
Cell[44326, 1221, 453, 9, 21, "Message"],
Cell[44782, 1232, 470, 9, 21, "Message"],
Cell[45255, 1243, 468, 9, 21, "Message"],
Cell[45726, 1254, 468, 9, 21, "Message"],
Cell[46197, 1265, 452, 9, 21, "Message"],
Cell[46652, 1276, 470, 9, 21, "Message"],
Cell[47125, 1287, 470, 9, 21, "Message"],
Cell[47598, 1298, 470, 9, 21, "Message"],
Cell[48071, 1309, 455, 9, 21, "Message"]
}, Open  ]],
Cell[48541, 1321, 143, 4, 52, "Input"],
Cell[48687, 1327, 764, 24, 31, "Input"],
Cell[49454, 1353, 26, 0, 31, "Input"],
Cell[49483, 1355, 26, 0, 31, "Input"],
Cell[49512, 1357, 26, 0, 31, "Input"],
Cell[CellGroupData[{
Cell[49563, 1361, 1744, 53, 92, "Input"],
Cell[51310, 1416, 482, 9, 21, "Message"],
Cell[51795, 1427, 483, 9, 21, "Message"],
Cell[52281, 1438, 483, 9, 21, "Message"],
Cell[52767, 1449, 453, 9, 21, "Message"]
}, Open  ]],
Cell[53235, 1461, 26, 0, 31, "Input"],
Cell[53264, 1463, 1762, 43, 212, "Input"],
Cell[55029, 1508, 26, 0, 31, "Input"],
Cell[55058, 1510, 26, 0, 31, "Input"]
}
]
*)

(* End of internal cache information *)

