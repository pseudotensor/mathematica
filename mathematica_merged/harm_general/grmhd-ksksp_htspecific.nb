(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     25671,        662]*)
(*NotebookOutlinePosition[     26336,        685]*)
(*  CellTagsIndexPosition[     26292,        681]*)
(*WindowFrame->Normal*)



Notebook[{
Cell[BoxData[{
    \(<< Calculus`VectorAnalysis`\), "\[IndentingNewLine]", 
    \(<< LinearAlgebra`Orthogonalization`\), "\[IndentingNewLine]", 
    \(<< DiscreteMath`Combinatorica`\), "\[IndentingNewLine]", 
    \(<< Graphics`Graphics`\), "\[IndentingNewLine]", 
    \(<< Graphics`ImplicitPlot`\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(\( (*\(sinh = 
          Abs[Sin[h]];\)*) \)\(\[IndentingNewLine]\)\(\[IndentingNewLine]\)\( \
(*Minkowski\ coords*) \)\( (*\(gcov = {{\(-1\), 0, 0, 0}, {0, 1, 0, 0}, {0, 
              0, 1, 0}, {0, 0, 0, 
              1}};\)*) \)\(\[IndentingNewLine]\)\( (*KS\ coordinates\ of\ \
Kerr - Newman\ geometry*) \)\(\[IndentingNewLine]\)\(\(nab = {{\(-1\), 0, 0, 
            0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}};\)\n
    \(Inverse[nab];\)\n
    \)\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(sinh\\)\\\" is similar to existing symbol \\\
\"\\!\\(Sinh\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(cosh\\)\\\" is similar to existing symbol \\\
\"\\!\\(Cosh\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(simplemetric = 0\), "\[IndentingNewLine]", 
    \(metrictype = 9\), "\[IndentingNewLine]", 
    \(coordtype = 0\)}], "Input"],

Cell[BoxData[
    \(0\)], "Output"],

Cell[BoxData[
    \(9\)], "Output"],

Cell[BoxData[
    \(0\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \(\@\(\(-1\) + z\^2\)\ \((\(\(-2\) + 3\ z\^2\)\/\(\(-1\) + z\^2\) - 
          3\/2\ z\ Log[\(1 + z\)\/\(\(-1\) + z\)])\)\)], "Output"],

Cell[BoxData[
    \(\(-\(\(\(-5\)\ z + 3\ z\^3\)\/\(\(-1\) + z\^2\)\)\) + 
      3\/2\ \((\(-1\) + z\^2)\)\ Log[\(1 + z\)\/\(\(-1\) + z\)]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(Q12\\)\\\" is similar to existing symbol \
\\\"\\!\\(q12\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \(\(\(-4\) + 6\ z\^2 + 3\ z\ \((\(-1\) + z\^2)\)\ \((Log[\(-1\) + z] - \
Log[1 + z])\)\)\/\(2\ \@\(\(-1\) + z\^2\)\)\)], "Output"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(Q22\\)\\\" is similar to existing symbol \
\\\"\\!\\(q22\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \(z\ \((\(-3\) + 2\/\(\(-1\) + z\^2\))\) + 
      3\/2\ \((\(-1\) + z\^2)\)\ Log[\(1 + z\)\/\(\(-1\) + z\)]\)], "Output"],

Cell[BoxData[
    \(\(-\(1\/2\)\) + \(3\ Cos[h]\^2\)\/2\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(If[
        simplemetric \[Equal] 0, \[IndentingNewLine]delta = 
          r^2 - 2*M*r + a^2; \[IndentingNewLine]sigma = 
          r^2 + a^2*Cos[h]^2; \[IndentingNewLine]A = \((r^2 + a^2)\)^2 - 
            delta*a^2*Sin[h]^2; \[IndentingNewLine]rp = 
          M + Sqrt[
              M^2 - a^2];\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        simplemetric \[Equal] 1, \[IndentingNewLine]Clear[delta, sigma, A, 
          rp]\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(nummetrics = 9;\)\), "\[IndentingNewLine]", 
    \(\(ds2mink = \(-dt^2\) + dr^2 + dh^2 + 
          dphi^2;\)\), "\[IndentingNewLine]", 
    \(\(ds2swart = \(-\((1 - 2*M/r)\)\)*dt^2 + 1/\((1 - 2*M/r)\)*dr^2 + 
          r^2*\((dh^2 + sinh^2*dphi^2)\);\)\), "\[IndentingNewLine]", 
    \(\(ds2ks = \(-\((1 - 2*M*r/sigma)\)\)*dt^2 - 
          4*M*a*r/sigma*sinh^2*dt*dphi + 
          4*M*r/sigma*dt*dr + \((1 + 2*M*r/sigma)\)*dr^2 - 
          2*a*\((1 + 2*M*r/sigma)\)*sinh^2*dr*dphi + sigma*dh^2 + 
          sinh^2*\((sigma + a^2*\((1 + 2*M*r/sigma)\)*sinh^2)\)*
            dphi^2;\)\), "\[IndentingNewLine]", 
    \(\(ds2gen = 
        gcov11*dt^2 + gcov22*dr^2 + gcov33*dh^2 + gcov44*dphi^2 + 
          2*\((gcov12*dt*dr + gcov13*dt*dh + gcov14*dt*dphi + gcov23*dr*dh + 
                gcov24*dr*dphi + 
                gcov34*dh*dphi)\);\)\), "\[IndentingNewLine]", 
    \(\(ds2semigen = 
        gcov11*dt^2 + gcov22*dr^2 + gcov33*dh^2 + gcov44*dphi^2 + 
          2*\((gcov14*dt*dphi)\);\)\), "\[IndentingNewLine]", 
    \(\(ds2bl = \((\(-1\) + 2*M*r/sigma)\)*dt^2 - 
          4*M*a*r*Sin[h]^2/sigma*dt*dphi + sigma/delta*dr^2 + sigma*dh^2 + 
          A*Sin[h]^2/sigma*dphi^2;\)\), "\[IndentingNewLine]", 
    \(\(ds2minkspc = \(-dt^2\) + dr^2 + r^2*dh^2 + 
          r^2*Sin[h]^2*
            dphi^2;\)\[IndentingNewLine]\), "\[IndentingNewLine]", 
    \(\(gconsts = {gcov12 -> gcov21, gcov13 -> gcov31, gcov14 -> gcov41, 
          gcov23 -> gcov32, gcov24 -> gcov42, 
          gcov34 -> gcov43};\)\), "\[IndentingNewLine]", 
    \(\(bl2ks = {{1, 2*M*x/delta, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 
            a/delta, 0, 1}};\)\), "\[IndentingNewLine]", 
    \(\(ks2bl = Inverse[bl2ks];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(gcov21\\)\\\" is similar to existing symbol \
\\\"\\!\\(gcov12\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(gcov31\\)\\\" is similar to existing symbol \
\\\"\\!\\(gcov13\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(gcov41\\)\\\" is similar to existing symbol \
\\\"\\!\\(gcov14\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell1\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(ks2bl\\)\\\" is similar to existing symbol \
\\\"\\!\\(ds2bl\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \( (*\ metrictype \[Equal] 
        1\ reserved\ for\ current\ active\ metric\ *) \)], "Input"],

Cell[BoxData[{
    \(\(If[
        metrictype \[Equal] 
          2, \[IndentingNewLine]\(ds2 = 
            ds2mink;\)\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        metrictype \[Equal] 
          3, \[IndentingNewLine]\(ds2 = 
            ds2swart;\)\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        metrictype \[Equal] 
          4, \[IndentingNewLine]\(ds2 = 
            ds2ks;\)\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        metrictype \[Equal] 
          5, \[IndentingNewLine]\(ds2 = 
            ds2gen;\)\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        metrictype \[Equal] 
          6, \[IndentingNewLine]\(ds2 = 
            ds2bl;\)\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        metrictype \[Equal] 
          7, \[IndentingNewLine]\(ds2 = 
            ds2minkspc;\)\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        metrictype \[Equal] 
          8, \[IndentingNewLine]\(ds2 = 
            ds2semigen;\)\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        metrictype \[Equal] 
          9, \[IndentingNewLine]\(ds2 = 
            ds2ht;\)\[IndentingNewLine]];\)\)}], "Input"],

Cell[BoxData[
    \(\(ds2list = {ds2, ds2mink, ds2swart, ds2ks, ds2gen, ds2bl, ds2minkspc, 
          ds2semigen, ds2ht};\)\)], "Input"],

Cell[BoxData[
    \( (*Coordinate\ transformation\ for\ metric*) \)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Xp = {t, x, y, z}\), "\[IndentingNewLine]", 
    \(X0 = {t, r, h, p}\)}], "Input"],

Cell[BoxData[
    \({t, x, y, z}\)], "Output"],

Cell[BoxData[
    \({t, r, h, p}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(If[coordtype \[Equal] 2,  (*\ 
        KSprim\ jon*) \[IndentingNewLine]X = {t, 
          Rin*Exp[x], \((\((\(-49. \)*hslope + 60. *Pi)\)*y)\)/
              12.  + \((\((247. *hslope - 240. *Pi)\)*\((y^2)\))\)/
              12.  + \((\((\(-83. \)*hslope + 80. *Pi)\)*\((y^3)\))\)/
              2.  - \((5. *\((\(-25. \)*hslope + 24. *Pi)\)*\((y^4)\))\)/
              3.  + \((2. *\((\(-25. \)*hslope + 24. *Pi)\)*\((y^5)\))\)/3. , 
          z}\[IndentingNewLine]]\), "\[IndentingNewLine]", 
    \(If[coordtype \[Equal] 
        1,  (*KSprim*) \[IndentingNewLine]X = {t, R0 + Exp[x], 
          Pi*y + \((\((1 - hslope)\)/2)\)*Sin[2*Pi*y], 
          z}]\), "\[IndentingNewLine]", 
    \(If[coordtype \[Equal] 0, \[IndentingNewLine] (*\ 
        KS*) \[IndentingNewLine]X = {t, x, y, 
          z}\[IndentingNewLine]]\)}], "Input"],

Cell[BoxData[
    \({t, x, y, z}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(dXdXp = 
      Table[D[X[\([i]\)], Xp[\([j]\)]], {i, 1, 4}, {j, 1, 4}]\), "\n", 
    \(MatrixForm[dXdXp]\)}], "Input"],

Cell[BoxData[
    \({{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}\)], "Output"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "0"},
            {"0", "1", "0", "0"},
            {"0", "0", "1", "0"},
            {"0", "0", "0", "1"}
            }], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(bl2kspconsts = {r \[Rule] X[\([2]\)], h \[Rule] X[\([3]\)], 
        p \[Rule] X[\([4]\)]}\)], "Input"],

Cell[BoxData[
    \({r \[Rule] x, h \[Rule] y, p \[Rule] z}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(metricconsts = {delta -> r^2 - 2*M*r + a^2, 
          sigma -> r^2 + a^2*Cos[h]^2, 
          A -> \((r^2 + a^2)\)^2 - delta*a^2*Sin[h]^2, 
          rp -> M + Sqrt[M^2 - a^2]} //. {r \[Rule] X[\([2]\)], 
          h \[Rule] X[\([3]\)], p \[Rule] X[\([4]\)]}\)], "Input"],

Cell[BoxData[
    \({a\^2 - 2\ M\ x + x\^2 \[Rule] a\^2 - 2\ M\ x + x\^2, 
      x\^2 + a\^2\ Cos[y]\^2 \[Rule] 
        x\^2 + a\^2\ Cos[y]\^2, \((a\^2 + x\^2)\)\^2 - 
          a\^2\ \((a\^2 - 2\ M\ x + 
                x\^2)\)\ Sin[y]\^2 \[Rule] \((a\^2 + x\^2)\)\^2 - 
          a\^2\ \((a\^2 - 2\ M\ x + x\^2)\)\ Sin[y]\^2, 
      M + \@\(\(-a\^2\) + M\^2\) \[Rule] 
        M + \@\(\(-a\^2\) + M\^2\)}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \( (*\ solve\ for\ inner/
          outer\ edges\ for\ simplification\ procedures\ *) \)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(If[
        simplemetric \[Equal] 
          0, \[IndentingNewLine]consts = {Rin \[Rule] 0, 
            Rout \[Rule] 
              10^30}; \[IndentingNewLine]eq1 = \((X[\([2]\)] \[Equal] Rin)\) //. 
            consts; \n
        Xin = \(\(\(NSolve[eq1, x]\)[\([1]\)]\)[\([1]\)]\)[\([2]\)]; \n
        eq2 = \((X[\([2]\)] \[Equal] Rout)\) //. consts; \n
        Xout = \(\(\(NSolve[eq2, x]\)[\([1]\)]\)[\([1]\)]\)[\([2]\)]; \n
        eq3 = \((X[\([3]\)] \[Equal] 0)\) //. consts; \n
        Yin = \(\(FindRoot[eq3, {y, 0}]\)[\([1]\)]\)[\([2]\)]; \n
        eq4 = \((X[\([3]\)] \[Equal] Pi)\) //. consts; \n
        Yout = \(\(FindRoot[eq4, {y, 1}]\)[\([1]\)]\)[\([2]\)]; \n
        eq5 = \((X[\([3]\)] \[Equal] Pi/2)\) //. consts; \n
        Ymid = \(\(FindRoot[
                eq5, {y, 
                  0.5}]\)[\([1]\)]\)[\([2]\)]; \[IndentingNewLine]conditions \
= {x \[GreaterEqual] Xin, Yin \[LessEqual] y \[LessEqual] Yout, 
            M \[GreaterEqual] 0, a >= 0, 1 <= hslope >= 0, 
            Rin > 0};\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(If[
        simplemetric \[Equal] 
          1, \[IndentingNewLine]\(conditions = \
{};\)\[IndentingNewLine]];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(consts\\)\\\" is similar to existing symbol \
\\\"\\!\\(gconsts\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(Rout\\)\\\" is similar to existing symbol \\\
\"\\!\\(Root\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(Xout\\)\\\" is similar to existing symbol \\\
\"\\!\\(Rout\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell1\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(Yout\\)\\\" is similar to existing symbols \
\\!\\({Rout, Xout}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(For[ds2i = 1, 
      ds2i \[LessEqual] 
        nummetrics + 1, \[IndentingNewLine]\[IndentingNewLine]g0 = 
        Sqrt[\(-Det[gcov0]\)]; \[IndentingNewLine]If[ds2i \[Equal] 1, \ 
        gcov = gcov0; gcon = gcon0; gdetreal = gdetreal0; gdet = gdet0; 
        g = g0;]; \[IndentingNewLine]If[ds2i \[Equal] 2, \ gcovmink = gcov0; 
        gconmink = gcon0; gdetrealmink = gdetreal0; gdetmink = gdet0; 
        gmink = g0;]; \[IndentingNewLine]If[ds2i \[Equal] 3, \ 
        gcovswart = gcov0; gconswart = gcon0; gdetrealswart = gdetreal0; 
        gdetswart = gdet0; gswart = g0;]; \[IndentingNewLine]If[
        ds2i \[Equal] 4, \ gcovks = gcov0; gconks = gcon0; 
        gdetrealks = gdetreal0; gdetks = gdet0; 
        gks = g0;]; \[IndentingNewLine]If[ds2i \[Equal] 5, \ gcovgen = gcov0; 
        gcongen = gcon0; gdetrealgen = gdetreal0; gdetgen = gdet0; 
        ggen = g0;]; \[IndentingNewLine]If[ds2i \[Equal] 6, \ gcovbl = gcov0; 
        gconbl = gcon0; gdetrealbl = gdetreal0; gdetbl = gdet0; 
        gbl = g0;]; \[IndentingNewLine]If[ds2i \[Equal] 7, \ gcovspc = gcov0; 
        gconspc = gcon0; gdetrealspc = gdetreal0; gdetspc = gdet0; 
        gspc = g0;]; \[IndentingNewLine]If[ds2i \[Equal] 8, \ 
        gcovsemigen = gcov0; gconsemigen = gcon0; 
        gdetrealsemigen = gdetreal0; gdetsemigen = gdet0; 
        gsemigen = g0;]; \[IndentingNewLine]If[ds2i \[Equal] 9, \ 
        gcovht = gcov0; gconht = gcon0; gdetrealht = gdetreal0; 
        gdetht = gdet0; ght = g0;]; \[IndentingNewLine]Print[
        ds2i]; \[IndentingNewLine]\(ds2i++\)]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(ds2i\\)\\\" is similar to existing symbol \\\
\"\\!\\(ds2\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(gcon0\\)\\\" is similar to existing symbol \
\\\"\\!\\(gcov0\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(gcon\\)\\\" is similar to existing symbol \\\
\"\\!\\(gcov\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell1\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \( (*\ 
      for\ getting\ simple\ expressions\ for\ general\ metric\ *) \)], "Input"],

Cell[BoxData[
    \( (*Clear[gdet]*) \)], "Input"],

Cell[BoxData[
    \( (*\ Connection\ for\ KS\ coords\ in\ coordinate\ basis\ *) \)], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \(MyD[f_, i_] := 
      If[i \[Equal] 1, D[f, Xp[\([1]\)]], 
        If[i \[Equal] 2, D[f, Xp[\([2]\)]], 
          If[i \[Equal] 3, D[f, Xp[\([3]\)]], 
            If[i \[Equal] 4, D[f, Xp[\([4]\)]]]]]]\)], "Input"],

Cell[BoxData[
    \( (*\ 
      the\ below\ is\ for\ analytic\ simplification\ purposes\ *) \)], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(myconvert = {}\), "\[IndentingNewLine]", 
    \(mybackconvert = {}\), "\[IndentingNewLine]", 
    \(myconvertr = {}\), "\[IndentingNewLine]", 
    \(mybackconvertr = {}\), "\[IndentingNewLine]", 
    \(mysigmabackconvert = {}\), "\[IndentingNewLine]", 
    \(mysigmaconvert = {}\)}], "Input"],

Cell[BoxData[
    \({}\)], "Output"],

Cell[BoxData[
    \({}\)], "Output"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(myconvertr\\)\\\" is similar to existing \
symbol \\\"\\!\\(myconvert\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({}\)], "Output"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(mybackconvertr\\)\\\" is similar to existing \
symbol \\\"\\!\\(mybackconvert\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\
\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \({}\)], "Output"],

Cell[BoxData[
    \({}\)], "Output"],

Cell[BoxData[
    \({}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(If[
        coordtype \[Equal] 
          1, \[IndentingNewLine]myconvert = {x \[Rule] Log[r - R0], 
            r - R0 \[Rule] drdx1, 
            Sin[2*Pi*y] \[Rule] \((h - Pi*y)\)/\((1/2*\((1 - hslope)\))\), 
            Cos[2*Pi*y] \[Rule] \((dhdx2 - Pi)\)/\((\((1 - hslope)\)*Pi)\), 
            r^2 + a^2*Cos[h]^2 \[Rule] 
              sigma}; \[IndentingNewLine]mybackconvert = {r \[Rule] 
              X[\([2]\)], h \[Rule] X[\([3]\)], dhdx2 -> dXdXp[\([3, 3]\)], 
            drdx1 \[Rule] dXdXp[\([2, 2]\)], 
            sigma -> r^2 + 
                a^2*Cos[h]^2}; \[IndentingNewLine]myconvertr = {x \[Rule] 
              Log[r - R0], r - R0 \[Rule] drdx1, 
            drdx1 + R0 \[Rule] 
              r}; \[IndentingNewLine]mybackconvertr = {r \[Rule] X[\([2]\)], 
            drdx1 \[Rule] 
              dXdXp[\([2, 
                  2]\)]}; \[IndentingNewLine]mysigmabackconvert = {sigma \
\[Rule] r^2 + a^2*Cos[h]^2}; \[IndentingNewLine]mysigmaconvert = {r^2 + 
                a^2*Cos[h]^2 \[Rule] 
              sigma};\[IndentingNewLine]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(X[\([3]\)] //. myconvert\), "\[IndentingNewLine]", 
    \(dXdXp[\([3, 3]\)] //. myconvert\), "\[IndentingNewLine]", 
    \(\)}], "Input"],

Cell[BoxData[
    \(y\)], "Output"],

Cell[BoxData[
    \(1\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(If[
        coordtype \[Equal] 
          0, \[IndentingNewLine]myconvert = {x \[Rule] r, y \[Rule] h, 
            r^2 + a^2*Cos[h]^2 \[Rule] 
              sigma}; \[IndentingNewLine]myconvertr = {x \[Rule] r, 
            y \[Rule] h}; \[IndentingNewLine]mybackconvert = {r \[Rule] 
              X[\([2]\)], h \[Rule] X[\([3]\)], dhdx2 -> dXdXp[\([3, 3]\)], 
            drdx1 \[Rule] dXdXp[\([2, 2]\)], 
            sigma -> r^2 + a^2*Cos[h]^2};\[IndentingNewLine]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(\(\[IndentingNewLine]\)\(\(gcon2 = 
        FullSimplify[
          FullSimplify[
              FullSimplify[
                  FullSimplify[gcon //. myconvert] //. mybackconvertr] //. 
                myconvertr] //. myconvertr];\)\(\[IndentingNewLine]\)
    \(gcov2 = 
        FullSimplify[
          FullSimplify[
              FullSimplify[
                  FullSimplify[gcov //. myconvert] //. mybackconvertr] //. 
                myconvertr] //. myconvertr];\)\(\[IndentingNewLine]\)
    \(gdet2 = 
        FullSimplify[
          gdet //. myconvert, {r > 0, sigma > 0, 
            drdx1 > 0}];\)\(\[IndentingNewLine]\)\(\[IndentingNewLine]\)
    \( (*If[
        simplemetric \[Equal] 0, \[IndentingNewLine]gcon2 = 
          FullSimplify[gcon2] //. mybackconvert; \[IndentingNewLine]gcov2 = 
          FullSimplify[gcov2] //. mybackconvert; \[IndentingNewLine]gdet2 = 
          FullSimplify[gdet2] //. 
            mybackconvert;\[IndentingNewLine]]\[IndentingNewLine]*) \
\)\)\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(gcov2\\)\\\" is similar to existing symbols \
\\!\\({gcon2, gcov12, gcov32, gcov42}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \(If[coordtype \[Equal] 1, \[IndentingNewLine]god1 = 
        X[\([3]\)] //. {hslope \[Rule] 1}; \[IndentingNewLine]Print[
        god1]; \[IndentingNewLine]god2 = 
        dXdXp[\([3, 3]\)] //. {hslope \[Rule] 1}; \[IndentingNewLine]Print[
        god2];\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \( (*\ then\ need\ to\ convert\ arrays\ b, 
      u\ to\ C - form\ *) \)], "Input"]
},
FrontEndVersion->"5.0 for Microsoft Windows",
ScreenRectangle->{{0, 1400}, {0, 967}},
WindowSize->{1016, 903},
WindowMargins->{{Automatic, 3}, {Automatic, 0}},
Magnification->1.25
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{
Cell[1754, 51, 309, 5, 119, "Input"],

Cell[CellGroupData[{
Cell[2088, 60, 491, 9, 161, "Input"],
Cell[2582, 71, 356, 5, 29, "Message"],
Cell[2941, 78, 356, 5, 29, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[3334, 88, 146, 3, 77, "Input"],
Cell[3483, 93, 35, 1, 35, "Output"],
Cell[3521, 96, 35, 1, 35, "Output"],
Cell[3559, 99, 35, 1, 35, "Output"]
}, Open  ]],
Cell[3609, 103, 26, 0, 35, "Input"],
Cell[3638, 105, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[3689, 109, 26, 0, 35, "Input"],
Cell[3718, 111, 153, 2, 54, "Output"],
Cell[3874, 115, 152, 2, 52, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[4063, 122, 26, 0, 35, "Input"],
Cell[4092, 124, 354, 5, 29, "Message"],
Cell[4449, 131, 148, 2, 59, "Output"],
Cell[4600, 135, 354, 5, 29, "Message"],
Cell[4957, 142, 139, 2, 49, "Output"],
Cell[5099, 146, 69, 1, 52, "Output"]
}, Open  ]],
Cell[5183, 150, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[5234, 154, 2253, 41, 581, "Input"],
Cell[7490, 197, 360, 5, 49, "Message"],
Cell[7853, 204, 360, 5, 49, "Message"],
Cell[8216, 211, 360, 5, 49, "Message"],
Cell[8579, 218, 333, 5, 29, "Message"],
Cell[8915, 225, 358, 5, 29, "Message"]
}, Open  ]],
Cell[9288, 233, 113, 2, 35, "Input"],
Cell[9404, 237, 1241, 32, 518, "Input"],
Cell[10648, 271, 136, 2, 35, "Input"],
Cell[10787, 275, 78, 1, 35, "Input"],

Cell[CellGroupData[{
Cell[10890, 280, 103, 2, 56, "Input"],
Cell[10996, 284, 46, 1, 35, "Output"],
Cell[11045, 287, 46, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[11128, 293, 857, 15, 245, "Input"],
Cell[11988, 310, 46, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[12071, 316, 139, 3, 56, "Input"],
Cell[12213, 321, 90, 1, 35, "Output"],
Cell[12306, 324, 315, 9, 102, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[12658, 338, 123, 2, 35, "Input"],
Cell[12784, 342, 73, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[12894, 348, 292, 5, 77, "Input"],
Cell[13189, 355, 421, 8, 64, "Output"]
}, Open  ]],
Cell[13625, 366, 117, 2, 35, "Input"],

Cell[CellGroupData[{
Cell[13767, 372, 1225, 24, 371, "Input"],
Cell[14995, 398, 361, 5, 49, "Message"],
Cell[15359, 405, 356, 5, 29, "Message"],
Cell[15718, 412, 356, 5, 29, "Message"],
Cell[16077, 419, 333, 5, 29, "Message"],
Cell[16413, 426, 355, 5, 49, "Message"]
}, Open  ]],
Cell[16783, 434, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[16834, 438, 1598, 25, 371, "Input"],
Cell[18435, 465, 355, 5, 29, "Message"],
Cell[18793, 472, 358, 5, 29, "Message"],
Cell[19154, 479, 356, 5, 29, "Message"],
Cell[19513, 486, 333, 5, 29, "Message"],
Cell[19849, 493, 42, 1, 35, "Output"]
}, Open  ]],
Cell[19906, 497, 105, 2, 35, "Input"],
Cell[20014, 501, 50, 1, 35, "Input"],
Cell[20067, 504, 93, 1, 35, "Input"],
Cell[20163, 507, 26, 0, 35, "Input"],
Cell[20192, 509, 234, 5, 56, "Input"],
Cell[20429, 516, 105, 2, 35, "Input"],
Cell[20537, 520, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[20588, 524, 313, 6, 140, "Input"],
Cell[20904, 532, 36, 1, 35, "Output"],
Cell[20943, 535, 36, 1, 35, "Output"],
Cell[20982, 538, 369, 6, 49, "Message"],
Cell[21354, 546, 36, 1, 35, "Output"],
Cell[21393, 549, 375, 5, 49, "Message"],
Cell[21771, 556, 36, 1, 35, "Output"],
Cell[21810, 559, 36, 1, 35, "Output"],
Cell[21849, 562, 36, 1, 35, "Output"]
}, Open  ]],
Cell[21900, 566, 1103, 21, 224, "Input"],

Cell[CellGroupData[{
Cell[23028, 591, 158, 3, 77, "Input"],
Cell[23189, 596, 35, 1, 35, "Output"],
Cell[23227, 599, 35, 1, 35, "Output"]
}, Open  ]],
Cell[23277, 603, 508, 9, 140, "Input"],

Cell[CellGroupData[{
Cell[23810, 616, 1025, 23, 371, "Input"],
Cell[24838, 641, 375, 5, 49, "Message"]
}, Open  ]],
Cell[25228, 649, 26, 0, 35, "Input"],
Cell[25257, 651, 306, 5, 140, "Input"],
Cell[25566, 658, 101, 2, 35, "Input"]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

