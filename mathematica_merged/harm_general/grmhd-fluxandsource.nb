(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     41011,       1181]*)
(*NotebookOutlinePosition[     41676,       1204]*)
(*  CellTagsIndexPosition[     41632,       1200]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
    \(sigma\)], "Input"],

Cell[BoxData[
    \(r\^2 + a\^2\ Cos[h]\^2\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(gdet2\)], "Input"],

Cell[BoxData[
    \(x\^2\ Sin[y]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(MatrixForm[gcov2]\)], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {\(-1\), "0", "0", "0"},
            {"0", "1", "0", "0"},
            {"0", "0", \(x\^2\), "0"},
            {"0", "0", "0", \(x\^2\ Sin[y]\^2\)}
            }], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(MatrixForm[gcon2]\)], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {\(-1\), "0", "0", "0"},
            {"0", "1", "0", "0"},
            {"0", "0", \(1\/x\^2\), "0"},
            {"0", "0", "0", \(Csc[y]\^2\/x\^2\)}
            }], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(MatrixForm[
      theconn = 
        FullSimplify[
          Connection2 //. {M \[Rule] 1}, {drdx1 > 0, sigma > 0, 
            0 \[LessEqual] y \[LessEqual] Pi, 
            x > 0}]]\), "\[IndentingNewLine]", 
    \(MatrixForm[
      theconn2 = 
        FullSimplify[
          conn2 //. {M \[Rule] 1}, {drdx1 > 0, sigma > 0, 
            0 \[LessEqual] y \[LessEqual] Pi, x > 0}]]\)}], "Input"],

Cell[BoxData[
    InterpretationBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}]},
            {
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {\(-x\)},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {\(\(-x\)\ Sin[y]\^2\)}
                    }], "\[NoBreak]", ")"}]},
            {
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {\(1\/x\)},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {\(1\/x\)},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {\(\(-Cos[y]\)\ Sin[y]\)}
                    }], "\[NoBreak]", ")"}]},
            {
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {"0"}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {\(1\/x\)}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"0"},
                    {"0"},
                    {\(Cot[y]\)}
                    }], "\[NoBreak]", ")"}], 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {\(1\/x\)},
                    {\(Cot[y]\)},
                    {"0"}
                    }], "\[NoBreak]", ")"}]}
            }], "\[NoBreak]", ")"}],
      MatrixForm[ {{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 
        0}}, {{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 
        Times[ -1, x], 0}, {0, 0, 0, 
        Times[ -1, x, 
          Power[ 
            Sin[ y], 2]]}}, {{0, 0, 0, 0}, {0, 0, 
        Power[ x, -1], 0}, {0, 
        Power[ x, -1], 0, 0}, {0, 0, 0, 
        Times[ -1, 
          Cos[ y], 
          Sin[ y]]}}, {{0, 0, 0, 0}, {0, 0, 0, 
        Power[ x, -1]}, {0, 0, 0, 
        Cot[ y]}, {0, 
        Power[ x, -1], 
        Cot[ y], 0}}}]]], "Output"],

Cell[BoxData[
    TagBox["conn2",
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(outputreplacesm = {dhdx2 \[Rule] dxdxp2, drdx1 \[Rule] dxdxp1, 
        Cos \[Rule] cos, Sin \[Rule] sin, y \[Rule] tx2, Pi \[Rule] "\<pi\>", 
        Csc \[Rule] csc, Cot \[Rule] cot}\), "\[IndentingNewLine]", 
    \(outputreplaceharm = {dhdx2 \[Rule] "\<dxdxp[2]\>", 
        drdx1 -> "\<dxdxp[1]\>", Cos \[Rule] cos, Sin \[Rule] sin, 
        y \[Rule] "\<X[2]\>", Cot \[Rule] cot, Power \[Rule] pow, 
        h \[Rule] th, Pi \[Rule] "\<M_PI\>"}\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(cos\\)\\\" is similar to existing symbol \
\\\"\\!\\(Cos\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(sin\\)\\\" is similar to existing symbol \
\\\"\\!\\(Sin\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(csc\\)\\\" is similar to existing symbol \
\\\"\\!\\(Csc\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell1\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \({dhdx2 \[Rule] dxdxp2, drdx1 \[Rule] dxdxp1, Cos \[Rule] cos, 
      Sin \[Rule] sin, y \[Rule] tx2, \[Pi] \[Rule] "pi", Csc \[Rule] csc, 
      Cot \[Rule] cot}\)], "Output"],

Cell[BoxData[
    \({dhdx2 \[Rule] "dxdxp[2]", drdx1 \[Rule] "dxdxp[1]", Cos \[Rule] cos, 
      Sin \[Rule] sin, y \[Rule] "X[2]", Cot \[Rule] cot, Power \[Rule] pow, 
      h \[Rule] th, \[Pi] \[Rule] "M_PI"}\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
    \(\(printgcovsm = 
        N[\(gcov2 //. 
              outputreplacesm\) //. {M \[Rule] 
                1}];\)\), "\[IndentingNewLine]", 
    \(\(printgconsm = 
        N[\(gcon2 //. 
              outputreplacesm\) //. {M \[Rule] 
                1}];\)\), "\[IndentingNewLine]", 
    \(\(printconnsm = 
        N[\(theconn //. 
              outputreplacesm\) //. {M \[Rule] 
                1}];\)\), "\[IndentingNewLine]", 
    \(\(printconn2sm = 
        N[\(theconn2 //. outputreplacesm\) //. {M \[Rule] 1}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \( (*\(p = 
          Print["\<set kspc\>", i, j, k, "\<=\>", 
            FortranForm[
              printconn[\([i, j, k]\)]\  //. outputreplace]];\)*) \)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(tan\\)\\\" is similar to existing symbol \
\\\"\\!\\(Tan\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partw"\), \(\(:\)\(\ \)\), "\<\"Part \\!\\(5\\) of \
\\!\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\) does not exist. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::partw\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Part::"partw"\), \(\(:\)\(\ \)\), "\<\"Part \\!\\(5\\) of \
\\!\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\) does not exist. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::partw\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[BoxData[
    \( (*\ for\ sm\ *) \)], "Input"],

Cell[BoxData[{
    \(\(strm = 
        OpenWrite["\<c:\\kspsm.txt\>", PageWidth \[Rule] 500, 
          FormatType \[Rule] FortranForm];\)\), "\[IndentingNewLine]", 
    \(\(For[i = 1, 
        i <= 4, \[IndentingNewLine]For[j = 1, 
          j <= 4, \[IndentingNewLine]For[k = 1, 
            k <= 4, \[IndentingNewLine]ii = i - 1; \[IndentingNewLine]jj = 
              j - 1; \[IndentingNewLine]kk = k - 1; \[IndentingNewLine]Write[
              strm, "\<set kspc\>", ii, jj, kk, "\<=\>", 
              printconnsm[\([i, j, 
                  k]\)]]; \[IndentingNewLine]\(k++\)]; \[IndentingNewLine]\(j\
++\)]; \[IndentingNewLine]\(i++\)];\)\), "\[IndentingNewLine]", 
    \(\(For[i = 1, 
        i <= 4, \[IndentingNewLine]ii = i - 1; \[IndentingNewLine]Write[
          strm, "\<set kspck\>", ii, "\<=\>", 
          printconn2sm[\([i]\)]]; \[IndentingNewLine]\(i++\)];\)\), "\
\[IndentingNewLine]", 
    \(\(For[i = 1, 
        i <= 4, \[IndentingNewLine]For[j = 1, 
          j <= 4, \[IndentingNewLine]ii = i - 1; \[IndentingNewLine]jj = 
            j - 1; \[IndentingNewLine]Write[strm, "\<set kspgv\>", ii, 
            jj, "\<=\>", 
            printgcovsm[\([i, 
                j]\)]]; \[IndentingNewLine]\(j++\)]; \[IndentingNewLine]\(i\
++\)];\)\), "\[IndentingNewLine]", 
    \(\(For[i = 1, 
        i <= 4, \[IndentingNewLine]For[j = 1, 
          j <= 4, \[IndentingNewLine]ii = i - 1; \[IndentingNewLine]jj = 
            j - 1; \[IndentingNewLine]Write[strm, "\<set kspgn\>", ii, 
            jj, "\<=\>", 
            printgconsm[\([i, 
                j]\)]\ ]; \[IndentingNewLine]\(j++\)]; \[IndentingNewLine]\(i\
++\)];\)\), "\[IndentingNewLine]", 
    \(\(Close[strm];\)\)}], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \( (*\ for\ HARM\ *) \)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(harmprintconn = 
        N[theconn //. outputreplaceharm];\)\), "\[IndentingNewLine]", 
    \(\(harmprintconn2 = 
        N[theconn2 //. outputreplaceharm];\)\), "\[IndentingNewLine]", 
    \(harmprintconn[\([3, 3, 3]\)]\), "\[IndentingNewLine]", 
    \(\(strm = 
        OpenWrite["\<c:\\kspconnharm.txt\>", 
          FormatType \[Rule] CForm];\)\), "\[IndentingNewLine]", 
    \(\(For[i = 1, 
        i <= 4, \[IndentingNewLine]For[j = 1, 
          j <= 4, \[IndentingNewLine]For[k = 1, 
            k <= 4, \[IndentingNewLine]ii = i - 1; \[IndentingNewLine]jj = 
              j - 1; \[IndentingNewLine]kk = k - 1; \[IndentingNewLine]Write[
              strm, "\<conn[\>", ii, "\<][\>", jj, "\<][\>", kk, "\<]=\>", 
              harmprintconn[\([i, j, 
                  k]\)], "\<;\>"]; \[IndentingNewLine]\(k++\)]; \
\[IndentingNewLine]\(j++\)]; \[IndentingNewLine]\(i++\)];\)\), "\
\[IndentingNewLine]", 
    \(\(For[i = 1, 
        i <= 4, \[IndentingNewLine]ii = i - 1; \[IndentingNewLine]Write[
          strm, "\<conn2[\>", ii, "\<]=\>", 
          harmprintconn2[\([i]\)], "\<;\>"]; \
\[IndentingNewLine]\(i++\)];\)\), "\[IndentingNewLine]", 
    \(\(Close[strm];\)\)}], "Input"],

Cell[BoxData[
    \(4.`\ \(("M_PI"\ "X[2]" - 1.`\ th)\)\ pow["dxdxp[2]", \(-1.`\)]\ pow[
          "M_PI", 2.`] - 
      1.`\ "dxdxp[2]"\ cos[th]\ pow[a, 2.`]\ pow[sigma, \(-1.`\)]\ sin[
          th]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \(r\ sigma\ Abs[dhdx2]\ Abs[Sin[h]]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(p = \((gam - 1)\)*en;\)\), "\n", 
    \(\(eta = p + rho + en + b2;\)\), "\n", 
    \(\(ptot = p + b2/2;\)\), "\[IndentingNewLine]", 
    \(ucov = {ud0, ud1, ud2, ud3}\), "\[IndentingNewLine]", 
    \(u = {uu0, uu1, uu2, uu3}\), "\[IndentingNewLine]", 
    \(bcov = {bd0, bd1, bd2, bd3}\), "\[IndentingNewLine]", 
    \(b = {bu0, bu1, bu2, bu3}\), "\[IndentingNewLine]", 
    \(b2 = bcov . b\), "\[IndentingNewLine]", 
    \(\(Tud = 
        Table[eta*u[\([i]\)]*ucov[\([j]\)] + ptot*KroneckerDelta[i, j] - 
            b[\([i]\)]*bcov[\([j]\)], {i, 4}, {j, 
            4}];\)\), "\[IndentingNewLine]", 
    \(\(T = Tud;\)\)}], "Input"],

Cell[BoxData[
    \({ud0, ud1, ud2, ud3}\)], "Output"],

Cell[BoxData[
    \({uu0, uu1, uu2, uu3}\)], "Output"],

Cell[BoxData[
    \({bd0, bd1, bd2, bd3}\)], "Output"],

Cell[BoxData[
    \({bu0, bu1, bu2, bu3}\)], "Output"],

Cell[BoxData[
    \(bd0\ bu0 + bd1\ bu1 + bd2\ bu2 + bd3\ bu3\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(myTuu = {{tu11, tu12, tu13, tu14}, {tu12, tu22, tu23, tu24}, {tu13, 
          tu23, tu33, tu34}, {tu14, tu24, tu34, 
          tu44}}\), "\[IndentingNewLine]", 
    \(myTud = 
      FullSimplify[
        Table[Sum[gcov[\([ii, jj]\)]*myTuu[\([kk, jj]\)], {jj, 1, 4}], {kk, 
              1, 4}, {ii, 1, 4}] //. {M \[Rule] 1}, {x > 0, 
          0 \[LessEqual] y \[LessEqual] Pi}]\), "\[IndentingNewLine]", 
    \(\(T = myTud;\)\)}], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(mylist = {{t01, t10}, {t02, t20}, {t03, t30}, {t12, t21}, {t13, 
          t31}, {t23, t32}}\), "\[IndentingNewLine]", 
    \(listsel = {2, 1, 1, 1, 1, 1}\), "\[IndentingNewLine]", 
    \(myTud = {{t00, t01, t02, t03}, {t10, t11, t12, t13}, {t20, t21, t22, 
          t23}, {t30, t31, t32, t33}}\), "\[IndentingNewLine]", 
    \(myTuu = 
      FullSimplify[
        Table[Sum[gcon2[\([ii, jj]\)]*myTud[\([kk, jj]\)], {jj, 1, 4}], {kk, 
              1, 4}, {ii, 1, 4}] //. {M \[Rule] 1}, {x > 0, 
          0 \[LessEqual] y \[LessEqual] Pi}]\), "\[IndentingNewLine]", 
    \(tudsols = 
      FullSimplify[
        Solve[{myTuu[\([1, 2]\)] == myTuu[\([2, 1]\)], 
            myTuu[\([1, 3]\)] == myTuu[\([3, 1]\)], 
            myTuu[\([1, 4]\)] == myTuu[\([4, 1]\)], 
            myTuu[\([2, 3]\)] == myTuu[\([3, 2]\)], 
            myTuu[\([2, 4]\)] == myTuu[\([4, 2]\)], 
            myTuu[\([3, 4]\)] == 
              myTuu[\([4, 3]\)]}, {mylist[\([1, listsel[\([1]\)]]\)], 
            mylist[\([2, listsel[\([2]\)]]\)], 
            mylist[\([3, listsel[\([3]\)]]\)], 
            mylist[\([4, listsel[\([4]\)]]\)], 
            mylist[\([5, listsel[\([5]\)]]\)], 
            mylist[\([6, listsel[\([6]\)]]\)]}]]\), "\[IndentingNewLine]", 
    \(realTud = 
      FullSimplify[myTud //. tudsols[\([1]\)]]\), "\[IndentingNewLine]", 
    \(MatrixForm[realTud]\), "\[IndentingNewLine]", 
    \(\(T = realTud;\)\), "\[IndentingNewLine]", 
    \(\(dUnogdet = 
        Table[Sum[
              T[\([j, k]\)]*theconn[\([k, aa, j]\)], {j, 1, 4}, {k, 1, 
                4}], {aa, 1, 4}] //. {M \[Rule] 
              1};\)\), "\[IndentingNewLine]", 
    \(mydU1 = 
      FullSimplify[
        FullSimplify[
            dUnogdet[\([1]\)] //. myconvert, {r > 0, 
              0 \[LessEqual] h \[LessEqual] Pi}] //. 
          myconvert]\), "\[IndentingNewLine]", 
    \(mydU2 = 
      FullSimplify[
        FullSimplify[
            dUnogdet[\([2]\)] //. myconvert, {r > 0, 
              0 \[LessEqual] h \[LessEqual] Pi}] //. 
          myconvert]\), "\[IndentingNewLine]", 
    \(mydU3 = 
      FullSimplify[
        FullSimplify[
            dUnogdet[\([3]\)] //. myconvert, {r > 0, 
              0 \[LessEqual] h \[LessEqual] Pi}] //. 
          myconvert]\), "\[IndentingNewLine]", 
    \(mydU4 = 
      FullSimplify[
        FullSimplify[
            dUnogdet[\([4]\)] //. myconvert, {r > 0, 
              0 \[LessEqual] h \[LessEqual] Pi}] //. 
          myconvert]\), "\[IndentingNewLine]", 
    \(\(dUc2 = 
        Table[Sum[T[\([j, nu]\)]*conn2[\([j]\)], {j, 1, 4}], {nu, 1, 
              4}] //. {M \[Rule] 1};\)\), "\[IndentingNewLine]", 
    \(mydUc21 = dUc2[\([1]\)]\), "\[IndentingNewLine]", 
    \(mydUc22 = dUc2[\([2]\)]\), "\[IndentingNewLine]", 
    \(mydUc23 = dUc2[\([3]\)]\), "\[IndentingNewLine]", 
    \(mydUc24 = dUc2[\([4]\)]\), "\[IndentingNewLine]", 
    \(Print["\<nogdettotals\>"]\), "\[IndentingNewLine]", 
    \(dUnogdettotal1 = 
      Simplify[\((mydU1 + mydUc21)\), {r > 0, 0 < h < Pi, 0 < y < 1, 
          Im[x] \[Equal] 0, sigma > 0, dhdx2 > 0}]\), "\[IndentingNewLine]", 
    \(dUnogdettotal2 = 
      Simplify[\((mydU2 + mydUc22)\), {r > 0, 0 < h < Pi, 0 < y < 1, 
          Im[x] \[Equal] 0, sigma > 0, dhdx2 > 0}]\), "\[IndentingNewLine]", 
    \(dUnogdettotal3 = 
      Simplify[\((mydU3 + mydUc23)\), {r > 0, 0 < h < Pi, 0 < y < 1, 
          Im[x] \[Equal] 0, sigma > 0, dhdx2 > 0}]\), "\[IndentingNewLine]", 
    \(dUnogdettotal4 = 
      Simplify[\((mydU4 + mydUc24)\), {r > 0, 0 < h < Pi, 0 < y < 1, 
          Im[x] \[Equal] 0, sigma > 0, dhdx2 > 0}]\), "\[IndentingNewLine]", 
    \(\(If[
        coordtype \[Equal] 0, \[IndentingNewLine]reducedconn1 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t00] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn2 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t11] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn3 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t22] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn4 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t33] //. {sigma \[Rule] 
                    r^2 + a^2*
                        Cos[h]^2}]]; \[IndentingNewLine]Print["\<reduced\>"]; \
\[IndentingNewLine]reducedconn = 
          FullSimplify[
            reducedconn1 + reducedconn2 + reducedconn3 + 
              reducedconn4]; \[IndentingNewLine]extrabit = 
          FullSimplify[\((\(-D[
                    gdet2 //. {y \[Rule] h, 
                        sigma \[Rule] r^2 + a^2*Cos[h]^2}, 
                    r]\) + \((gdet2 //. {y \[Rule] h, 
                        sigma \[Rule] r^2 + a^2*Cos[h]^2})\)*
                  reducedconn)\)];\[IndentingNewLine]];\)\), "\
\[IndentingNewLine]", 
    \(\(If[
        coordtype \[Equal] 1, \[IndentingNewLine]reducedconn21 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t00] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn22 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t11] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn23 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t22] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn24 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU2, 
                  t33] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn31 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU3, 
                  t00] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn32 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU3, 
                  t11] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn33 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU3, 
                  t22] //. {sigma \[Rule] 
                    r^2 + a^2*Cos[h]^2}]]; \[IndentingNewLine]reducedconn34 = 
          FullSimplify[
            TrigExpand[
              Coefficient[mydU3, 
                  t33] //. {sigma \[Rule] 
                    r^2 + a^2*
                        Cos[h]^2}]]; \[IndentingNewLine]Print["\<reduced\>"]; \
\[IndentingNewLine]reducedconn2 = 
          FullSimplify[
            reducedconn21 + reducedconn22 + reducedconn23 + 
              reducedconn24]; \[IndentingNewLine]reducedconn3 = 
          FullSimplify[
            reducedconn31 + reducedconn32 + reducedconn33 + 
              reducedconn34]; \[IndentingNewLine]gdet2fs = 
          FullSimplify[
            gdet2, {dhdx2 > 0, Sin[h] > 0, sigma > 0, 
              Im[x] \[Equal] 0}]; \[IndentingNewLine]Print["\<gdet2fs=\>", 
          gdet2fs]; \[IndentingNewLine]gdet2der = 
          FullSimplify[\((gdet2fs)\) //. mybackconvert, {sigma > 0, 
              Im[x] \[Equal] 0}]; \[IndentingNewLine]dgdetdx = 
          FullSimplify[\(-D[gdet2der, x]\) //. 
              myconvert]; \[IndentingNewLine]dgdetdy = 
          FullSimplify[\(-D[gdet2der, y]\) //. 
              myconvert]; \[IndentingNewLine]Print["\<extrabit\>"]; \
\[IndentingNewLine]extrabitx = 
          FullSimplify[\((dgdetdx + \((gdet2fs*reducedconn2)\))\) //. 
              mybackconvert, {Im[x] \[Equal] 
                0}]; \[IndentingNewLine]Print["\<extrabitx=\>", 
          extrabitx]; \[IndentingNewLine]extrabity = 
          FullSimplify[\((dgdetdy + \((gdet2fs*reducedconn3)\))\) //. 
              mybackconvert]; \[IndentingNewLine]Print["\<extrabity=\>", 
          extrabity];\[IndentingNewLine]];\)\)}], "Input"],

Cell[BoxData[
    \({{t01, t10}, {t02, t20}, {t03, t30}, {t12, t21}, {t13, t31}, {t23, 
        t32}}\)], "Output"],

Cell[BoxData[
    \({2, 1, 1, 1, 1, 1}\)], "Output"],

Cell[BoxData[
    \({{t00, t01, t02, t03}, {t10, t11, t12, t13}, {t20, t21, t22, 
        t23}, {t30, t31, t32, t33}}\)], "Output"],

Cell[BoxData[
    \({{\(-t00\), t01, t02\/x\^2, \(t03\ Csc[y]\^2\)\/x\^2}, {\(-t10\), t11, 
        t12\/x\^2, \(t13\ Csc[y]\^2\)\/x\^2}, {\(-t20\), t21, 
        t22\/x\^2, \(t23\ Csc[y]\^2\)\/x\^2}, {\(-t30\), t31, 
        t32\/x\^2, \(t33\ Csc[y]\^2\)\/x\^2}}\)], "Output"],

Cell[BoxData[
    \({{t10 \[Rule] \(-t01\), t02 \[Rule] \(-t20\)\ x\^2, 
        t03 \[Rule] \(-t30\)\ x\^2\ Sin[y]\^2, t12 \[Rule] t21\ x\^2, 
        t13 \[Rule] t31\ x\^2\ Sin[y]\^2, 
        t23 \[Rule] t32\ Sin[y]\^2}}\)], "Output"],

Cell[BoxData[
    \({{t00, t01, \(-t20\)\ x\^2, \(-t30\)\ x\^2\ Sin[y]\^2}, {\(-t01\), t11, 
        t21\ x\^2, t31\ x\^2\ Sin[y]\^2}, {t20, t21, t22, 
        t32\ Sin[y]\^2}, {t30, t31, t32, t33}}\)], "Output"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"t00", 
              "t01", \(\(-t20\)\ x\^2\), \(\(-t30\)\ x\^2\ Sin[y]\^2\)},
            {\(-t01\), "t11", \(t21\ x\^2\), \(t31\ x\^2\ Sin[y]\^2\)},
            {"t20", "t21", "t22", \(t32\ Sin[y]\^2\)},
            {"t30", "t31", "t32", "t33"}
            }], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"],

Cell[BoxData[
    \(0\)], "Output"],

Cell[BoxData[
    \(\(t22 + t33\)\/x\)], "Output"],

Cell[BoxData[
    \(t33\ Cot[y]\)], "Output"],

Cell[BoxData[
    \(0\)], "Output"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(conn2 \[LeftDoubleBracket] 1 \[RightDoubleBracket]\\) is longer than \
depth of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(conn2 \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\) is longer than \
depth of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(conn2 \[LeftDoubleBracket] 3 \[RightDoubleBracket]\\) is longer than \
depth of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Part :: \\\"partd\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \(t00\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket] - 
      t01\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket] + 
      t20\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket] + 
      t30\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket]\)], "Output"],

Cell[BoxData[
    \(t01\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket] + 
      t11\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket] + 
      t21\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket] + 
      t31\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket]\)], "Output"],

Cell[BoxData[
    \(\(-t20\)\ x\^2\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket] + 
      t21\ x\^2\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket] + 
      t22\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket] + 
      t32\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket]\)], "Output"],

Cell[BoxData[
    \(t33\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket] - 
      t30\ x\^2\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket]\ Sin[y]\^2 + 
      t31\ x\^2\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket]\ Sin[y]\^2 + 
      t32\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket]\ Sin[y]\^2\)], \
"Output"],

Cell[BoxData[
    \("nogdettotals"\)], "Print"],

Cell[BoxData[
    \(t00\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket] - 
      t01\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket] + 
      t20\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket] + 
      t30\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket]\)], "Output"],

Cell[BoxData[
    \(\(t22 + t33\)\/x + 
      t01\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket] + 
      t11\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket] + 
      t21\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket] + 
      t31\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket]\)], "Output"],

Cell[BoxData[
    \(t33\ Cot[y] - 
      t20\ x\^2\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket] + 
      t21\ x\^2\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket] + 
      t22\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket] + 
      t32\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket]\)], "Output"],

Cell[BoxData[
    \(t33\ conn2\[LeftDoubleBracket]4\[RightDoubleBracket] + \((\(-t30\)\ \
x\^2\ conn2\[LeftDoubleBracket]1\[RightDoubleBracket] + 
            t31\ x\^2\ conn2\[LeftDoubleBracket]2\[RightDoubleBracket] + 
            t32\ conn2\[LeftDoubleBracket]3\[RightDoubleBracket])\)\ \
Sin[y]\^2\)], "Output"],

Cell[BoxData[
    \("reduced"\)], "Print"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(reducedconn34\\)\\\" is similar to existing \
symbol \\\"\\!\\(reducedconn4\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(dgdetdy\\)\\\" is similar to existing symbol \
\\\"\\!\\(dgdetdx\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(extrabitx\\)\\\" is similar to existing \
symbol \\\"\\!\\(extrabit\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell1\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(extrabity\\)\\\" is similar to existing \
symbols \\!\\({extrabit, extrabitx}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(conn20 = 0\), "\[IndentingNewLine]", 
    \(conn21 = FullSimplify[dgdetdx/gdet2fs]\), "\[IndentingNewLine]", 
    \(conn22 = FullSimplify[dgdetdy/gdet2fs]\), "\[IndentingNewLine]", 
    \(conn23 = 0\), "\[IndentingNewLine]", 
    \(\(conn21harmprint = 
        N[conn21 //. outputreplaceharm];\)\), "\[IndentingNewLine]", 
    \(\(conn22harmprint = 
        N[conn22 //. outputreplaceharm];\)\), "\[IndentingNewLine]", 
    \(\(strm = 
        OpenWrite["\<c:\\kspconn2harm.txt\>"];\)\), "\[IndentingNewLine]", 
    \(\(Write[strm, "\<conn2[\>", 0, "\<]=\>", 
        CForm[0.0], "\<;\>"];\)\), "\[IndentingNewLine]", 
    \(\(Write[strm, "\<conn2[\>", 1, "\<]=\>", 
        CForm[conn21harmprint], "\<;\>"];\)\), "\[IndentingNewLine]", 
    \(\(Write[strm, "\<conn2[\>", 2, "\<]=\>", 
        CForm[conn22harmprint], "\<;\>"];\)\), "\[IndentingNewLine]", 
    \(\(Write[strm, "\<conn2[\>", 3, "\<]=\>", 
        CForm[0.0], "\<;\>"];\)\), "\[IndentingNewLine]", 
    \(\(Close[strm];\)\)}], "Input"],

Cell[BoxData[
    \(0\)], "Output"],

Cell[BoxData[
    \(\(-\(\(3\ r\^2 + a\^2\ Cos[h]\^2\)\/sigma\)\)\)], "Output"],

Cell[BoxData[
    \(\(\(-\((r\^2 + a\^2\ Cos[h]\^2)\)\)\ \((4\ \[Pi]\^2\ \((\(-h\) + \[Pi]\ \
y)\) + dhdx2\^2\ Cot[h])\) + a\^2\ dhdx2\^2\ Sin[2\ h]\)\/\(dhdx2\ \
sigma\)\)], "Output"],

Cell[BoxData[
    \(0\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \( . \)], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(coordtype\)], "Input"],

Cell[BoxData[
    \(1\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(gdet2der\)], "Input"],

Cell[BoxData[
    \(Abs[\[Pi] - \((\(-1\) + hslope)\)\ \[Pi]\ Cos[2\ \[Pi]\ y]]\ Abs[
        Sin[\[Pi]\ y - 
            1\/2\ \((\(-1\) + hslope)\)\ Sin[
                2\ \[Pi]\ y]]]\ \@\(\[ExponentialE]\^\(2\ x\)\ \((\
\[ExponentialE]\^\(2\ x\) + a\^2\ Cos[\[Pi]\ y + 1\/2\ \((1 - hslope)\)\ \
Sin[2\ \[Pi]\ y]]\^2)\)\^2\)\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(gdet2\)], "Input"],

Cell[BoxData[
    \(r\ sigma\ Abs[dhdx2]\ Abs[Sin[h]]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(gdet2\), "\[IndentingNewLine]", 
    \(mygdet = 
      gdet2 //. {sigma \[Rule] r^2 + a^2*Cos[h]^2}\), "\[IndentingNewLine]", 
    \(oned = FullSimplify[D[Log[mygdet], r]]\), "\[IndentingNewLine]", 
    \(oned //. {h \[Rule] 0}\), "\[IndentingNewLine]", 
    \(twod = FullSimplify[D[Log[mygdet], h]]\), "\[IndentingNewLine]", 
    \(Limit[twod, h \[Rule] 0]\)}], "Input"],

Cell[BoxData[
    \(sigma\ Sin[h]\)], "Output"],

Cell[BoxData[
    \(\((r\^2 + a\^2\ Cos[h]\^2)\)\ Sin[h]\)], "Output"],

Cell[BoxData[
    \(\(2\ r\)\/\(r\^2 + a\^2\ Cos[h]\^2\)\)], "Output"],

Cell[BoxData[
    \(\(2\ r\)\/\(a\^2 + r\^2\)\)], "Output"],

Cell[BoxData[
    \(Cot[
        h] - \(2\ a\^2\ Sin[2\ h]\)\/\(a\^2 + 2\ r\^2 + a\^2\ Cos[2\ h]\)\)], \
"Output"],

Cell[BoxData[
    \(\[Infinity]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \(\(2\ r\)\/\(a\^2 + r\^2\)\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \(\@sigma\^2\ Sin[y]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(reducedconn //. {a \[Rule] 0}\)], "Input"],

Cell[BoxData[
    \(Cot[h]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FortranForm[mydU2 //. outputreplace]\)], "Input"],

Cell["\<\
        (sigma*(4*t01 + 2*sigma*t11 - a*t31) + r*sigma*(-2*t00 + 6*t11 + \
a*t31) + 4*r**3*(t00 - t11 + t22 + t33) + 
     -    2*r**2*(-4*t01 + 2*a*t31 + sigma*(t22 + t33)) + a*(sigma - r*(4*r + \
sigma))*t31*cos(2*h))/(2.*sigma*(2*r + sigma))\
\>", "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FortranForm[mydU3 //. outputreplace]\)], "Input"],

Cell["\<\
        (64*pi**2*r*sigma*(2*r + sigma)*t22*(-h + pi*tx2) + 
     -    2*dxdxp2**2*(8*r*sigma*(2*r + sigma)*t33*Cot(h) - 
     -       2*a*(2*sigma*(2*r + sigma)*t31 + a**2*(4*r + sigma)*t31 + 
     -          2*a*r*(-4*t01 + sigma*(t22 + t33) + 2*r*(t00 - t11 + t22 + \
t33)))*sin(2*h) + a**3*(4*r + sigma)*t31*sin(4*h)))/
     -  (16.*dxdxp2*r*sigma*(2*r + sigma))\
\>", "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(dUnogdet = 
        Table[Sum[
              T[\([j, k]\)]*theconn[\([k, aa, j]\)], {j, 1, 4}, {k, 1, 
                4}], {aa, 1, 4}] //. {sigma \[Rule] x^2 + a^2*Cos[y]^2, 
            M \[Rule] 1};\)\)], "Input"],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(mydU = 
      FullSimplify[
        dUnogdet[\([3]\)], {x > 0, 
          0 \[LessEqual] y \[LessEqual] Pi}]\)], "Input"],

Cell[BoxData[
    \(t44\ Cot[y] - a\ t42\ Cos[y]\ Sin[y]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(reducedconn = Coefficient[mydU, t22]\)], "Input"],

Cell[BoxData[
    \(1\/\(sigma + 2\ x\)\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(theconn[\([3, 3, 3]\)]\)], "Input"],

Cell[BoxData[
    \(0\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Clear[T]\), "\[IndentingNewLine]", 
    \(myconn = 
      Simplify[FullSimplify[
            reducedconn, {sigma > 0}] //. {sigma \[Rule] 
              x^2 + a^2*Cos[y]^2}]\), "\[IndentingNewLine]", 
    \(F = 
      FullSimplify[
          A0[y]*Exp[\(-Integrate[myconn, x]\)], {x > 0, 
            0 \[LessEqual] y \[LessEqual] Pi}]/
        A0[y]\), "\[IndentingNewLine]", 
    \(term1 = \(-D[T[x, y], x]\) + T[x, y]*myconn\), "\[IndentingNewLine]", 
    \(term2 = 
      FullSimplify[
        1/\((\(-F\))\)*D[F*T[x, y], x], {x > 0, 
          0 \[LessEqual] y \[LessEqual] Pi}]\), "\[IndentingNewLine]", 
    \(diff = FullSimplify[term1 - term2]\)}], "Input"],

Cell[BoxData[
    \(1\/\(x\ \((2 + x)\) + a\^2\ Cos[y]\^2\)\)], "Output"],

Cell[BoxData[
    \(\[ExponentialE]\^\(-\(\(\@2\ ArcTan[\(\@2\ \((1 + x)\)\)\/\@\(\(-2\) + \
a\^2 + a\^2\ Cos[2\ y]\)]\)\/\@\(\(-2\) + a\^2 + a\^2\ Cos[2\ y]\)\)\)\)], \
"Output"],

Cell[BoxData[
    RowBox[{\(T[x, y]\/\(x\ \((2 + x)\) + a\^2\ Cos[y]\^2\)\), "-", 
      RowBox[{
        SuperscriptBox["T", 
          TagBox[\((1, 0)\),
            Derivative],
          MultilineFunction->None], "[", \(x, y\), "]"}]}]], "Output"],

Cell[BoxData[
    RowBox[{\(\(2\ T[x, y]\)\/\(a\^2 + 2\ x\ \((2 + x)\) + 
            a\^2\ Cos[2\ y]\)\), "-", 
      RowBox[{
        SuperscriptBox["T", 
          TagBox[\((1, 0)\),
            Derivative],
          MultilineFunction->None], "[", \(x, y\), "]"}]}]], "Output"],

Cell[BoxData[
    \(0\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(N[F //. {y \[Rule] Pi/2, x \[Rule] 3}]\)], "Input"],

Cell[BoxData[
    \(1.2909944487358056`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(N[F //. {y \[Rule] Pi/2, x \[Rule] 3}]\)], "Input"],

Cell[BoxData[
    \(7.904800023356424`*^-17 - 
      1.2909944487358056`\ \[ImaginaryI]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(N[FullSimplify[
          Abs[Exp[ArcTanh[1 + x]]] - Sqrt[\((2 + x)\)/x]] //. {x \[Rule] 
            3}]\)], "Input"],

Cell[BoxData[
    \(0.`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FullSimplify[
      sigma //. {sigma \[Rule] x^2 + a^2*Cos[y]^2 - 2*x}]\)], "Input"],

Cell[BoxData[
    \(\((\(-2\) + x)\)\ x + a\^2\ Cos[y]\^2\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Limit[
      FullSimplify[
        F, {\(-1\) \[LessEqual] a \[LessEqual] 1, x > 0, 
          0 \[LessEqual] y \[LessEqual] Pi}], {a \[Rule] 0}]\)], "Input"],

Cell[BoxData[
    \({\[ExponentialE]\^ArcTanh[1 + x]}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FullForm[F]\)], "Input"],

Cell[BoxData[
    TagBox[
      StyleBox[\(Power[E, 
          Times[\(-1\), Power[2, Rational[1, 2]], 
            ArcTan[Times[Power[2, Rational[1, 2]], Plus[\(-1\), x], 
                Power[Plus[\(-2\), Power[a, 2], 
                    Times[Power[a, 2], Cos[Times[2, y]]]], 
                  Rational[\(-1\), 2]]]], 
            Power[Plus[\(-2\), Power[a, 2], 
                Times[Power[a, 2], Cos[Times[2, y]]]], 
              Rational[\(-1\), 2]]]]\),
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
      FullForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FullSimplify[
      ComplexExpand[F], {\(-1\) \[LessEqual] a \[LessEqual] 1, x > 0, 
        0 \[LessEqual] y \[LessEqual] Pi}]\)], "Input"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]]
},
FrontEndVersion->"5.0 for Microsoft Windows",
ScreenRectangle->{{0, 1280}, {0, 941}},
WindowSize->{1272, 907},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 38, 1, 35, "Input"],
Cell[1817, 56, 56, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[1910, 62, 38, 1, 35, "Input"],
Cell[1951, 65, 46, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[2034, 71, 50, 1, 35, "Input"],
Cell[2087, 74, 339, 9, 108, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[2463, 88, 50, 1, 35, "Input"],
Cell[2516, 91, 342, 9, 126, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[2895, 105, 417, 11, 56, "Input"],
Cell[3315, 118, 4042, 118, 340, "Output"],
Cell[7360, 238, 108, 3, 52, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[7505, 246, 484, 7, 77, "Input"],
Cell[7992, 255, 354, 5, 29, "Message"],
Cell[8349, 262, 354, 5, 29, "Message"],
Cell[8706, 269, 354, 5, 29, "Message"],
Cell[9063, 276, 333, 5, 29, "Message"],
Cell[9399, 283, 195, 3, 35, "Output"],
Cell[9597, 288, 224, 3, 35, "Output"]
}, Open  ]],
Cell[9836, 294, 26, 0, 35, "Input"],
Cell[9865, 296, 551, 14, 98, "Input"],

Cell[CellGroupData[{
Cell[10441, 314, 185, 4, 35, "Input"],
Cell[10629, 320, 354, 5, 29, "Message"],
Cell[10986, 327, 322, 5, 29, "Message"],
Cell[11311, 334, 322, 5, 29, "Message"]
}, Open  ]],
Cell[11648, 342, 50, 1, 35, "Input"],
Cell[11701, 345, 1712, 34, 644, "Input"],
Cell[13416, 381, 26, 0, 35, "Input"],
Cell[13445, 383, 52, 1, 35, "Input"],

Cell[CellGroupData[{
Cell[13522, 388, 1217, 24, 413, "Input"],
Cell[14742, 414, 214, 4, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[14993, 423, 26, 0, 35, "Input"],
Cell[15022, 425, 67, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[15126, 431, 659, 13, 224, "Input"],
Cell[15788, 446, 54, 1, 35, "Output"],
Cell[15845, 449, 54, 1, 35, "Output"],
Cell[15902, 452, 54, 1, 35, "Output"],
Cell[15959, 455, 54, 1, 35, "Output"],
Cell[16016, 458, 75, 1, 35, "Output"]
}, Open  ]],
Cell[16106, 462, 462, 9, 77, "Input"],
Cell[16571, 473, 26, 0, 35, "Input"],
Cell[16600, 475, 26, 0, 35, "Input"],
Cell[16629, 477, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[16680, 481, 8191, 179, 1295, "Input"],
Cell[24874, 662, 115, 2, 35, "Output"],
Cell[24992, 666, 52, 1, 35, "Output"],
Cell[25047, 669, 131, 2, 35, "Output"],
Cell[25181, 673, 277, 4, 52, "Output"],
Cell[25461, 679, 237, 4, 35, "Output"],
Cell[25701, 685, 212, 3, 35, "Output"],
Cell[25916, 690, 442, 10, 110, "Output"],
Cell[26361, 702, 35, 1, 35, "Output"],
Cell[26399, 705, 50, 1, 49, "Output"],
Cell[26452, 708, 45, 1, 35, "Output"],
Cell[26500, 711, 35, 1, 35, "Output"],
Cell[26538, 714, 346, 5, 29, "Message"],
Cell[26887, 721, 346, 5, 29, "Message"],
Cell[27236, 728, 346, 5, 29, "Message"],
Cell[27585, 735, 329, 5, 29, "Message"],
Cell[27917, 742, 272, 4, 35, "Output"],
Cell[28192, 748, 272, 4, 35, "Output"],
Cell[28467, 754, 289, 4, 35, "Output"],
Cell[28759, 760, 319, 5, 35, "Output"],
Cell[29081, 767, 47, 1, 30, "Print"],
Cell[29131, 770, 272, 4, 35, "Output"],
Cell[29406, 776, 298, 5, 49, "Output"],
Cell[29707, 783, 305, 5, 35, "Output"],
Cell[30015, 790, 315, 5, 35, "Output"],
Cell[30333, 797, 42, 1, 30, "Print"],
Cell[30378, 800, 375, 6, 29, "Message"],
Cell[30756, 808, 362, 5, 29, "Message"],
Cell[31121, 815, 365, 5, 29, "Message"],
Cell[31489, 822, 333, 5, 29, "Message"],
Cell[31825, 829, 371, 6, 29, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[32233, 840, 1021, 19, 266, "Input"],
Cell[33257, 861, 35, 1, 35, "Output"],
Cell[33295, 864, 79, 1, 55, "Output"],
Cell[33377, 867, 184, 3, 55, "Output"],
Cell[33564, 872, 35, 1, 35, "Output"]
}, Open  ]],
Cell[33614, 876, 26, 0, 35, "Input"],
Cell[33643, 878, 36, 1, 35, "Input"],
Cell[33682, 881, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[33733, 885, 42, 1, 35, "Input"],
Cell[33778, 888, 35, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[33850, 894, 41, 1, 35, "Input"],
Cell[33894, 897, 341, 6, 63, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[34272, 908, 38, 1, 35, "Input"],
Cell[34313, 911, 67, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[34417, 917, 392, 7, 140, "Input"],
Cell[34812, 926, 47, 1, 35, "Output"],
Cell[34862, 929, 70, 1, 35, "Output"],
Cell[34935, 932, 70, 1, 52, "Output"],
Cell[35008, 935, 59, 1, 49, "Output"],
Cell[35070, 938, 114, 3, 55, "Output"],
Cell[35187, 943, 45, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[35269, 949, 26, 0, 35, "Input"],
Cell[35298, 951, 59, 1, 49, "Output"]
}, Open  ]],
Cell[35372, 955, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[35423, 959, 26, 0, 35, "Input"],
Cell[35452, 961, 52, 1, 39, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[35541, 967, 62, 1, 35, "Input"],
Cell[35606, 970, 40, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[35683, 976, 69, 1, 35, "Input"],
Cell[35755, 979, 270, 5, 53, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36062, 989, 69, 1, 35, "Input"],
Cell[36134, 992, 392, 7, 110, "Output"]
}, Open  ]],
Cell[36541, 1002, 238, 5, 35, "Input"],
Cell[36782, 1009, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[36833, 1013, 141, 4, 35, "Input"],
Cell[36977, 1019, 70, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[37084, 1025, 69, 1, 35, "Input"],
Cell[37156, 1028, 53, 1, 52, "Output"]
}, Open  ]],
Cell[37224, 1032, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[37275, 1036, 55, 1, 35, "Input"],
Cell[37333, 1039, 35, 1, 35, "Output"]
}, Open  ]],
Cell[37383, 1043, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[37434, 1047, 686, 16, 140, "Input"],
Cell[38123, 1065, 73, 1, 52, "Output"],
Cell[38199, 1068, 179, 3, 80, "Output"],
Cell[38381, 1073, 251, 6, 52, "Output"],
Cell[38635, 1081, 281, 7, 52, "Output"],
Cell[38919, 1090, 35, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[38991, 1096, 71, 1, 35, "Input"],
Cell[39065, 1099, 53, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[39155, 1105, 71, 1, 35, "Input"],
Cell[39229, 1108, 101, 2, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[39367, 1115, 138, 3, 35, "Input"],
Cell[39508, 1120, 37, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[39582, 1126, 104, 2, 35, "Input"],
Cell[39689, 1130, 71, 1, 35, "Output"]
}, Open  ]],
Cell[39775, 1134, 26, 0, 35, "Input"],

Cell[CellGroupData[{
Cell[39826, 1138, 178, 4, 35, "Input"],
Cell[40007, 1144, 67, 1, 35, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[40111, 1150, 44, 1, 35, "Input"],
Cell[40158, 1153, 595, 14, 77, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[40790, 1172, 160, 3, 35, "Input"],
Cell[40953, 1177, 42, 1, 35, "Output"]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

